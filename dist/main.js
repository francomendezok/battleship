(()=>{var e={776:e=>{class t{constructor(e){this.size=e,this.hit=0,this.sunk=!1,this.coordinates=[]}registerHit(){return this.hit+=1}isSunk(){return this.hit===this.size}addCoordinates(e){this.coordinates.push(e)}}e.exports={Ship:t,Gameboard:class{constructor(){this.board=[],this.ships=[]}createBoard(e=8){for(let t=0;t<e;t+=1)for(let a=0;a<e;a+=1){const e=`${t},${a}`;this.board[e]={coordinates:e,attacked:!1,missed:!1,hasShip:!1,ship:[]}}return this.board}isValid(e){let t=e.split(","),a=Number(t[0]),s=Number(t[1]);return a>=0&&a<=7&&s>=0&&s<=7}getBoard(){return this.board}addShip(e){this.ships.push(e)}placeShip(e,a){if(e!==a.length)return"Size and coordinates length should be equal";const s=new t(e);for(let e=0;e<a.length;e++){if(this.hasShip(a[e]))return!1;this.board[a[e]].ship.push(a),this.board[a[e]].hasShip=!0}return s.addCoordinates(a),this.addShip(s),!0}isMoveLegal(e){return!this.board[e].attacked&&!this.board[e].missed}hasShip(e){return this.board[e].hasShip}placeEnemyShips(){let e=this.createCoordinates(),t=this.createCoordinates(),a=this.createCoordinates(),s=this.createCoordinates(),d=this.createCoordinates(),n=this.boardArray(),o=[this.getAdjacents(n,5,e),this.getAdjacents(n,4,t),this.getAdjacents(n,3,a),this.getAdjacents(n,3,s),this.getAdjacents(n,2,d)],i=[5,4,3,3,2],r=[];for(let e=0;e<o.length;e++){let t=o[e].filter((t=>t.length===i[e]));r.push(t)}r.forEach((e=>{this.placeShip(e[0].length,e[0])}))}createCoordinates(){let e=Math.floor(8*Math.random()),t=Math.floor(8*Math.random()),a=`${e},${t}`;if(this.hasShip(a)){for(;this.hasShip(a);)e=Math.floor(8*Math.random()),t=Math.floor(8*Math.random()),a=`${e},${t}`;return a}return a}getAdjacents(e,t,a){let s=e.boardArray(),d=[[],[]],n=1,o=8,i=0;for(let e=0;e<s.length;e++)if(s[e].coordinates===a){i=e;break}for(let e=0;e<t;e++){if(s[i+n]){let e=a.split(","),t=s[i+n].coordinates,o=t.split(",");t&&o[0]===e[0]&&(d[0].push(s[i+n].coordinates),n++)}if(s[i+o]){let e=a.split(","),t=s[i+o].coordinates;t.split(","),t&&t.includes(e[1])&&(d[1].push(s[i+o].coordinates),o+=8)}}return d}hasAllShipsPlaced(){return 5===this.ships.length}receiveAttack(e){let t=`${e}`;if(!this.board[t].attacked&&!this.board[t].missed)return this.board[t].hasShip?(this.board[t].attacked=!0,this.ships.forEach((e=>{e.coordinates[0].includes(t)&&(e.registerHit(),e.isSunk()&&(e.sunk=!0))}))):this.board[t].missed=!0,!0}getShips(){return this.ships}allSunk(){return this.ships.every((e=>!0===e.sunk))}boardArray(){const e=this.board,t=[];for(let a in e)t.push(e[a]);return t}},Player:class{constructor(e){this.gameboard=e}isMoveLegal(e){return!this.gameboard.board[e].attacked&&!this.gameboard.board[e].missed}makeRandomMove(){let e=Math.floor(8*Math.random()),t=Math.floor(8*Math.random()),a=`${e},${t}`;if(this.isMoveLegal(a))return a;for(;!this.isMoveLegal(a);)e=Math.floor(8*Math.random()),t=Math.floor(8*Math.random()),a=`${e},${t}`;return a}}}}},t={};function a(s){var d=t[s];if(void 0!==d)return d.exports;var n=t[s]={exports:{}};return e[s](n,n.exports,a),n.exports}(()=>{"use strict";var e=a(776);function t(e){const t=document.getElementById("main"),a=document.createElement("div"),s=document.createElement("div"),d=document.createElement("div"),n=document.createElement("div"),o=document.createElement("h3"),i=document.createElement("div"),r=document.createElement("div"),l=document.createElement("div"),c=document.createElement("div"),h=document.createElement("h3");a.classList.add("my-section"),s.classList.add("my-game-section"),d.classList.add("my-board"),n.classList.add("my-name-box"),o.classList.add("my-name"),i.classList.add("enemy-section"),r.classList.add("enemy-game-section"),l.classList.add("enemy-board"),c.classList.add("enemy-name-box"),h.classList.add("enemy-name");for(let e=0;e<8;e+=1)for(let t=0;t<8;t+=1){const a=`${e},${t}`,s=document.createElement("div"),n=document.createElement("div");s.classList.add("my-div-box"),n.classList.add("enemy-div-box"),s.id=`P ${a}`,n.id=`E ${a}`,d.appendChild(s),l.appendChild(n)}o.textContent=e,h.textContent="Enemy",n.appendChild(o),s.appendChild(d),a.appendChild(n),a.appendChild(s),c.appendChild(h),r.appendChild(l),i.appendChild(c),i.appendChild(r),t.appendChild(a),t.appendChild(i),t.classList.add("main-game")}function s(){document.getElementById("main").innerHTML=""}!function(){const a=document.getElementById("main"),d=document.createElement("div"),n=document.createElement("h3"),o=document.createElement("input"),i=document.createElement("button");d.classList.add("pop-up-box"),n.classList.add("title-pop-up"),o.classList.add("input-pop-up"),i.classList.add("play-button"),n.textContent="Write your Name",i.innerHTML="Battle",o.type="text",i.type="submit",d.appendChild(n),d.appendChild(o),d.appendChild(i),a.appendChild(d),i.addEventListener("click",(()=>{o.value?(s(),function(a){const d=document.getElementById("main"),n=document.createElement("div"),o=document.createElement("div"),i=document.createElement("div"),r=document.createElement("div"),l=document.createElement("h3"),c=document.createElement("button"),h=["Carrier","Battleship","Cruiser","Submarine","Destroyer"];let m=[4,3,2,2,1];d.classList.add("main-game"),n.classList.add("my-section"),o.classList.add("my-game-section"),i.classList.add("my-board"),r.classList.add("my-name-box"),l.classList.add("my-name"),c.classList.add("axis");let u=0;l.textContent=`${a},  place your  ${h[u]}`,l.dataset.size=u,c.innerHTML="Axis X",c.addEventListener("click",(()=>{"Axis X"===c.innerHTML?c.innerHTML="Axis Y":c.innerHTML="Axis X"}));let p=new e.Gameboard;p.createBoard(),new e.Player(p);for(let e=0;e<8;e+=1)for(let d=0;d<8;d+=1){const n=`${e},${d}`,o=document.createElement("div");o.classList.add("my-div-box"),o.id=`${n}`,7===d&&(o.dataset.xNotAllowed=!0),7===e&&(o.dataset.yNotAllowed=!0),o.addEventListener("mouseover",(()=>{let e=document.querySelector(".my-name").textContent.split(" "),t=e[e.length-1],a=h.indexOf(t),s=m[a],d=document.querySelector(".axis").textContent.split(" ")[1],n=p.getAdjacents(p,s,o.id);if("X"===d){let e=n[0].some((e=>p.hasShip(e)));p.hasShip(o.id)||o.dataset.cNotAllowed||e||n[0].length<s?(p.hasShip(o.id)||(o.style.background="red"),o.style.cursor="not-allowed"):n[0].forEach((e=>{document.getElementById(e).style.background="black",o.style.background="black",o.style.cursor="crosshair"}))}if("Y"===d){let e=n[1].some((e=>p.hasShip(e)));p.hasShip(o.id)||o.dataset.yNotAllowed||e||n[1].length<s?(p.hasShip(o.id)||(o.style.background="red"),o.style.cursor="not-allowed"):n[1].forEach((e=>{document.getElementById(e).style.background="black",o.style.background="black",o.style.cursor="crosshair"}))}})),o.addEventListener("mouseleave",(()=>{let e=document.querySelector(".my-name").textContent.split(" "),t=e[e.length-1],a=h.indexOf(t),s=m[a],d=document.querySelector(".axis").textContent.split(" ")[1],n=p.getAdjacents(p,s,o.id);"X"===d&&(o.dataset.xNotAllowed&&(o.style.background="lightgoldenrodyellow",o.style.cursor="crosshair"),p.hasShip(o.id)?(o.style.background="green",o.style.cursor="not-allowed"):n[0].forEach((e=>{p.hasShip(e)?(o.style.cursor="not-allowed",document.getElementById(e).style.background="green"):(document.getElementById(e).style.background="lightgoldenrodyellow",o.style.background="lightgoldenrodyellow")}))),"Y"===d&&(o.dataset.yNotAllowed&&(o.style.background="lightgoldenrodyellow",o.style.cursor="crosshair"),p.hasShip(o.id)?(o.style.background="green",o.style.cursor="not-allowed"):n[1].forEach((e=>{p.hasShip(e)?(o.style.cursor="not-allowed",document.getElementById(e).style.background="green"):(document.getElementById(e).style.background="lightgoldenrodyellow",o.style.background="lightgoldenrodyellow")})))})),o.addEventListener("click",(()=>{u+=1,u===h.length&&(s(),t(a)),l.textContent=`${a},  place your  ${h[u]}`})),i.appendChild(o)}r.appendChild(l),r.appendChild(c),o.appendChild(i),n.appendChild(r),n.appendChild(o),p.placeShip(3,["1,1","1,2","1,3"]),d.appendChild(n),function(e){document.querySelectorAll(".my-div-box").forEach((t=>{let a=t.id;e.board[a].hasShip&&(t.style.background="green"),e.board[a].attacked&&(t.innerHTML="‚ùå",t.style.background="#F5C2C1"),e.board[a].missed&&(t.innerHTML="üí¶",t.style.background="lightblue")}))}(p)}(o.value)):alert("Please Write Your Name")}))}()})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEdBd0VyQixTQUF3QjFFLEdBQ053RSxTQUFTMkMsaUJBQWlCLGVBQ2xDOUUsU0FBUXlELElBQ1gsSUFBSXZHLEVBQWN1RyxFQUFJTCxHQUNqQnpGLEVBQU1BLE1BQU1ULEdBQWFpQixVQUN6QnNGLEVBQUlrQixNQUFNQyxXQUFhLFNBRXZCakgsRUFBTUEsTUFBTVQsR0FBYWUsV0FDekJ3RixFQUFJRCxVQUFZLElBQ2hCQyxFQUFJa0IsTUFBTUMsV0FBYSxXQUV2QmpILEVBQU1BLE1BQU1ULEdBQWFnQixTQUN6QnVGLEVBQUlELFVBQVksS0FDaEJDLEVBQUlrQixNQUFNQyxXQUFhLFlBQzNCLEdBS1IsQ0ExRkksQ0FBY2pILEVBS2xCLENBeE9Zb0gsQ0FBaUJwQixFQUFNSSxRQUVsQmlCLE1BQU0seUJBQXlCLEdBRWhELENDL0JBQyxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9mYWN0b3JpZXMuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3JlbmRlci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFNoaXAgQ2xhc3MgLy9cclxuY2xhc3MgU2hpcCB7XHJcbiAgICBjb25zdHJ1Y3RvciAoc2l6ZSkge1xyXG4gICAgICAgIHRoaXMuc2l6ZSA9IHNpemU7XHJcbiAgICAgICAgdGhpcy5oaXQgPSAwO1xyXG4gICAgICAgIHRoaXMuc3VuayA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuY29vcmRpbmF0ZXMgPSBbXTtcclxuICAgIH1cclxuXHJcbiAgICByZWdpc3RlckhpdCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5oaXQgKz0gMTtcclxuICAgIH1cclxuXHJcbiAgICBpc1N1bmsoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaGl0ID09PSB0aGlzLnNpemU7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkQ29vcmRpbmF0ZXMgKHBvc2l0aW9uKSB7XHJcbiAgICAgICAgdGhpcy5jb29yZGluYXRlcy5wdXNoKHBvc2l0aW9uKTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gR2FtZWJvYXJkIENsYXNzIC8vXHJcbmNsYXNzIEdhbWVib2FyZCB7XHJcbiAgICBjb25zdHJ1Y3RvciAoKSB7XHJcbiAgICAgICAgdGhpcy5ib2FyZCA9IFtdIFxyXG4gICAgICAgIHRoaXMuc2hpcHMgPSBbXVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjcmVhdGVCb2FyZChzaXplID0gOCApIHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpemU7IGkgKz0gMSkge1xyXG4gICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBzaXplOyBqICs9IDEpIHtcclxuICAgICAgICAgICAgY29uc3QgY29vcmRpbmF0ZSA9IGAke2l9LCR7an1gO1xyXG4gICAgICAgICAgICB0aGlzLmJvYXJkW2Nvb3JkaW5hdGVdID0geyBjb29yZGluYXRlczogY29vcmRpbmF0ZSwgYXR0YWNrZWQ6IGZhbHNlLCBtaXNzZWQ6IGZhbHNlLCBoYXNTaGlwOiBmYWxzZSwgc2hpcDogW10gfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmJvYXJkO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpc1ZhbGlkIChjb29yZGluYXRlcykge1xyXG4gICAgICAgIGxldCBhcnIgPSBjb29yZGluYXRlcy5zcGxpdCgnLCcpO1xyXG4gICAgICAgIGxldCBhID0gTnVtYmVyKGFyclswXSk7XHJcbiAgICAgICAgbGV0IGIgPSBOdW1iZXIoYXJyWzFdKTtcclxuXHJcblxyXG4gICAgICAgIHJldHVybiBhID49IDAgJiYgYSA8PSA3ICYmIGIgPj0gMCAmJiBiIDw9IDc7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGdldEJvYXJkKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmJvYXJkO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBhZGRTaGlwIChzaGlwKSB7XHJcbiAgICAgICAgdGhpcy5zaGlwcy5wdXNoKHNoaXApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBwbGFjZVNoaXAgKHNpemUsIGNvb3JkaW5hdGVzKSB7XHJcbiAgICAgICAgaWYgKHNpemUgIT09IGNvb3JkaW5hdGVzLmxlbmd0aCkgcmV0dXJuICdTaXplIGFuZCBjb29yZGluYXRlcyBsZW5ndGggc2hvdWxkIGJlIGVxdWFsJztcclxuXHJcbiAgICAgICAgY29uc3Qgc2hpcCA9IG5ldyBTaGlwKHNpemUpO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvb3JkaW5hdGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaGFzU2hpcChjb29yZGluYXRlc1tpXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJvYXJkW2Nvb3JkaW5hdGVzW2ldXS5zaGlwLnB1c2goY29vcmRpbmF0ZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYm9hcmRbY29vcmRpbmF0ZXNbaV1dLmhhc1NoaXAgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2hpcC5hZGRDb29yZGluYXRlcyhjb29yZGluYXRlcyk7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkU2hpcChzaGlwKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlzTW92ZUxlZ2FsIChtb3ZlKSB7XHJcbiAgICAgICAgcmV0dXJuICF0aGlzLmJvYXJkW21vdmVdLmF0dGFja2VkICYmICF0aGlzLmJvYXJkW21vdmVdLm1pc3NlZDtcclxuICAgIH1cclxuICAgICAgICBcclxuICAgIGhhc1NoaXAgKGNvb3JkaW5hdGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYm9hcmRbY29vcmRpbmF0ZV0uaGFzU2hpcDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICBwbGFjZUVuZW15U2hpcHMgKCkge1xyXG4gICAgICAgICAgICBsZXQgY29vcmRpbmF0ZUNhcnJpZXIgPSB0aGlzLmNyZWF0ZUNvb3JkaW5hdGVzKCk7XHJcbiAgICAgICAgICAgIGxldCBjb29yZGluYXRlQmF0dGxlc2hpcCA9IHRoaXMuY3JlYXRlQ29vcmRpbmF0ZXMoKTtcclxuICAgICAgICAgICAgbGV0IGNvb3JkaW5hdGVDcnVpc2VyID0gdGhpcy5jcmVhdGVDb29yZGluYXRlcygpO1xyXG4gICAgICAgICAgICBsZXQgY29vcmRpbmF0ZVN1Ym1hcmluZSA9IHRoaXMuY3JlYXRlQ29vcmRpbmF0ZXMoKTtcclxuICAgICAgICAgICAgbGV0IGNvb3JkaW5hdGVEZXN0cm95ZXIgPSB0aGlzLmNyZWF0ZUNvb3JkaW5hdGVzKCk7XHJcblxyXG4gICAgICAgICAgICBsZXQgYXJyYXkgPSB0aGlzLmJvYXJkQXJyYXkoKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBjYXJyaWVyID0gdGhpcy5nZXRBZGphY2VudHMoYXJyYXksIDUsIGNvb3JkaW5hdGVDYXJyaWVyKTtcclxuICAgICAgICAgICAgbGV0IGJhdHRsZXNoaXAgPSB0aGlzLmdldEFkamFjZW50cyhhcnJheSwgNCwgY29vcmRpbmF0ZUJhdHRsZXNoaXApO1xyXG4gICAgICAgICAgICBsZXQgY3J1aXNlciA9IHRoaXMuZ2V0QWRqYWNlbnRzKGFycmF5LCAzLCBjb29yZGluYXRlQ3J1aXNlcik7XHJcbiAgICAgICAgICAgIGxldCBzdWJtYXJpbmUgPSB0aGlzLmdldEFkamFjZW50cyhhcnJheSwgMywgY29vcmRpbmF0ZVN1Ym1hcmluZSk7XHJcbiAgICAgICAgICAgIGxldCBkZXN0cm95ZXIgPSB0aGlzLmdldEFkamFjZW50cyhhcnJheSwgMiwgY29vcmRpbmF0ZURlc3Ryb3llcik7XHJcblxyXG4gICAgICAgICAgICBsZXQgc2hpcHMgPSBbY2FycmllciwgYmF0dGxlc2hpcCwgY3J1aXNlciwgc3VibWFyaW5lLCBkZXN0cm95ZXJdO1xyXG4gICAgICAgICAgICBsZXQgc2l6ZXMgPSBbNSw0LDMsMywyXTtcclxuICAgICAgICAgICAgbGV0IGZpbHRlcmVkID0gW107XHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXBzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdGVtcCA9IHNoaXBzW2ldLmZpbHRlcihwb3MgPT4gcG9zLmxlbmd0aCA9PT0gc2l6ZXNbaV0pO1xyXG4gICAgICAgICAgICAgICAgZmlsdGVyZWQucHVzaCh0ZW1wKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcblxyXG4gICAgICAgICAgICBmaWx0ZXJlZC5mb3JFYWNoKHNldE9mQ29vcmRpbmF0ZXMgPT4geyBcclxuICAgICAgICAgICAgICAgIHRoaXMucGxhY2VTaGlwKHNldE9mQ29vcmRpbmF0ZXNbMF0ubGVuZ3RoLCBzZXRPZkNvb3JkaW5hdGVzWzBdKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gc2V0T2ZDb29yZGluYXRlcy5mb3JFYWNoKGNvb3JkaW5hdGVzID0+IHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAvLyBsZXQgYWZmaXJtYXRpdmUgPSBjb29yZGluYXRlcy5ldmVyeShwb3NpdGlvbiA9PiAhdGhpcy5oYXNTaGlwKHBvc2l0aW9uKSk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy5wbGFjZVNoaXAoY29vcmRpbmF0ZXMubGVuZ3RoLCBjb29yZGluYXRlcyk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgLy8gY29vcmRpbmF0ZXMuZm9yRWFjaChwb3NpdGlvbiA9PiB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgLy8gfSlcclxuICAgICAgICAgICAgICAgIC8vIH0pO1xyXG4gICAgICAgICAgICB9KTsgIFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY3JlYXRlQ29vcmRpbmF0ZXMgKCkge1xyXG4gICAgICAgIGxldCBudW0xID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogOCk7IFxyXG4gICAgICAgIGxldCBudW0yID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogOCk7IFxyXG4gICAgICAgIGxldCByZXN1bHQgPSBgJHtudW0xfSwke251bTJ9YDtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmhhc1NoaXAocmVzdWx0KSkgcmV0dXJuIHJlc3VsdDtcclxuXHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHdoaWxlICh0aGlzLmhhc1NoaXAocmVzdWx0KSkge1xyXG4gICAgICAgICAgICAgICAgbnVtMSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDgpOyBcclxuICAgICAgICAgICAgICAgIG51bTIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA4KTsgXHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBgJHtudW0xfSwke251bTJ9YDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgICAgZ2V0QWRqYWNlbnRzIChib2FyZCwgc2l6ZSwgY29vcmRpbmF0ZXMpIHtcclxuICAgICAgICBsZXQgYXJyYXlCb2FyZCA9IGJvYXJkLmJvYXJkQXJyYXkoKTtcclxuICAgICAgICBsZXQgYWRqYWNlbnRzID0gW1tdLFtdXTtcclxuICAgICAgICAvLyBsZXQgdXAgPSA4O1xyXG4gICAgICAgIGxldCByaWdodCA9IDE7XHJcbiAgICAgICAgbGV0IGRvd24gPSA4O1xyXG4gICAgICAgIC8vIGxldCBsZWZ0ID0gMTtcclxuICAgICAgICBsZXQgaW5kZXggPSAwO1xyXG5cclxuICAgICAgICAvLyBnZXQgaW5kZXggLy9cclxuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGFycmF5Qm9hcmQubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgaWYgKGFycmF5Qm9hcmRbal0uY29vcmRpbmF0ZXMgPT09IGNvb3JkaW5hdGVzKSB7XHJcbiAgICAgICAgICAgICAgICBpbmRleCA9IGo7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHtcclxuICAgICAgICAgICAgLy8gMiBhZGphY2VudHMgLy8gXHJcbiAgICAgICAgICAgIC8vIGlmIChhcnJheUJvYXJkW2luZGV4IC0gdXBdKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBsZXQgc3BsaXQgPSBjb29yZGluYXRlcy5zcGxpdCgnLCcpO1xyXG4gICAgICAgICAgICAvLyAgICAgbGV0IHBsYWNlID0gYXJyYXlCb2FyZFtpbmRleCAtIHVwXS5jb29yZGluYXRlcztcclxuICAgICAgICAgICAgLy8gICAgIGxldCBwbGFjZVNwbGl0ID0gcGxhY2Uuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgLy8gICAgIGlmIChwbGFjZSAmJiBwbGFjZS5pbmNsdWRlcyhzcGxpdFsxXSkpIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICBhZGphY2VudHNbMF0ucHVzaChhcnJheUJvYXJkW2luZGV4IC0gdXBdLmNvb3JkaW5hdGVzKTtcclxuICAgICAgICAgICAgLy8gICAgICAgICB1cCArPSA4O1xyXG4gICAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIGlmIChhcnJheUJvYXJkW2luZGV4ICsgcmlnaHRdKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgc3BsaXQgPSBjb29yZGluYXRlcy5zcGxpdCgnLCcpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHBsYWNlID0gYXJyYXlCb2FyZFtpbmRleCArIHJpZ2h0XS5jb29yZGluYXRlcztcclxuICAgICAgICAgICAgICAgIGxldCBwbGFjZVNwbGl0ID0gcGxhY2Uuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgICAgIGlmIChwbGFjZSAmJiBwbGFjZVNwbGl0WzBdID09PSBzcGxpdFswXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFkamFjZW50c1swXS5wdXNoKGFycmF5Qm9hcmRbaW5kZXggKyByaWdodF0uY29vcmRpbmF0ZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0Kys7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGFycmF5Qm9hcmRbaW5kZXggKyBkb3duXSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHNwbGl0ID0gY29vcmRpbmF0ZXMuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgICAgIGxldCBwbGFjZSA9IGFycmF5Qm9hcmRbaW5kZXggKyBkb3duXS5jb29yZGluYXRlcztcclxuICAgICAgICAgICAgICAgIGxldCBwbGFjZVNwbGl0ID0gcGxhY2Uuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgICAgIGlmIChwbGFjZSAmJiBwbGFjZS5pbmNsdWRlcyhzcGxpdFsxXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGphY2VudHNbMV0ucHVzaChhcnJheUJvYXJkW2luZGV4ICsgZG93bl0uY29vcmRpbmF0ZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRvd24gKz0gODtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBpZiAoYXJyYXlCb2FyZFtpbmRleCAtIGxlZnRdKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBsZXQgc3BsaXQgPSBjb29yZGluYXRlcy5zcGxpdCgnLCcpO1xyXG4gICAgICAgICAgICAvLyAgICAgbGV0IHBsYWNlID0gYXJyYXlCb2FyZFtpbmRleCAtIGxlZnRdLmNvb3JkaW5hdGVzO1xyXG4gICAgICAgICAgICAvLyAgICAgbGV0IHBsYWNlU3BsaXQgPSBwbGFjZS5zcGxpdCgnLCcpO1xyXG4gICAgICAgICAgICAvLyAgICAgaWYgKHBsYWNlICYmIHBsYWNlU3BsaXRbMF0gPT09IHNwbGl0WzBdKSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgYWRqYWNlbnRzWzNdLnB1c2goYXJyYXlCb2FyZFtpbmRleCAtIGxlZnRdLmNvb3JkaW5hdGVzKTtcclxuICAgICAgICAgICAgLy8gICAgICAgICBsZWZ0Kys7XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGFkamFjZW50cztcclxuICAgIH1cclxuXHJcbiAgICBoYXNBbGxTaGlwc1BsYWNlZCAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2hpcHMubGVuZ3RoID09PSA1O1xyXG4gICAgfVxyXG5cclxuICAgICAgcmVjZWl2ZUF0dGFjayAoY29vcmRpbmF0ZXMpIHtcclxuICAgICAgICBsZXQgc3RyID0gYCR7Y29vcmRpbmF0ZXN9YDtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuYm9hcmRbc3RyXS5hdHRhY2tlZCB8fCB0aGlzLmJvYXJkW3N0cl0ubWlzc2VkKSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmJvYXJkW3N0cl0uaGFzU2hpcCkge1xyXG4gICAgICAgICAgICB0aGlzLmJvYXJkW3N0cl0uYXR0YWNrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLnNoaXBzLmZvckVhY2goc2hpcCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2hpcC5jb29yZGluYXRlc1swXS5pbmNsdWRlcyhzdHIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hpcC5yZWdpc3RlckhpdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzaGlwLmlzU3VuaygpKSBzaGlwLnN1bmsgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ib2FyZFtzdHJdLm1pc3NlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBnZXRTaGlwcyAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2hpcHM7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGFsbFN1bmsgKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNoaXBzLmV2ZXJ5KHNoaXAgPT4gc2hpcC5zdW5rID09PSB0cnVlKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgYm9hcmRBcnJheSAoKSB7XHJcbiAgICAgICAgY29uc3Qgb2JqID0gdGhpcy5ib2FyZDtcclxuICAgICAgICBjb25zdCBhcnJheSA9IFtdO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgICAgIGFycmF5LnB1c2gob2JqW2tleV0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIGFycmF5O1xyXG4gICAgICB9XHJcbn1cclxuXHJcbi8vIFBsYXllciBDbGFzcyAvL1xyXG5jbGFzcyBQbGF5ZXIge1xyXG4gICAgY29uc3RydWN0b3IgKGdhbWVib2FyZCkge1xyXG4gICAgICAgIHRoaXMuZ2FtZWJvYXJkID0gZ2FtZWJvYXJkO1xyXG4gICAgfVxyXG5cclxuICAgIGlzTW92ZUxlZ2FsIChtb3ZlKSB7XHJcbiAgICAgICAgcmV0dXJuICF0aGlzLmdhbWVib2FyZC5ib2FyZFttb3ZlXS5hdHRhY2tlZCAmJiAhdGhpcy5nYW1lYm9hcmQuYm9hcmRbbW92ZV0ubWlzc2VkO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBtYWtlUmFuZG9tTW92ZSAoKSB7XHJcbiAgICAgICAgbGV0IG51bTEgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA4KTsgXHJcbiAgICAgICAgbGV0IG51bTIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA4KTsgXHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IGAke251bTF9LCR7bnVtMn1gO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5pc01vdmVMZWdhbChyZXN1bHQpKSByZXR1cm4gcmVzdWx0O1xyXG5cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgd2hpbGUgKCF0aGlzLmlzTW92ZUxlZ2FsKHJlc3VsdCkpIHtcclxuICAgICAgICAgICAgICAgIG51bTEgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA4KTsgXHJcbiAgICAgICAgICAgICAgICBudW0yID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogOCk7IFxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gYCR7bnVtMX0sJHtudW0yfWA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxufVxyXG5cclxuXHJcbm1vZHVsZS5leHBvcnRzID0ge1NoaXAsIEdhbWVib2FyZCwgUGxheWVyfTsiLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gRE9NIE1hbmlwdWxhdGlvbiwgUmVuZGVyIHRoZSBHYW1lIC8vIFxyXG5cclxuLy8gUmVuZGVyIFdyaXRlIFlvdXIgTmFtZSAvLyBcclxuaW1wb3J0IHsgZ2FtZSB9IGZyb20gXCIuL2dhbWVcIjtcclxuaW1wb3J0IHsgR2FtZWJvYXJkLCBQbGF5ZXIsIFNoaXAgfSBmcm9tIFwiLi9mYWN0b3JpZXNcIjtcclxuXHJcbmZ1bmN0aW9uIHdyaXRlTmFtZSAoKSB7XHJcbiAgICBjb25zdCBtYWluID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW4nKTtcclxuICAgIGNvbnN0IGJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpO1xyXG4gICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xyXG4gICAgY29uc3QgcGxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpXHJcblxyXG4gICAgYm94LmNsYXNzTGlzdC5hZGQoJ3BvcC11cC1ib3gnKTtcclxuICAgIHRpdGxlLmNsYXNzTGlzdC5hZGQoJ3RpdGxlLXBvcC11cCcpO1xyXG4gICAgaW5wdXQuY2xhc3NMaXN0LmFkZCgnaW5wdXQtcG9wLXVwJyk7XHJcbiAgICBwbGF5LmNsYXNzTGlzdC5hZGQoJ3BsYXktYnV0dG9uJyk7XHJcblxyXG5cclxuICAgIHRpdGxlLnRleHRDb250ZW50ID0gJ1dyaXRlIHlvdXIgTmFtZSc7XHJcbiAgICBwbGF5LmlubmVySFRNTCA9ICdCYXR0bGUnO1xyXG4gICAgaW5wdXQudHlwZSA9ICd0ZXh0JztcclxuICAgIHBsYXkudHlwZSA9ICdzdWJtaXQnO1xyXG5cclxuICAgIGJveC5hcHBlbmRDaGlsZCh0aXRsZSk7XHJcbiAgICBib3guYXBwZW5kQ2hpbGQoaW5wdXQpO1xyXG4gICAgYm94LmFwcGVuZENoaWxkKHBsYXkpO1xyXG5cclxuICAgIG1haW4uYXBwZW5kQ2hpbGQoYm94KTtcclxuXHJcbiAgICBwbGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgIGlmIChpbnB1dC52YWx1ZSkge1xyXG4gICAgICAgICAgICBjbGVhbigpO1xyXG4gICAgICAgICAgICByZW5kZXJQbGFjZVNoaXBzKGlucHV0LnZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgYWxlcnQoJ1BsZWFzZSBXcml0ZSBZb3VyIE5hbWUnKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gcmVuZGVyUGxhY2VTaGlwcyAobmFtZSkge1xyXG4gICAgY29uc3QgbWFpbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluJyk7XHJcbiAgICBjb25zdCBteVNlY3Rpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IG15R2FtZVNlY3Rpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IG15Qm9hcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IG15TmFtZUJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgbXlOYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTtcclxuICAgIGNvbnN0IGF4aXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuXHJcbiAgICBjb25zdCBzaGlwcyA9IFsnQ2FycmllcicsICdCYXR0bGVzaGlwJywgJ0NydWlzZXInLCAnU3VibWFyaW5lJywgJ0Rlc3Ryb3llciddO1xyXG4gICAgbGV0IHNpemVzID0gWzQsMywyLDIsMV07XHJcblxyXG4gICAgbWFpbi5jbGFzc0xpc3QuYWRkKCdtYWluLWdhbWUnKTtcclxuICAgIG15U2VjdGlvbi5jbGFzc0xpc3QuYWRkKCdteS1zZWN0aW9uJyk7XHJcbiAgICBteUdhbWVTZWN0aW9uLmNsYXNzTGlzdC5hZGQoJ215LWdhbWUtc2VjdGlvbicpO1xyXG4gICAgbXlCb2FyZC5jbGFzc0xpc3QuYWRkKCdteS1ib2FyZCcpO1xyXG4gICAgbXlOYW1lQm94LmNsYXNzTGlzdC5hZGQoJ215LW5hbWUtYm94Jyk7XHJcbiAgICBteU5hbWUuY2xhc3NMaXN0LmFkZCgnbXktbmFtZScpO1xyXG4gICAgYXhpcy5jbGFzc0xpc3QuYWRkKCdheGlzJyk7XHJcblxyXG4gICAgbGV0IHBvcyA9IDA7XHJcblxyXG4gICAgbXlOYW1lLnRleHRDb250ZW50ID0gYCR7bmFtZX0sICBwbGFjZSB5b3VyICAke3NoaXBzW3Bvc119YDtcclxuICAgIG15TmFtZS5kYXRhc2V0LnNpemUgPSBwb3M7XHJcblxyXG4gICAgYXhpcy5pbm5lckhUTUwgPSAnQXhpcyBYJztcclxuXHJcbiAgICBheGlzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgIGlmIChheGlzLmlubmVySFRNTCA9PT0gJ0F4aXMgWCcpIHtcclxuICAgICAgICAgICAgYXhpcy5pbm5lckhUTUwgPSAnQXhpcyBZJztcclxuICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgYXhpcy5pbm5lckhUTUwgPSAnQXhpcyBYJztcclxuICAgICAgICB9KVxyXG5cclxuICAgIGxldCBib2FyZCA9IG5ldyBHYW1lYm9hcmQoKTtcclxuXHJcbiAgICBib2FyZC5jcmVhdGVCb2FyZCgpO1xyXG4gICBcclxuICAgIGxldCBwbGF5ZXIgPSBuZXcgUGxheWVyKGJvYXJkKTtcclxuICAgIFxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCA4OyBpICs9IDEpIHtcclxuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDg7IGogKz0gMSkge1xyXG4gICAgICAgICAgY29uc3QgY29vcmRpbmF0ZSA9IGAke2l9LCR7an1gO1xyXG4gICAgICAgICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICBkaXYuY2xhc3NMaXN0LmFkZCgnbXktZGl2LWJveCcpO1xyXG4gICAgICAgICAgZGl2LmlkID0gYCR7Y29vcmRpbmF0ZX1gO1xyXG4gICAgICAgICAgaWYgKGogPT09IDcpIHtcclxuICAgICAgICAgICAgZGl2LmRhdGFzZXQueE5vdEFsbG93ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKGkgPT09IDcpIHtcclxuICAgICAgICAgICAgZGl2LmRhdGFzZXQueU5vdEFsbG93ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIGRpdi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCB0aXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5teS1uYW1lJyk7XHJcbiAgICAgICAgICAgIGxldCBuYW1lID0gdGl0bGUudGV4dENvbnRlbnQ7XHJcbiAgICAgICAgICAgIGxldCBzcGxpdCA9IG5hbWUuc3BsaXQoJyAnKTtcclxuICAgICAgICAgICAgbGV0IHNoaXAgPSBzcGxpdFtzcGxpdC5sZW5ndGggLTFdO1xyXG4gICAgICAgICAgICBsZXQgaW5kZXggPSBzaGlwcy5pbmRleE9mKHNoaXApO1xyXG4gICAgICAgICAgICBsZXQgc2l6ZSA9IHNpemVzW2luZGV4XTtcclxuICAgICAgICAgICAgbGV0IGF4aXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXhpcycpO1xyXG4gICAgICAgICAgICBsZXQgYXhpc1RleHQgPSBheGlzLnRleHRDb250ZW50LnNwbGl0KCcgJylbMV07XHJcblxyXG4gICAgICAgICAgICBsZXQgYWRqYWNlbnRzID0gYm9hcmQuZ2V0QWRqYWNlbnRzKGJvYXJkLCBzaXplLCBkaXYuaWQpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGF4aXNUZXh0ID09PSAnWCcpIHtcclxuICAgICAgICAgICAgICAgIGxldCBhZGpXaXRoU2hpcCA9IGFkamFjZW50c1swXS5zb21lKHggPT4gYm9hcmQuaGFzU2hpcCh4KSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoYm9hcmQuaGFzU2hpcChkaXYuaWQpIHx8IGRpdi5kYXRhc2V0LmNOb3RBbGxvd2VkIHx8IGFkaldpdGhTaGlwICB8fCBhZGphY2VudHNbMF0ubGVuZ3RoIDwgc2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChib2FyZC5oYXNTaGlwKGRpdi5pZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmN1cnNvciA9ICdub3QtYWxsb3dlZCc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuYmFja2dyb3VuZCA9ICdyZWQnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuY3Vyc29yID0gJ25vdC1hbGxvd2VkJztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkamFjZW50c1swXS5mb3JFYWNoKHBvc2l0aW9uID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHViaSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdWJpLnN0eWxlLmJhY2tncm91bmQgPSAnYmxhY2snO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuYmFja2dyb3VuZCA9ICdibGFjayc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5jdXJzb3IgPSAnY3Jvc3NoYWlyJzsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH07IFxyXG4gICAgICAgICAgICAgICAgfTsgICBcclxuICAgICAgICBcclxuXHJcbiAgICAgICAgICAgIGlmIChheGlzVGV4dCA9PT0gJ1knKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgYWRqV2l0aFNoaXAgPSBhZGphY2VudHNbMV0uc29tZSh4ID0+IGJvYXJkLmhhc1NoaXAoeCkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGJvYXJkLmhhc1NoaXAoZGl2LmlkKSB8fCBkaXYuZGF0YXNldC55Tm90QWxsb3dlZCB8fCBhZGpXaXRoU2hpcCAgfHwgYWRqYWNlbnRzWzFdLmxlbmd0aCA8IHNpemUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYm9hcmQuaGFzU2hpcChkaXYuaWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5jdXJzb3IgPSAnbm90LWFsbG93ZWQnO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmJhY2tncm91bmQgPSAncmVkJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmN1cnNvciA9ICdub3QtYWxsb3dlZCc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGphY2VudHNbMV0uZm9yRWFjaChwb3NpdGlvbiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB1YmkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHViaS5zdHlsZS5iYWNrZ3JvdW5kID0gJ2JsYWNrJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmJhY2tncm91bmQgPSAnYmxhY2snO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuY3Vyc29yID0gJ2Nyb3NzaGFpcic7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9OyAgXHJcbiAgICAgICAgICAgICAgICB9OyBcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIGRpdi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgdGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubXktbmFtZScpO1xyXG4gICAgICAgICAgICBsZXQgbmFtZSA9IHRpdGxlLnRleHRDb250ZW50O1xyXG4gICAgICAgICAgICBsZXQgc3BsaXQgPSBuYW1lLnNwbGl0KCcgJyk7XHJcbiAgICAgICAgICAgIGxldCBzaGlwID0gc3BsaXRbc3BsaXQubGVuZ3RoIC0xXTtcclxuICAgICAgICAgICAgbGV0IGluZGV4ID0gc2hpcHMuaW5kZXhPZihzaGlwKTtcclxuICAgICAgICAgICAgbGV0IHNpemUgPSBzaXplc1tpbmRleF07XHJcbiAgICAgICAgICAgIGxldCBheGlzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmF4aXMnKTtcclxuICAgICAgICAgICAgbGV0IGF4aXNUZXh0ID0gYXhpcy50ZXh0Q29udGVudC5zcGxpdCgnICcpWzFdO1xyXG5cclxuICAgICAgICAgICAgbGV0IGFkamFjZW50cyA9IGJvYXJkLmdldEFkamFjZW50cyhib2FyZCwgc2l6ZSwgZGl2LmlkKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChheGlzVGV4dCA9PT0gJ1gnKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGl2LmRhdGFzZXQueE5vdEFsbG93ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuYmFja2dyb3VuZCA9ICdsaWdodGdvbGRlbnJvZHllbGxvdyc7XHJcbiAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmN1cnNvciA9ICdjcm9zc2hhaXInOyBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChib2FyZC5oYXNTaGlwKGRpdi5pZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuYmFja2dyb3VuZCA9ICdncmVlbic7XHJcbiAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmN1cnNvciA9ICdub3QtYWxsb3dlZCc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGphY2VudHNbMF0uZm9yRWFjaChwb3NpdGlvbiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChib2FyZC5oYXNTaGlwKHBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmN1cnNvciA9ICdub3QtYWxsb3dlZCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdWJpID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdWJpLnN0eWxlLmJhY2tncm91bmQgPSAnZ3JlZW4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHViaSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHViaS5zdHlsZS5iYWNrZ3JvdW5kID0gJ2xpZ2h0Z29sZGVucm9keWVsbG93JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5iYWNrZ3JvdW5kID0gJ2xpZ2h0Z29sZGVucm9keWVsbG93JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKGF4aXNUZXh0ID09PSAnWScpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkaXYuZGF0YXNldC55Tm90QWxsb3dlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5iYWNrZ3JvdW5kID0gJ2xpZ2h0Z29sZGVucm9keWVsbG93JztcclxuICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuY3Vyc29yID0gJ2Nyb3NzaGFpcic7IFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGJvYXJkLmhhc1NoaXAoZGl2LmlkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5iYWNrZ3JvdW5kID0gJ2dyZWVuJztcclxuICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuY3Vyc29yID0gJ25vdC1hbGxvd2VkJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGFkamFjZW50c1sxXS5mb3JFYWNoKHBvc2l0aW9uID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJvYXJkLmhhc1NoaXAocG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuY3Vyc29yID0gJ25vdC1hbGxvd2VkJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB1YmkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1Ymkuc3R5bGUuYmFja2dyb3VuZCA9ICdncmVlbic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdWJpID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdWJpLnN0eWxlLmJhY2tncm91bmQgPSAnbGlnaHRnb2xkZW5yb2R5ZWxsb3cnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmJhY2tncm91bmQgPSAnbGlnaHRnb2xkZW5yb2R5ZWxsb3cnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICBkaXYuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIGxldCB0aXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5teS1uYW1lJyk7XHJcbiAgICAgICAgICAgIC8vIGxldCBuYW1lID0gdGl0bGUudGV4dENvbnRlbnQ7XHJcbiAgICAgICAgICAgIC8vIGxldCBzcGxpdCA9IG5hbWUuc3BsaXQoJyAnKTtcclxuICAgICAgICAgICAgLy8gbGV0IHNoaXAgPSBzcGxpdFtzcGxpdC5sZW5ndGggLTFdO1xyXG4gICAgICAgICAgICAvLyBsZXQgaW5kZXggPSBzaGlwcy5pbmRleE9mKHNoaXApO1xyXG4gICAgICAgICAgICAvLyBsZXQgc2l6ZSA9IHNpemVzW2luZGV4XTtcclxuICAgICAgICAgICAgLy8gbGV0IGF4aXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXhpcycpO1xyXG4gICAgICAgICAgICAvLyBsZXQgYXhpc1RleHQgPSBheGlzLnRleHRDb250ZW50LnNwbGl0KCcgJylbMV07XHJcblxyXG4gICAgICAgICAgICAvLyBsZXQgYWRqYWNlbnRzID0gYm9hcmQuZ2V0QWRqYWNlbnRzKGJvYXJkLCBzaXplLCBkaXYuaWQpO1xyXG5cclxuICAgICAgICAgICAgLy8gaWYgKGF4aXNUZXh0ID09PSAnWCcpIHtcclxuICAgICAgICAgICAgLy8gICAgIGxldCBwbGFjZWQgPSBib2FyZC5wbGFjZVNoaXAoc2l6ZSwgYWRqYWNlbnRzWzBdKTtcclxuICAgICAgICAgICAgLy8gfVxyXG5cclxuICAgICAgICAgICAgLy8gaWYgKGF4aXNUZXh0ID09PSAnWScpIHtcclxuICAgICAgICAgICAgLy8gICAgIGxldCBwbGFjZWQgPSBib2FyZC5wbGFjZVNoaXAoc2l6ZSwgYWRqYWNlbnRzW2FdKTtcclxuICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gcmVuZGVyTXlCb2FyZChib2FyZCk7XHJcbiAgICAgICAgICAgIC8vIGlmIChwbGFjZSBzaGlwIGlzIHRob3NlIGNvb3JkaW5hdGVzID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBwb3MgKz0gMTtcclxuICAgICAgICAgICAgICAgIGlmIChwb3MgPT09IHNoaXBzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJJbml0YWxCb2FyZHMobmFtZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBteU5hbWUudGV4dENvbnRlbnQgPSBgJHtuYW1lfSwgIHBsYWNlIHlvdXIgICR7c2hpcHNbcG9zXX1gO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvL3JlbmRlciBib2FyZCAvLyBcclxuICAgICAgICAgICAgLy8gcmVuZGVyIHRleHQgd2l0aCBuYW1lIG9mIHNoaXAgLy8gXHJcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIGhhc0FsbFNoaXBzUGxhY2VkIC8vIFxyXG4gICAgICAgICAgICAvLyBpZiBzbywgcmVuZGVyIGluaXRpYWwgYm9hcmRzIHRvIHBsYXkgLy8gXHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgbXlCb2FyZC5hcHBlbmRDaGlsZChkaXYpO1xyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgXHJcblxyXG4gICAgbXlOYW1lQm94LmFwcGVuZENoaWxkKG15TmFtZSk7XHJcbiAgICBteU5hbWVCb3guYXBwZW5kQ2hpbGQoYXhpcyk7XHJcbiAgICBteUdhbWVTZWN0aW9uLmFwcGVuZENoaWxkKG15Qm9hcmQpO1xyXG4gICAgbXlTZWN0aW9uLmFwcGVuZENoaWxkKG15TmFtZUJveCk7XHJcbiAgICBteVNlY3Rpb24uYXBwZW5kQ2hpbGQobXlHYW1lU2VjdGlvbik7XHJcbiAgICBcclxuICAgIGJvYXJkLnBsYWNlU2hpcCgzLCBbJzEsMScsICcxLDInLCAnMSwzJ10pO1xyXG4gICAgbWFpbi5hcHBlbmRDaGlsZChteVNlY3Rpb24pO1xyXG4gICAgcmVuZGVyTXlCb2FyZChib2FyZCk7XHJcblxyXG4gICAgLy8gSUYgQU5ZIE9GIEFESkFDRU5UUyBIQVMgU0hJUCBNQVJLRUQgV0lUSCBSRUQgQU5EIENST1NTIC8vIFxyXG4gICAgXHJcblxyXG59XHJcblxyXG5mdW5jdGlvbiByZW5kZXJJbml0YWxCb2FyZHMgKG5hbWUpIHtcclxuICAgIGNvbnN0IG1haW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbicpO1xyXG5cclxuICAgIGNvbnN0IG15U2VjdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgbXlHYW1lU2VjdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgbXlCb2FyZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgbXlOYW1lQm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCBteU5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpO1xyXG4gICAgICAgIFxyXG4gICAgY29uc3QgZW5lbXlTZWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCBlbmVteUdhbWVTZWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCBlbmVteUJvYXJkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCBlbmVteU5hbWVCb3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IGVuZW15TmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XHJcblxyXG4gICAgXHJcbiAgICBteVNlY3Rpb24uY2xhc3NMaXN0LmFkZCgnbXktc2VjdGlvbicpO1xyXG4gICAgbXlHYW1lU2VjdGlvbi5jbGFzc0xpc3QuYWRkKCdteS1nYW1lLXNlY3Rpb24nKTtcclxuICAgIG15Qm9hcmQuY2xhc3NMaXN0LmFkZCgnbXktYm9hcmQnKTtcclxuICAgIG15TmFtZUJveC5jbGFzc0xpc3QuYWRkKCdteS1uYW1lLWJveCcpO1xyXG4gICAgbXlOYW1lLmNsYXNzTGlzdC5hZGQoJ215LW5hbWUnKTtcclxuICAgIFxyXG4gICAgZW5lbXlTZWN0aW9uLmNsYXNzTGlzdC5hZGQoJ2VuZW15LXNlY3Rpb24nKTtcclxuICAgIGVuZW15R2FtZVNlY3Rpb24uY2xhc3NMaXN0LmFkZCgnZW5lbXktZ2FtZS1zZWN0aW9uJyk7XHJcbiAgICBlbmVteUJvYXJkLmNsYXNzTGlzdC5hZGQoJ2VuZW15LWJvYXJkJyk7XHJcbiAgICBlbmVteU5hbWVCb3guY2xhc3NMaXN0LmFkZCgnZW5lbXktbmFtZS1ib3gnKTtcclxuICAgIGVuZW15TmFtZS5jbGFzc0xpc3QuYWRkKCdlbmVteS1uYW1lJyk7XHJcblxyXG5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgODsgaSArPSAxKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCA4OyBqICs9IDEpIHtcclxuICAgICAgICAgIGNvbnN0IGNvb3JkaW5hdGUgPSBgJHtpfSwke2p9YDtcclxuICAgICAgICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgY29uc3QgZGl2RW5lbXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgIGRpdi5jbGFzc0xpc3QuYWRkKCdteS1kaXYtYm94Jyk7XHJcbiAgICAgICAgICBkaXZFbmVteS5jbGFzc0xpc3QuYWRkKCdlbmVteS1kaXYtYm94Jyk7XHJcblxyXG4gICAgICAgICAgZGl2LmlkID0gYFAgJHtjb29yZGluYXRlfWA7XHJcbiAgICAgICAgICBkaXZFbmVteS5pZCA9IGBFICR7Y29vcmRpbmF0ZX1gO1xyXG4gIFxyXG4gICAgICAgICAgbXlCb2FyZC5hcHBlbmRDaGlsZChkaXYpO1xyXG4gICAgICAgICAgZW5lbXlCb2FyZC5hcHBlbmRDaGlsZChkaXZFbmVteSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG15TmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICBlbmVteU5hbWUudGV4dENvbnRlbnQgPSAnRW5lbXknO1xyXG5cclxuICAgIG15TmFtZUJveC5hcHBlbmRDaGlsZChteU5hbWUpO1xyXG4gICAgbXlHYW1lU2VjdGlvbi5hcHBlbmRDaGlsZChteUJvYXJkKTtcclxuICAgIG15U2VjdGlvbi5hcHBlbmRDaGlsZChteU5hbWVCb3gpO1xyXG4gICAgbXlTZWN0aW9uLmFwcGVuZENoaWxkKG15R2FtZVNlY3Rpb24pO1xyXG4gICAgXHJcbiAgICBlbmVteU5hbWVCb3guYXBwZW5kQ2hpbGQoZW5lbXlOYW1lKTtcclxuICAgIGVuZW15R2FtZVNlY3Rpb24uYXBwZW5kQ2hpbGQoZW5lbXlCb2FyZCk7XHJcbiAgICBlbmVteVNlY3Rpb24uYXBwZW5kQ2hpbGQoZW5lbXlOYW1lQm94KTtcclxuICAgIGVuZW15U2VjdGlvbi5hcHBlbmRDaGlsZChlbmVteUdhbWVTZWN0aW9uKTtcclxuXHJcbiAgICBtYWluLmFwcGVuZENoaWxkKG15U2VjdGlvbik7XHJcbiAgICBtYWluLmFwcGVuZENoaWxkKGVuZW15U2VjdGlvbik7XHJcblxyXG4gICAgbWFpbi5jbGFzc0xpc3QuYWRkKCdtYWluLWdhbWUnKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVuZGVyTXlCb2FyZCAoYm9hcmQpIHtcclxuICAgIGNvbnN0IGJveGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm15LWRpdi1ib3gnKTtcclxuICAgIGJveGVzLmZvckVhY2goYm94ID0+IHtcclxuICAgICAgIGxldCBjb29yZGluYXRlcyA9IGJveC5pZDtcclxuICAgICAgICBpZiAoYm9hcmQuYm9hcmRbY29vcmRpbmF0ZXNdLmhhc1NoaXApIHtcclxuICAgICAgICAgICAgYm94LnN0eWxlLmJhY2tncm91bmQgPSAnZ3JlZW4nO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYm9hcmQuYm9hcmRbY29vcmRpbmF0ZXNdLmF0dGFja2VkKSB7XHJcbiAgICAgICAgICAgIGJveC5pbm5lckhUTUwgPSAn4p2MJztcclxuICAgICAgICAgICAgYm94LnN0eWxlLmJhY2tncm91bmQgPSAnI0Y1QzJDMSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChib2FyZC5ib2FyZFtjb29yZGluYXRlc10ubWlzc2VkKSB7XHJcbiAgICAgICAgICAgIGJveC5pbm5lckhUTUwgPSAn8J+Spic7XHJcbiAgICAgICAgICAgIGJveC5zdHlsZS5iYWNrZ3JvdW5kID0gJ2xpZ2h0Ymx1ZSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGVsc2UgaWYgKCFib2FyZC5ib2FyZFtjb29yZGluYXRlc10ubWlzc2VkICYmICFib2FyZC5ib2FyZFtjb29yZGluYXRlc10uYXR0YWNrZWQgJiYgYm9hcmQuYm9hcmRbY29vcmRpbmF0ZXNdLmhhc1NoaXApIHtcclxuICAgICAgICAvLyAgICAgYm94LnN0eWxlLmJhY2tncm91bmQgPSAnbGlnaHRnb2xkZW5yb2R5ZWxsb3cnO1xyXG4gICAgICAgIC8vIH1cclxuICAgIH0pO1xyXG59O1xyXG5cclxuXHJcbmZ1bmN0aW9uIHJlbmRlckVuZW15Qm9hcmQgKGJvYXJkKSB7XHJcbiAgICBjb25zdCBib3hlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lbmVteS1kaXYtYm94Jyk7XHJcblxyXG4gICAgZm9yIChjb25zdCBib3ggb2YgYm94ZXMpIHtcclxuICAgICAgICBsZXQgY29vcmRpbmF0ZXMgPSBib3guaWQ7XHJcbiAgICAgICAgbGV0IHNwbGl0ID0gY29vcmRpbmF0ZXMuc3BsaXQoJyAnKTtcclxuICAgICAgICBsZXQgbnVtID0gc3BsaXRbMV07IFxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChib2FyZC5ib2FyZFtudW1dLmhhc1NoaXApIHtcclxuICAgICAgICAgICAgYm94LnN0eWxlLmJhY2tncm91bmQgPSAnb3JhbmdlJztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGJvYXJkLmJvYXJkW251bV0uYXR0YWNrZWQpIHtcclxuICAgICAgICAgICAgYm94LmlubmVySFRNTCA9ICfinYwnO1xyXG4gICAgICAgICAgICBib3guc3R5bGUuYmFja2dyb3VuZCA9ICcjRjVDMkMxJztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGJvYXJkLmJvYXJkW251bV0ubWlzc2VkKSB7XHJcbiAgICAgICAgICAgIGJveC5pbm5lckhUTUwgPSAn8J+Spic7XHJcbiAgICAgICAgICAgIGJveC5zdHlsZS5iYWNrZ3JvdW5kID0gJ2xpZ2h0Ymx1ZSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChib2FyZC5ib2FyZFtudW1dLmhhc1NoaXApIHtcclxuICAgICAgICAgICAgYm94LmlubmVySFRNTCA9ICfwn5qiJztcclxuICAgICAgICAgICAgYm94LnN0eWxlLmJhY2tncm91bmQgPSAnbGlnaHRibHVlJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5cclxuXHJcblxyXG5mdW5jdGlvbiByZW5kZXJXaW4gKCkge1xyXG4gICAgY29uc3QgbWFpbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluJyk7XHJcbiAgICBjb25zdCBib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTsgXHJcbiAgICBjb25zdCBwbGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJylcclxuXHJcbiAgICBib3guY2xhc3NMaXN0LmFkZCgncG9wLXVwLWJveCcpO1xyXG4gICAgdGl0bGUuY2xhc3NMaXN0LmFkZCgndGl0bGUtcG9wLXVwJyk7XHJcbiAgICBwbGF5LmNsYXNzTGlzdC5hZGQoJ3BsYXktYnV0dG9uJyk7XHJcblxyXG4gICAgdGl0bGUudGV4dENvbnRlbnQgPSAnWW91IFdpbic7XHJcbiAgICBwbGF5LmlubmVySFRNTCA9ICdQbGF5IEFnYWluJztcclxuICAgIHBsYXkudHlwZSA9ICdzdWJtaXQnO1xyXG5cclxuICAgIGJveC5hcHBlbmRDaGlsZCh0aXRsZSk7XHJcbiAgICBib3guYXBwZW5kQ2hpbGQocGxheSk7XHJcblxyXG4gICAgbWFpbi5hcHBlbmRDaGlsZChib3gpO1xyXG5cclxuICAgIHBsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgY2xlYW4oKTtcclxuICAgICAgICB3cml0ZU5hbWUoKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW5kZXJMb3NlICgpIHtcclxuICAgIGNvbnN0IG1haW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbicpO1xyXG4gICAgY29uc3QgYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7IFxyXG4gICAgY29uc3QgcGxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpXHJcblxyXG4gICAgYm94LmNsYXNzTGlzdC5hZGQoJ3BvcC11cC1ib3gnKTtcclxuICAgIHRpdGxlLmNsYXNzTGlzdC5hZGQoJ3RpdGxlLXBvcC11cCcpO1xyXG4gICAgcGxheS5jbGFzc0xpc3QuYWRkKCdwbGF5LWJ1dHRvbicpO1xyXG5cclxuICAgIHRpdGxlLnRleHRDb250ZW50ID0gJ1lvdSBMb3NlJztcclxuICAgIHBsYXkuaW5uZXJIVE1MID0gJ1BsYXkgQWdhaW4nO1xyXG4gICAgcGxheS50eXBlID0gJ3N1Ym1pdCc7XHJcblxyXG4gICAgYm94LmFwcGVuZENoaWxkKHRpdGxlKTtcclxuICAgIGJveC5hcHBlbmRDaGlsZChwbGF5KTtcclxuXHJcbiAgICBtYWluLmFwcGVuZENoaWxkKGJveCk7XHJcblxyXG4gICAgcGxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICBjbGVhbigpO1xyXG4gICAgICAgIHdyaXRlTmFtZSgpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsZWFuICgpIHtcclxuICAgIGNvbnN0IG1haW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbicpO1xyXG4gICAgbWFpbi5pbm5lckhUTUwgPSAnJztcclxufVxyXG5cclxuXHJcbmV4cG9ydCB7d3JpdGVOYW1lLCBjbGVhbiwgcmVuZGVySW5pdGFsQm9hcmRzLCByZW5kZXJNeUJvYXJkLCByZW5kZXJFbmVteUJvYXJkLCByZW5kZXJXaW4sIHJlbmRlckxvc2V9O1xyXG4iLCIvLyBMaW50ZXIsIFByZXR0aWVyLCBKZXN0LmNvbmZpZyAvLyBcclxuXHJcbmltcG9ydCB7IFNoaXAsIEdhbWVib2FyZCwgUGxheWVyIH0gZnJvbSBcIi4vZmFjdG9yaWVzXCI7XHJcbmltcG9ydCB7IHdyaXRlTmFtZSwgY2xlYW4sIHJlbmRlckluaXRhbEJvYXJkcywgcmVuZGVyV2luLCByZW5kZXJMb3NlLCBzZWxlY3RTaGlwcyB9IGZyb20gXCIuL3JlbmRlclwiO1xyXG5pbXBvcnQgeyBnYW1lIH0gZnJvbSBcIi4vZ2FtZVwiO1xyXG5cclxud3JpdGVOYW1lKCk7Il0sIm5hbWVzIjpbIlNoaXAiLCJjb25zdHJ1Y3RvciIsInNpemUiLCJ0aGlzIiwiaGl0Iiwic3VuayIsImNvb3JkaW5hdGVzIiwicmVnaXN0ZXJIaXQiLCJpc1N1bmsiLCJhZGRDb29yZGluYXRlcyIsInBvc2l0aW9uIiwicHVzaCIsIm1vZHVsZSIsImV4cG9ydHMiLCJHYW1lYm9hcmQiLCJib2FyZCIsInNoaXBzIiwiY3JlYXRlQm9hcmQiLCJpIiwiaiIsImNvb3JkaW5hdGUiLCJhdHRhY2tlZCIsIm1pc3NlZCIsImhhc1NoaXAiLCJzaGlwIiwiaXNWYWxpZCIsImFyciIsInNwbGl0IiwiYSIsIk51bWJlciIsImIiLCJnZXRCb2FyZCIsImFkZFNoaXAiLCJwbGFjZVNoaXAiLCJsZW5ndGgiLCJpc01vdmVMZWdhbCIsIm1vdmUiLCJwbGFjZUVuZW15U2hpcHMiLCJjb29yZGluYXRlQ2FycmllciIsImNyZWF0ZUNvb3JkaW5hdGVzIiwiY29vcmRpbmF0ZUJhdHRsZXNoaXAiLCJjb29yZGluYXRlQ3J1aXNlciIsImNvb3JkaW5hdGVTdWJtYXJpbmUiLCJjb29yZGluYXRlRGVzdHJveWVyIiwiYXJyYXkiLCJib2FyZEFycmF5IiwiZ2V0QWRqYWNlbnRzIiwic2l6ZXMiLCJmaWx0ZXJlZCIsInRlbXAiLCJmaWx0ZXIiLCJwb3MiLCJmb3JFYWNoIiwic2V0T2ZDb29yZGluYXRlcyIsIm51bTEiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJudW0yIiwicmVzdWx0IiwiYXJyYXlCb2FyZCIsImFkamFjZW50cyIsInJpZ2h0IiwiZG93biIsImluZGV4IiwicGxhY2UiLCJwbGFjZVNwbGl0IiwiaW5jbHVkZXMiLCJoYXNBbGxTaGlwc1BsYWNlZCIsInJlY2VpdmVBdHRhY2siLCJzdHIiLCJnZXRTaGlwcyIsImFsbFN1bmsiLCJldmVyeSIsIm9iaiIsImtleSIsIlBsYXllciIsImdhbWVib2FyZCIsIm1ha2VSYW5kb21Nb3ZlIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsIm5hbWUiLCJtYWluIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIm15U2VjdGlvbiIsImNyZWF0ZUVsZW1lbnQiLCJteUdhbWVTZWN0aW9uIiwibXlCb2FyZCIsIm15TmFtZUJveCIsIm15TmFtZSIsImVuZW15U2VjdGlvbiIsImVuZW15R2FtZVNlY3Rpb24iLCJlbmVteUJvYXJkIiwiZW5lbXlOYW1lQm94IiwiZW5lbXlOYW1lIiwiY2xhc3NMaXN0IiwiYWRkIiwiZGl2IiwiZGl2RW5lbXkiLCJpZCIsImFwcGVuZENoaWxkIiwidGV4dENvbnRlbnQiLCJjbGVhbiIsImlubmVySFRNTCIsImJveCIsInRpdGxlIiwiaW5wdXQiLCJwbGF5IiwidHlwZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJ2YWx1ZSIsImF4aXMiLCJkYXRhc2V0IiwieE5vdEFsbG93ZWQiLCJ5Tm90QWxsb3dlZCIsInF1ZXJ5U2VsZWN0b3IiLCJpbmRleE9mIiwiYXhpc1RleHQiLCJhZGpXaXRoU2hpcCIsInNvbWUiLCJ4IiwiY05vdEFsbG93ZWQiLCJzdHlsZSIsImJhY2tncm91bmQiLCJjdXJzb3IiLCJxdWVyeVNlbGVjdG9yQWxsIiwicmVuZGVyUGxhY2VTaGlwcyIsImFsZXJ0Iiwid3JpdGVOYW1lIl0sInNvdXJjZVJvb3QiOiIifQ==