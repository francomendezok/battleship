(()=>{var e={776:e=>{class t{constructor(e){this.size=e,this.hit=0,this.sunk=!1,this.coordinates=[]}registerHit(){return this.hit+=1}isSunk(){return this.hit===this.size}addCoordinates(e){this.coordinates.push(e)}}class a{constructor(){this.board=[],this.ships=[]}createBoard(e=8){for(let t=0;t<e;t+=1)for(let a=0;a<e;a+=1){const e=`${t},${a}`;this.board[e]={coordinates:e,attacked:!1,missed:!1,hasShip:!1,ship:[]}}return this.board}isValid(e){let t=e.split(","),a=Number(t[0]),i=Number(t[1]);return a>=0&&a<=7&&i>=0&&i<=7}getBoard(){return this.board}addShip(e){this.ships.push(e)}placeShip(e,a){if(e!==a.length)return"Size and coordinates length should be equal";const i=new t(e);for(let e=0;e<a.length;e++)if(this.isValid(a[e]))this.board[a[e]].ship.push(a),this.board[a[e]].hasShip=!0;else if(!this.isValid(a[e]))return"No Valid";return i.addCoordinates(a),this.addShip(i),this.board}isMoveLegal(e){return!this.board[e].attacked&&!this.board[e].missed}placeEnemyShips(e){this.createCoordinates(5),this.createCoordinates(4),this.createCoordinates(3),this.createCoordinates(3),this.createCoordinates(2)}createCoordinates(e){let t=Math.floor(8*Math.random()),a=Math.floor(8*Math.random()),i=`${t},${a}`,s=[];if(this.isMoveLegal(i))s.push(i);else for(;!this.isMoveLegal(i);)t=Math.floor(8*Math.random()),a=Math.floor(8*Math.random()),i=`${t},${a}`;let n=i.split(",");s.push(i);for(let t=0;t<e-1;t++)n[Math.floor(2*Math.random())];return s}getAdjacents(e,t,a){let i=[[],[],[],[]],s=8,n=1,d=8,o=1,r=0;for(let t=0;t<e.length;t++)if(e[t].coordinates===a){r=t;break}for(let c=0;c<t;c++){if(e[r-s]){let t=a.split(","),n=e[r-s].coordinates;n.split(","),n&&n.includes(t[1])&&(i[0].push(e[r-s].coordinates),s+=8)}if(e[r+n]){let t=a.split(","),s=e[r+n].coordinates,d=s.split(",");s&&d[0]===t[0]&&(i[1].push(e[r+n].coordinates),n++)}if(e[r+d]){let t=a.split(","),s=e[r+d].coordinates;s.split(","),s&&s.includes(t[1])&&(i[2].push(e[r+d].coordinates),d+=8)}if(e[r-o]){let t=a.split(","),s=e[r-o].coordinates,n=s.split(",");s&&n[0]===t[0]&&(i[3].push(e[r-o].coordinates),o++)}}return i}receiveAttack(e){let t=`${e}`;if(!this.board[t].attacked&&!this.board[t].missed)return this.board[t].hasShip?(this.board[t].attacked=!0,this.ships.forEach((e=>{e.coordinates[0].includes(t)&&(e.registerHit(),e.isSunk()&&(e.sunk=!0))}))):this.board[t].missed=!0,!0}getShips(){return this.ships}allSunk(){return this.ships.every((e=>!0===e.sunk))}boardArray(){const e=this.board,t=[];for(let a in e)t.push(e[a]);return t}}let i=new a;i.createBoard(),i.placeShip(3,["7,1","7,2","7,3"]),i.placeShip(3,["0,1","0,2","0,3"]),i.receiveAttack("0,1"),i.receiveAttack("0,2"),i.receiveAttack("0,3"),i.receiveAttack("7,1"),i.receiveAttack("7,2"),i.receiveAttack("7,3");let s=i.boardArray();i.getAdjacents(s,4,"6,7");class n{constructor(e){this.gameboard=e}isMoveLegal(e){return!this.gameboard.board[e].attacked&&!this.gameboard.board[e].missed}makeRandomMove(){let e=Math.floor(8*Math.random()),t=Math.floor(8*Math.random()),a=`${e},${t}`;if(this.isMoveLegal(a))return a;for(;!this.isMoveLegal(a);)e=Math.floor(8*Math.random()),t=Math.floor(8*Math.random()),a=`${e},${t}`;return a}}new n(i),e.exports={Ship:t,Gameboard:a,Player:n}}},t={};function a(i){var s=t[i];if(void 0!==s)return s.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,a),n.exports}(()=>{"use strict";var e=a(776);function t(){const a=document.getElementById("main"),r=document.createElement("div"),c=document.createElement("h3"),l=document.createElement("input"),m=document.createElement("button");r.classList.add("pop-up-box"),c.classList.add("title-pop-up"),l.classList.add("input-pop-up"),m.classList.add("play-button"),c.textContent="Write your Name",m.innerHTML="Battle",l.type="text",m.type="submit",r.appendChild(c),r.appendChild(l),r.appendChild(m),a.appendChild(r),m.addEventListener("click",(()=>{o(),function(a){let r=new e.Gameboard,c=new e.Gameboard;r.createBoard(),c.createBoard(),function(e){const t=document.getElementById("main"),a=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div"),n=document.createElement("div"),d=document.createElement("h3"),o=document.createElement("div"),r=document.createElement("div"),c=document.createElement("div"),l=document.createElement("div"),m=document.createElement("div"),h=document.createElement("h3"),p=document.createElement("img"),u=document.createElement("img"),b=document.createElement("img"),g=document.createElement("img"),f=document.createElement("img");p.src="../dist/Images/5.png",u.src="../dist/Images/5.png",b.src="../dist/Images/5.png",g.src="../dist/Images/5.png",f.src="../dist/Images/5.png",[p,u,b,g,f].forEach((e=>{e.classList.add("ship"),o.appendChild(e)})),a.classList.add("my-section"),i.classList.add("my-game-section"),s.classList.add("my-board"),n.classList.add("my-name-box"),d.classList.add("my-name"),o.classList.add("my-ships"),r.classList.add("enemy-section"),c.classList.add("enemy-game-section"),l.classList.add("enemy-board"),m.classList.add("enemy-name-box"),h.classList.add("enemy-name");for(let e=0;e<8;e+=1)for(let t=0;t<8;t+=1){const a=`${e},${t}`,i=document.createElement("div"),n=document.createElement("div");i.classList.add("my-div-box"),n.classList.add("enemy-div-box"),i.id=`P ${a}`,n.id=`E ${a}`,s.appendChild(i),l.appendChild(n)}d.textContent=e,h.textContent="Enemy",n.appendChild(d),i.appendChild(s),a.appendChild(n),a.appendChild(i),m.appendChild(h),c.appendChild(l),r.appendChild(m),r.appendChild(c),t.appendChild(a),t.appendChild(o),t.appendChild(r),t.classList.add("main-game")}(a),function(e){let t=document.querySelectorAll(".ship"),a=[5,4,3,3,2];for(let i=0;i<t.length;i++)t[i].dataset.size=a[i],t[i].addEventListener("click",(a=>{d(t,t[i]),n(e,a.target.dataset.size)}))}(r);let l=new e.Player(r),m=new e.Player(c);i(l.gameboard),s(m.gameboard),[...document.querySelectorAll(".enemy-div-box")].forEach((e=>{e.addEventListener("click",(e=>{let a=e.target.id.split(" ")[1],n=m.makeRandomMove(),d=r.receiveAttack(n);if(c.receiveAttack(a)){s(m.gameboard),setTimeout((function(){for(;!d;)n=m.makeRandomMove(),d=r.receiveAttack(n);i(l.gameboard)}),1e3);let e=r.allSunk(),a=c.allSunk();e&&(o(),function(){const e=document.getElementById("main"),a=document.createElement("div"),i=document.createElement("h3"),s=document.createElement("button");a.classList.add("pop-up-box"),i.classList.add("title-pop-up"),s.classList.add("play-button"),i.textContent="You Lose",s.innerHTML="Play Again",s.type="submit",a.appendChild(i),a.appendChild(s),e.appendChild(a),s.addEventListener("click",(()=>{o(),t()}))}()),a&&(o(),function(){const e=document.getElementById("main"),a=document.createElement("div"),i=document.createElement("h3"),s=document.createElement("button");a.classList.add("pop-up-box"),i.classList.add("title-pop-up"),s.classList.add("play-button"),i.textContent="You Win",s.innerHTML="Play Again",s.type="submit",a.appendChild(i),a.appendChild(s),e.appendChild(a),s.addEventListener("click",(()=>{o(),t()}))}())}}))}))}(l.value)}))}function i(e){const t=document.querySelectorAll(".my-div-box");for(const a of t){let t=a.id.split(" ")[1];e.board[t].hasShip&&(a.style.background="green"),e.board[t].attacked&&(a.innerHTML="❌",a.style.background="#F5C2C1"),e.board[t].missed&&(a.innerHTML="💦",a.style.background="lightblue")}}function s(e){const t=document.querySelectorAll(".enemy-div-box");for(const a of t){let t=a.id.split(" ")[1];e.board[t].hasShip&&(a.style.background="orange"),e.board[t].attacked&&(a.innerHTML="❌",a.style.background="#F5C2C1"),e.board[t].missed&&(a.innerHTML="💦",a.style.background="lightblue")}}function n(e,t){let a=document.querySelectorAll(".my-div-box"),i=e.boardArray();t&&a.forEach((a=>{a.addEventListener("mouseover",(()=>{let s=a.id.split(","),n=`${s[0].split(" ")[1]},${s[1]}`;!function(e,t){if(e.length!==t)return null;e.forEach((e=>{let t=`P ${e}`,a=document.getElementById(t);a.addEventListener("mouseover",(()=>{a.style.background="black"}))}))}(e.getAdjacents(i,t,n)[0],t)}))}))}function d(e,t){e.forEach((e=>{e.classList.contains("ship-selected")&&e.classList.remove("ship-selected"),e===t&&e.classList.add("ship-selected")}))}function o(){document.getElementById("main").innerHTML=""}t()})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNFdkYsTUFBTSxLQUdwQm5CLEVBQWMsR0FGUm1CLEVBQU0sR0FBR0EsTUFBTSxLQUVBLE1BQU1BLEVBQU0sTUFzQnJELFNBQXlCb0IsRUFBVzNDLEdBQ2hDLEdBQUkyQyxFQUFVYixTQUFXOUIsRUFBTSxPQUFPLEtBRXRDMkMsRUFBVVcsU0FBUXFGLElBQ2QsSUFBSTdCLEVBQUssS0FBSzZCLElBQ1YvQixFQUFNakMsU0FBU0MsZUFBZWtDLEdBQzlCRixFQUFJcEIsaUJBQWlCLGFBQWEsS0FDOUJvQixFQUFJNkIsTUFBTUMsV0FBYSxPQUFPLEdBQ2pDLEdBRWIsQ0E1QmdCRSxDQUZnQmpELEVBQVFsRCxhQUFhbUIsRUFBTzVELEVBQU1JLEdBRXpCLEdBQUlKLEVBQUssR0FhcEMsR0FHZCxDQWVBLFNBQVNvSCxFQUFrQnhHLEVBQU9pSSxHQUM5QmpJLEVBQU0wQyxTQUFRbEMsSUFDTkEsRUFBSzhELFVBQVU0RCxTQUFTLGtCQUN4QjFILEVBQUs4RCxVQUFVNkQsT0FBTyxpQkFFdEIzSCxJQUFTeUgsR0FBVXpILEVBQUs4RCxVQUFVQyxJQUFJLGdCQUFnQixHQUVsRSxDQW9GQSxTQUFTTSxJQUNRZCxTQUFTQyxlQUFlLFFBQ2hDUyxVQUFZLEVBQ3JCLENFOVRBWixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9mYWN0b3JpZXMuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3JlbmRlci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2dhbWUuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTaGlwIENsYXNzIC8vXHJcbmNsYXNzIFNoaXAge1xyXG4gICAgY29uc3RydWN0b3IgKHNpemUpIHtcclxuICAgICAgICB0aGlzLnNpemUgPSBzaXplO1xyXG4gICAgICAgIHRoaXMuaGl0ID0gMDtcclxuICAgICAgICB0aGlzLnN1bmsgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNvb3JkaW5hdGVzID0gW107XHJcbiAgICB9XHJcblxyXG4gICAgcmVnaXN0ZXJIaXQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaGl0ICs9IDE7XHJcbiAgICB9XHJcblxyXG4gICAgaXNTdW5rKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmhpdCA9PT0gdGhpcy5zaXplO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZENvb3JkaW5hdGVzIChwb3NpdGlvbikge1xyXG4gICAgICAgIHRoaXMuY29vcmRpbmF0ZXMucHVzaChwb3NpdGlvbik7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIEdhbWVib2FyZCBDbGFzcyAvL1xyXG5jbGFzcyBHYW1lYm9hcmQge1xyXG4gICAgY29uc3RydWN0b3IgKCkge1xyXG4gICAgICAgIHRoaXMuYm9hcmQgPSBbXSBcclxuICAgICAgICB0aGlzLnNoaXBzID0gW11cclxuICAgIH1cclxuICAgIFxyXG4gICAgY3JlYXRlQm9hcmQoc2l6ZSA9IDggKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpICs9IDEpIHtcclxuICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgc2l6ZTsgaiArPSAxKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvb3JkaW5hdGUgPSBgJHtpfSwke2p9YDtcclxuICAgICAgICAgICAgdGhpcy5ib2FyZFtjb29yZGluYXRlXSA9IHsgY29vcmRpbmF0ZXM6IGNvb3JkaW5hdGUsIGF0dGFja2VkOiBmYWxzZSwgbWlzc2VkOiBmYWxzZSwgaGFzU2hpcDogZmFsc2UsIHNoaXA6IFtdIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5ib2FyZDtcclxuICAgICAgfVxyXG5cclxuICAgICAgaXNWYWxpZCAoY29vcmRpbmF0ZXMpIHtcclxuICAgICAgICBsZXQgYXJyID0gY29vcmRpbmF0ZXMuc3BsaXQoJywnKTtcclxuICAgICAgICBsZXQgYSA9IE51bWJlcihhcnJbMF0pO1xyXG4gICAgICAgIGxldCBiID0gTnVtYmVyKGFyclsxXSk7XHJcblxyXG5cclxuICAgICAgICByZXR1cm4gYSA+PSAwICYmIGEgPD0gNyAmJiBiID49IDAgJiYgYiA8PSA3O1xyXG4gICAgICB9XHJcblxyXG4gICAgICBnZXRCb2FyZCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5ib2FyZDtcclxuICAgICAgfVxyXG5cclxuICAgICAgYWRkU2hpcCAoc2hpcCkge1xyXG4gICAgICAgIHRoaXMuc2hpcHMucHVzaChzaGlwKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcGxhY2VTaGlwIChzaXplLCBjb29yZGluYXRlcykge1xyXG4gICAgICAgIGlmIChzaXplICE9PSBjb29yZGluYXRlcy5sZW5ndGgpIHJldHVybiAnU2l6ZSBhbmQgY29vcmRpbmF0ZXMgbGVuZ3RoIHNob3VsZCBiZSBlcXVhbCc7XHJcblxyXG4gICAgICAgIGNvbnN0IHNoaXAgPSBuZXcgU2hpcChzaXplKTtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb29yZGluYXRlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNWYWxpZChjb29yZGluYXRlc1tpXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJvYXJkW2Nvb3JkaW5hdGVzW2ldXS5zaGlwLnB1c2goY29vcmRpbmF0ZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYm9hcmRbY29vcmRpbmF0ZXNbaV1dLmhhc1NoaXAgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoIXRoaXMuaXNWYWxpZChjb29yZGluYXRlc1tpXSkpIHJldHVybiAnTm8gVmFsaWQnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgc2hpcC5hZGRDb29yZGluYXRlcyhjb29yZGluYXRlcyk7XHJcbiAgICAgICAgdGhpcy5hZGRTaGlwKHNoaXApO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ib2FyZDtcclxuICAgICAgfVxyXG5cclxuICAgICAgaXNNb3ZlTGVnYWwgKG1vdmUpIHtcclxuICAgICAgICByZXR1cm4gIXRoaXMuYm9hcmRbbW92ZV0uYXR0YWNrZWQgJiYgIXRoaXMuYm9hcmRbbW92ZV0ubWlzc2VkO1xyXG4gICAgfVxyXG5cclxuICAgICAgcGxhY2VFbmVteVNoaXBzIChib2FyZCkge1xyXG4gICAgICAgICAgICBsZXQgY2FycmllciA9IHRoaXMuY3JlYXRlQ29vcmRpbmF0ZXMoNSk7XHJcbiAgICAgICAgICAgIGxldCBiYXR0bGVzaGlwID0gdGhpcy5jcmVhdGVDb29yZGluYXRlcyg0KTtcclxuICAgICAgICAgICAgbGV0IGNydWlzZXIgPSB0aGlzLmNyZWF0ZUNvb3JkaW5hdGVzKDMpO1xyXG4gICAgICAgICAgICBsZXQgc3VibWFyaW5lID0gdGhpcy5jcmVhdGVDb29yZGluYXRlcygzKTtcclxuICAgICAgICAgICAgbGV0IGRlc3Ryb3llciA9IHRoaXMuY3JlYXRlQ29vcmRpbmF0ZXMoMik7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNyZWF0ZUNvb3JkaW5hdGVzIChzaXplKSB7XHJcbiAgICAgICAgbGV0IG51bTEgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA4KTsgXHJcbiAgICAgICAgbGV0IG51bTIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA4KTsgXHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IGAke251bTF9LCR7bnVtMn1gO1xyXG4gICAgICAgIGxldCBjb29yZGluYXRlcyA9IFtdO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5pc01vdmVMZWdhbChyZXN1bHQpKSBjb29yZGluYXRlcy5wdXNoKHJlc3VsdCk7XHJcbiAgICAgICAgICAgIC8vY2hlY2sgaWYgaGFzU2hpcCwgbm90IGF0dGFja2VkIG5vciBtaXNzZWQgLy9cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgd2hpbGUgKCF0aGlzLmlzTW92ZUxlZ2FsKHJlc3VsdCkpIHtcclxuICAgICAgICAgICAgICAgIG51bTEgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA4KTsgXHJcbiAgICAgICAgICAgICAgICBudW0yID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogOCk7IFxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gYCR7bnVtMX0sJHtudW0yfWA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBzcGxpdCA9IHJlc3VsdC5zcGxpdCgnLCcpO1xyXG5cclxuICAgICAgICBjb29yZGluYXRlcy5wdXNoKHJlc3VsdCk7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2l6ZSAtIDE7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgcmFuZG9tID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMik7IFxyXG4gICAgICAgICAgICBsZXQga2V5ID0gc3BsaXRbcmFuZG9tXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGxldCBwb3NzaWJpbGl0aWVzID0gW107XHJcbiAgICAgICAgICAgIC8vIDQgZ2V0IGFkamFjZW50cyAvLyBcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjb29yZGluYXRlcztcclxuICAgIH1cclxuXHJcbiAgICAgIGdldEFkamFjZW50cyAoYXJyYXlCb2FyZCwgc2l6ZSwgY29vcmRpbmF0ZXMpIHtcclxuICAgICAgICBsZXQgYWRqYWNlbnRzID0gW1tdLFtdLFtdLFtdXTtcclxuICAgICAgICBsZXQgdXAgPSA4O1xyXG4gICAgICAgIGxldCByaWdodCA9IDE7XHJcbiAgICAgICAgbGV0IGRvd24gPSA4O1xyXG4gICAgICAgIGxldCBsZWZ0ID0gMTtcclxuICAgICAgICBsZXQgaW5kZXggPSAwO1xyXG5cclxuICAgICAgICAvLyBnZXQgaW5kZXggLy9cclxuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGFycmF5Qm9hcmQubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgaWYgKGFycmF5Qm9hcmRbal0uY29vcmRpbmF0ZXMgPT09IGNvb3JkaW5hdGVzKSB7XHJcbiAgICAgICAgICAgICAgICBpbmRleCA9IGo7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHtcclxuICAgICAgICAgICAgLy8gNCBhZGphY2VudHMgLy8gXHJcbiAgICAgICAgICAgIGlmIChhcnJheUJvYXJkW2luZGV4IC0gdXBdKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgc3BsaXQgPSBjb29yZGluYXRlcy5zcGxpdCgnLCcpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHBsYWNlID0gYXJyYXlCb2FyZFtpbmRleCAtIHVwXS5jb29yZGluYXRlcztcclxuICAgICAgICAgICAgICAgIGxldCBwbGFjZVNwbGl0ID0gcGxhY2Uuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgICAgIGlmIChwbGFjZSAmJiBwbGFjZS5pbmNsdWRlcyhzcGxpdFsxXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGphY2VudHNbMF0ucHVzaChhcnJheUJvYXJkW2luZGV4IC0gdXBdLmNvb3JkaW5hdGVzKTtcclxuICAgICAgICAgICAgICAgICAgICB1cCArPSA4O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChhcnJheUJvYXJkW2luZGV4ICsgcmlnaHRdKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgc3BsaXQgPSBjb29yZGluYXRlcy5zcGxpdCgnLCcpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHBsYWNlID0gYXJyYXlCb2FyZFtpbmRleCArIHJpZ2h0XS5jb29yZGluYXRlcztcclxuICAgICAgICAgICAgICAgIGxldCBwbGFjZVNwbGl0ID0gcGxhY2Uuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgICAgIGlmIChwbGFjZSAmJiBwbGFjZVNwbGl0WzBdID09PSBzcGxpdFswXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFkamFjZW50c1sxXS5wdXNoKGFycmF5Qm9hcmRbaW5kZXggKyByaWdodF0uY29vcmRpbmF0ZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0Kys7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGFycmF5Qm9hcmRbaW5kZXggKyBkb3duXSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHNwbGl0ID0gY29vcmRpbmF0ZXMuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgICAgIGxldCBwbGFjZSA9IGFycmF5Qm9hcmRbaW5kZXggKyBkb3duXS5jb29yZGluYXRlcztcclxuICAgICAgICAgICAgICAgIGxldCBwbGFjZVNwbGl0ID0gcGxhY2Uuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgICAgIGlmIChwbGFjZSAmJiBwbGFjZS5pbmNsdWRlcyhzcGxpdFsxXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGphY2VudHNbMl0ucHVzaChhcnJheUJvYXJkW2luZGV4ICsgZG93bl0uY29vcmRpbmF0ZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRvd24gKz0gODtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoYXJyYXlCb2FyZFtpbmRleCAtIGxlZnRdKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgc3BsaXQgPSBjb29yZGluYXRlcy5zcGxpdCgnLCcpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHBsYWNlID0gYXJyYXlCb2FyZFtpbmRleCAtIGxlZnRdLmNvb3JkaW5hdGVzO1xyXG4gICAgICAgICAgICAgICAgbGV0IHBsYWNlU3BsaXQgPSBwbGFjZS5zcGxpdCgnLCcpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHBsYWNlICYmIHBsYWNlU3BsaXRbMF0gPT09IHNwbGl0WzBdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRqYWNlbnRzWzNdLnB1c2goYXJyYXlCb2FyZFtpbmRleCAtIGxlZnRdLmNvb3JkaW5hdGVzKTtcclxuICAgICAgICAgICAgICAgICAgICBsZWZ0Kys7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGFkamFjZW50cztcclxuICAgIH1cclxuXHJcbiAgICAgIHJlY2VpdmVBdHRhY2sgKGNvb3JkaW5hdGVzKSB7XHJcbiAgICAgICAgbGV0IHN0ciA9IGAke2Nvb3JkaW5hdGVzfWA7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmJvYXJkW3N0cl0uYXR0YWNrZWQgfHwgdGhpcy5ib2FyZFtzdHJdLm1pc3NlZCkgcmV0dXJuO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5ib2FyZFtzdHJdLmhhc1NoaXApIHtcclxuICAgICAgICAgICAgdGhpcy5ib2FyZFtzdHJdLmF0dGFja2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5zaGlwcy5mb3JFYWNoKHNoaXAgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHNoaXAuY29vcmRpbmF0ZXNbMF0uaW5jbHVkZXMoc3RyKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNoaXAucmVnaXN0ZXJIaXQoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2hpcC5pc1N1bmsoKSkgc2hpcC5zdW5rID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYm9hcmRbc3RyXS5taXNzZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZ2V0U2hpcHMgKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNoaXBzO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBhbGxTdW5rICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zaGlwcy5ldmVyeShzaGlwID0+IHNoaXAuc3VuayA9PT0gdHJ1ZSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGJvYXJkQXJyYXkgKCkge1xyXG4gICAgICAgIGNvbnN0IG9iaiA9IHRoaXMuYm9hcmQ7XHJcbiAgICAgICAgY29uc3QgYXJyYXkgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQga2V5IGluIG9iaikge1xyXG4gICAgICAgICAgICBhcnJheS5wdXNoKG9ialtrZXldKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiBhcnJheTtcclxuICAgICAgfVxyXG59XHJcblxyXG5cclxubGV0IGJvYXJkID0gbmV3IEdhbWVib2FyZCgpO1xyXG5ib2FyZC5jcmVhdGVCb2FyZCgpO1xyXG5ib2FyZC5wbGFjZVNoaXAoMywgWyc3LDEnLCc3LDInLCc3LDMnXSk7XHJcbmJvYXJkLnBsYWNlU2hpcCgzLCBbJzAsMScsICcwLDInLCcwLDMnXSlcclxuYm9hcmQucmVjZWl2ZUF0dGFjaygnMCwxJyk7XHJcbmJvYXJkLnJlY2VpdmVBdHRhY2soJzAsMicpO1xyXG5ib2FyZC5yZWNlaXZlQXR0YWNrKCcwLDMnKTtcclxuYm9hcmQucmVjZWl2ZUF0dGFjaygnNywxJyk7XHJcbmJvYXJkLnJlY2VpdmVBdHRhY2soJzcsMicpO1xyXG5ib2FyZC5yZWNlaXZlQXR0YWNrKCc3LDMnKTtcclxubGV0IGFyciA9IGJvYXJkLmJvYXJkQXJyYXkoKTtcclxuXHJcbmxldCBhZGogPSBib2FyZC5nZXRBZGphY2VudHMoYXJyLCA0LCAnNiw3Jyk7XHJcblxyXG5cclxuXHJcbi8vIFBsYXllciBDbGFzcyAvL1xyXG5jbGFzcyBQbGF5ZXIge1xyXG4gICAgY29uc3RydWN0b3IgKGdhbWVib2FyZCkge1xyXG4gICAgICAgIHRoaXMuZ2FtZWJvYXJkID0gZ2FtZWJvYXJkO1xyXG4gICAgfVxyXG5cclxuICAgIGlzTW92ZUxlZ2FsIChtb3ZlKSB7XHJcbiAgICAgICAgcmV0dXJuICF0aGlzLmdhbWVib2FyZC5ib2FyZFttb3ZlXS5hdHRhY2tlZCAmJiAhdGhpcy5nYW1lYm9hcmQuYm9hcmRbbW92ZV0ubWlzc2VkO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBtYWtlUmFuZG9tTW92ZSAoKSB7XHJcbiAgICAgICAgbGV0IG51bTEgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA4KTsgXHJcbiAgICAgICAgbGV0IG51bTIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA4KTsgXHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IGAke251bTF9LCR7bnVtMn1gO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5pc01vdmVMZWdhbChyZXN1bHQpKSByZXR1cm4gcmVzdWx0O1xyXG5cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgd2hpbGUgKCF0aGlzLmlzTW92ZUxlZ2FsKHJlc3VsdCkpIHtcclxuICAgICAgICAgICAgICAgIG51bTEgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA4KTsgXHJcbiAgICAgICAgICAgICAgICBudW0yID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogOCk7IFxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gYCR7bnVtMX0sJHtudW0yfWA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxufVxyXG5cclxuY29uc3QgcGxheSA9IG5ldyBQbGF5ZXIoYm9hcmQpO1xyXG5cclxuXHJcbm1vZHVsZS5leHBvcnRzID0ge1NoaXAsIEdhbWVib2FyZCwgUGxheWVyfTsiLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gRE9NIE1hbmlwdWxhdGlvbiwgUmVuZGVyIHRoZSBHYW1lIC8vIFxyXG5cclxuLy8gUmVuZGVyIFdyaXRlIFlvdXIgTmFtZSAvLyBcclxuaW1wb3J0IHsgZ2FtZSB9IGZyb20gXCIuL2dhbWVcIjtcclxuXHJcbmZ1bmN0aW9uIHdyaXRlTmFtZSAoKSB7XHJcbiAgICBjb25zdCBtYWluID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW4nKTtcclxuICAgIGNvbnN0IGJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpO1xyXG4gICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xyXG4gICAgY29uc3QgcGxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpXHJcblxyXG4gICAgYm94LmNsYXNzTGlzdC5hZGQoJ3BvcC11cC1ib3gnKTtcclxuICAgIHRpdGxlLmNsYXNzTGlzdC5hZGQoJ3RpdGxlLXBvcC11cCcpO1xyXG4gICAgaW5wdXQuY2xhc3NMaXN0LmFkZCgnaW5wdXQtcG9wLXVwJyk7XHJcbiAgICBwbGF5LmNsYXNzTGlzdC5hZGQoJ3BsYXktYnV0dG9uJyk7XHJcblxyXG5cclxuICAgIHRpdGxlLnRleHRDb250ZW50ID0gJ1dyaXRlIHlvdXIgTmFtZSc7XHJcbiAgICBwbGF5LmlubmVySFRNTCA9ICdCYXR0bGUnO1xyXG4gICAgaW5wdXQudHlwZSA9ICd0ZXh0JztcclxuICAgIHBsYXkudHlwZSA9ICdzdWJtaXQnO1xyXG5cclxuICAgIGJveC5hcHBlbmRDaGlsZCh0aXRsZSk7XHJcbiAgICBib3guYXBwZW5kQ2hpbGQoaW5wdXQpO1xyXG4gICAgYm94LmFwcGVuZENoaWxkKHBsYXkpO1xyXG5cclxuICAgIG1haW4uYXBwZW5kQ2hpbGQoYm94KTtcclxuXHJcbiAgICBwbGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgIGNsZWFuKCk7XHJcbiAgICAgICAgZ2FtZShpbnB1dC52YWx1ZSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVuZGVySW5pdGFsQm9hcmRzIChuYW1lKSB7XHJcbiAgICBjb25zdCBtYWluID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW4nKTtcclxuXHJcbiAgICBjb25zdCBteVNlY3Rpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IG15R2FtZVNlY3Rpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IG15Qm9hcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IG15TmFtZUJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgbXlOYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTtcclxuICAgIFxyXG4gICAgY29uc3Qgc2hpcHNDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIFxyXG4gICAgY29uc3QgZW5lbXlTZWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCBlbmVteUdhbWVTZWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCBlbmVteUJvYXJkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCBlbmVteU5hbWVCb3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IGVuZW15TmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XHJcblxyXG4gICAgY29uc3QgY2FycmllciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG4gICAgY29uc3QgYmF0dGxlc2hpcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG4gICAgY29uc3QgY3J1aXNlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG4gICAgY29uc3Qgc3VibWFyaW5lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XHJcbiAgICBjb25zdCBkZXN0cm95ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcclxuXHJcbiAgICBjYXJyaWVyLnNyYyA9ICcuLi9kaXN0L0ltYWdlcy81LnBuZyc7XHJcbiAgICBiYXR0bGVzaGlwLnNyYyA9ICcuLi9kaXN0L0ltYWdlcy81LnBuZyc7XHJcbiAgICBjcnVpc2VyLnNyYyA9ICcuLi9kaXN0L0ltYWdlcy81LnBuZyc7XHJcbiAgICBzdWJtYXJpbmUuc3JjID0gJy4uL2Rpc3QvSW1hZ2VzLzUucG5nJztcclxuICAgIGRlc3Ryb3llci5zcmMgPSAnLi4vZGlzdC9JbWFnZXMvNS5wbmcnO1xyXG5cclxuXHJcbiAgICBjb25zdCBzaGlwcyA9IFtjYXJyaWVyLCBiYXR0bGVzaGlwLCBjcnVpc2VyLCBzdWJtYXJpbmUsIGRlc3Ryb3llcl07XHJcblxyXG5cclxuICAgIHNoaXBzLmZvckVhY2goc2hpcCA9PiB7XHJcbiAgICAgICAgc2hpcC5jbGFzc0xpc3QuYWRkKCdzaGlwJyk7XHJcbiAgICAgICAgc2hpcHNDb250YWluZXIuYXBwZW5kQ2hpbGQoc2hpcCk7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgXHJcbiAgICBcclxuICAgIG15U2VjdGlvbi5jbGFzc0xpc3QuYWRkKCdteS1zZWN0aW9uJyk7XHJcbiAgICBteUdhbWVTZWN0aW9uLmNsYXNzTGlzdC5hZGQoJ215LWdhbWUtc2VjdGlvbicpO1xyXG4gICAgbXlCb2FyZC5jbGFzc0xpc3QuYWRkKCdteS1ib2FyZCcpO1xyXG4gICAgbXlOYW1lQm94LmNsYXNzTGlzdC5hZGQoJ215LW5hbWUtYm94Jyk7XHJcbiAgICBteU5hbWUuY2xhc3NMaXN0LmFkZCgnbXktbmFtZScpO1xyXG4gICAgXHJcbiAgICBzaGlwc0NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdteS1zaGlwcycpO1xyXG4gICAgZW5lbXlTZWN0aW9uLmNsYXNzTGlzdC5hZGQoJ2VuZW15LXNlY3Rpb24nKTtcclxuICAgIGVuZW15R2FtZVNlY3Rpb24uY2xhc3NMaXN0LmFkZCgnZW5lbXktZ2FtZS1zZWN0aW9uJyk7XHJcbiAgICBlbmVteUJvYXJkLmNsYXNzTGlzdC5hZGQoJ2VuZW15LWJvYXJkJyk7XHJcbiAgICBlbmVteU5hbWVCb3guY2xhc3NMaXN0LmFkZCgnZW5lbXktbmFtZS1ib3gnKTtcclxuICAgIGVuZW15TmFtZS5jbGFzc0xpc3QuYWRkKCdlbmVteS1uYW1lJyk7XHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCA4OyBpICs9IDEpIHtcclxuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDg7IGogKz0gMSkge1xyXG4gICAgICAgICAgY29uc3QgY29vcmRpbmF0ZSA9IGAke2l9LCR7an1gO1xyXG4gICAgICAgICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICBjb25zdCBkaXZFbmVteSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgZGl2LmNsYXNzTGlzdC5hZGQoJ215LWRpdi1ib3gnKTtcclxuICAgICAgICAgIGRpdkVuZW15LmNsYXNzTGlzdC5hZGQoJ2VuZW15LWRpdi1ib3gnKTtcclxuXHJcbiAgICAgICAgICBkaXYuaWQgPSBgUCAke2Nvb3JkaW5hdGV9YDtcclxuICAgICAgICAgIGRpdkVuZW15LmlkID0gYEUgJHtjb29yZGluYXRlfWA7XHJcbiAgXHJcbiAgICAgICAgICBteUJvYXJkLmFwcGVuZENoaWxkKGRpdik7XHJcbiAgICAgICAgICBlbmVteUJvYXJkLmFwcGVuZENoaWxkKGRpdkVuZW15KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbXlOYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIGVuZW15TmFtZS50ZXh0Q29udGVudCA9ICdFbmVteSc7XHJcblxyXG4gICAgbXlOYW1lQm94LmFwcGVuZENoaWxkKG15TmFtZSk7XHJcbiAgICBteUdhbWVTZWN0aW9uLmFwcGVuZENoaWxkKG15Qm9hcmQpO1xyXG4gICAgbXlTZWN0aW9uLmFwcGVuZENoaWxkKG15TmFtZUJveCk7XHJcbiAgICBteVNlY3Rpb24uYXBwZW5kQ2hpbGQobXlHYW1lU2VjdGlvbik7XHJcbiAgICBcclxuICAgIGVuZW15TmFtZUJveC5hcHBlbmRDaGlsZChlbmVteU5hbWUpO1xyXG4gICAgZW5lbXlHYW1lU2VjdGlvbi5hcHBlbmRDaGlsZChlbmVteUJvYXJkKTtcclxuICAgIGVuZW15U2VjdGlvbi5hcHBlbmRDaGlsZChlbmVteU5hbWVCb3gpO1xyXG4gICAgZW5lbXlTZWN0aW9uLmFwcGVuZENoaWxkKGVuZW15R2FtZVNlY3Rpb24pO1xyXG5cclxuICAgIG1haW4uYXBwZW5kQ2hpbGQobXlTZWN0aW9uKTtcclxuICAgIG1haW4uYXBwZW5kQ2hpbGQoc2hpcHNDb250YWluZXIpO1xyXG4gICAgbWFpbi5hcHBlbmRDaGlsZChlbmVteVNlY3Rpb24pO1xyXG5cclxuICAgIG1haW4uY2xhc3NMaXN0LmFkZCgnbWFpbi1nYW1lJyk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbmRlck15Qm9hcmQgKGJvYXJkKSB7XHJcbiAgICBjb25zdCBib3hlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5teS1kaXYtYm94Jyk7XHJcblxyXG4gICAgZm9yIChjb25zdCBib3ggb2YgYm94ZXMpIHtcclxuICAgICAgICBsZXQgY29vcmRpbmF0ZXMgPSBib3guaWQ7XHJcbiAgICAgICAgbGV0IHNwbGl0ID0gY29vcmRpbmF0ZXMuc3BsaXQoJyAnKTtcclxuICAgICAgICBsZXQgbnVtID0gc3BsaXRbMV07IFxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChib2FyZC5ib2FyZFtudW1dLmhhc1NoaXApIHtcclxuICAgICAgICAgICAgYm94LnN0eWxlLmJhY2tncm91bmQgPSAnZ3JlZW4nO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYm9hcmQuYm9hcmRbbnVtXS5hdHRhY2tlZCkge1xyXG4gICAgICAgICAgICBib3guaW5uZXJIVE1MID0gJ+KdjCc7XHJcbiAgICAgICAgICAgIGJveC5zdHlsZS5iYWNrZ3JvdW5kID0gJyNGNUMyQzEnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYm9hcmQuYm9hcmRbbnVtXS5taXNzZWQpIHtcclxuICAgICAgICAgICAgYm94LmlubmVySFRNTCA9ICfwn5KmJztcclxuICAgICAgICAgICAgYm94LnN0eWxlLmJhY2tncm91bmQgPSAnbGlnaHRibHVlJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbmRlckVuZW15Qm9hcmQgKGJvYXJkKSB7XHJcbiAgICBjb25zdCBib3hlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lbmVteS1kaXYtYm94Jyk7XHJcblxyXG4gICAgZm9yIChjb25zdCBib3ggb2YgYm94ZXMpIHtcclxuICAgICAgICBsZXQgY29vcmRpbmF0ZXMgPSBib3guaWQ7XHJcbiAgICAgICAgbGV0IHNwbGl0ID0gY29vcmRpbmF0ZXMuc3BsaXQoJyAnKTtcclxuICAgICAgICBsZXQgbnVtID0gc3BsaXRbMV07IFxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChib2FyZC5ib2FyZFtudW1dLmhhc1NoaXApIHtcclxuICAgICAgICAgICAgYm94LnN0eWxlLmJhY2tncm91bmQgPSAnb3JhbmdlJztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGJvYXJkLmJvYXJkW251bV0uYXR0YWNrZWQpIHtcclxuICAgICAgICAgICAgYm94LmlubmVySFRNTCA9ICfinYwnO1xyXG4gICAgICAgICAgICBib3guc3R5bGUuYmFja2dyb3VuZCA9ICcjRjVDMkMxJztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGJvYXJkLmJvYXJkW251bV0ubWlzc2VkKSB7XHJcbiAgICAgICAgICAgIGJveC5pbm5lckhUTUwgPSAn8J+Spic7XHJcbiAgICAgICAgICAgIGJveC5zdHlsZS5iYWNrZ3JvdW5kID0gJ2xpZ2h0Ymx1ZSc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5cclxuXHJcblxyXG5mdW5jdGlvbiBzZWxlY3RTaGlwcyAobXlCb2FyZCkge1xyXG4gICAgbGV0IHNoaXBzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNoaXAnKTtcclxuICAgIGxldCBzaXplcyA9IFs1LDQsMywzLDJdO1xyXG5cclxuICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGxldCBzaXplID0gc2hpcHNbaV0uZGF0YXNldC5zaXplID0gc2l6ZXNbaV07XHJcbiAgICAgICAgc2hpcHNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICBoYW5kbGVTaGlwQ2xhc2VzKHNoaXBzLCBzaGlwc1tpXSk7XHJcbiAgICAgICAgICAgIGFkZEJveGVzTGlzdGVuZXIobXlCb2FyZCwgZS50YXJnZXQuZGF0YXNldC5zaXplKTtcclxuICAgICAgICB9KTtcclxuICAgfTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIGFkZEJveGVzTGlzdGVuZXIgKG15Qm9hcmQsIHNpemUpIHtcclxuICAgIGxldCBib3hlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5teS1kaXYtYm94Jyk7XHJcbiAgICBsZXQgYXJyYXkgPSBteUJvYXJkLmJvYXJkQXJyYXkoKTtcclxuICAgIFxyXG4gICAgaWYgKHNpemUpIHtcclxuICAgICAgICBib3hlcy5mb3JFYWNoKGJveCA9PiB7XHJcbiAgICAgICAgICAgIGJveC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgYm94SWQgPSBib3guaWQ7XHJcbiAgICAgICAgICAgICAgICBsZXQgc3BsaXQgPSBib3hJZC5zcGxpdCgnLCcpO1xyXG4gICAgICAgICAgICAgICAgbGV0IGN1dCA9IHNwbGl0WzBdLnNwbGl0KCcgJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IGNvb3JkaW5hdGVzID0gYCR7Y3V0WzFdfSwke3NwbGl0WzFdfWA7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGxldCBhZGphY2VudHMgPSBteUJvYXJkLmdldEFkamFjZW50cyhhcnJheSwgc2l6ZSwgY29vcmRpbmF0ZXMpOyAvLyBnZXQgNCBhZGphY2VudHMgLy9cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgcHJpbnRBZGphY2VudHMoYWRqYWNlbnRzWzBdLCBzaXplKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgaWYgKGV2ZW50LmtleSA9PT0gXCJBcnJvd1VwXCIgJiYgYWRqYWNlbnRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBwcmludEFkamFjZW50cyhhZGphY2VudHNbMF0sIHNpemUpO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIH0gZWxzZSBpZiAoZXZlbnQua2V5ID09PSBcIkFycm93UmlnaHRcIiAmJiBhZGphY2VudHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHByaW50QWRqYWNlbnRzKGFkamFjZW50c1sxXSwgc2l6ZSk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgfSBlbHNlIGlmIChldmVudC5rZXkgPT09IFwiQXJyb3dEb3duXCIgJiYgYWRqYWNlbnRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBwcmludEFkamFjZW50cyhhZGphY2VudHNbMl0sIHNpemUpO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIH0gZWxzZSBpZiAoZXZlbnQua2V5ID09PSBcIkFycm93TGVmdFwiICYmIGFkamFjZW50cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgcHJpbnRBZGphY2VudHMoYWRqYWNlbnRzWzNdLCBzaXplKTtcclxuICAgICAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG59O1xyXG5cclxuZnVuY3Rpb24gcHJpbnRBZGphY2VudHMgKGFkamFjZW50cywgc2l6ZSkge1xyXG4gICAgaWYgKGFkamFjZW50cy5sZW5ndGggIT09IHNpemUpIHJldHVybiBudWxsO1xyXG5cclxuICAgIGFkamFjZW50cy5mb3JFYWNoKGFkaiA9PiB7XHJcbiAgICAgICAgbGV0IGlkID0gYFAgJHthZGp9YDtcclxuICAgICAgICBsZXQgZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xyXG4gICAgICAgICAgICBkaXYuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZGl2LnN0eWxlLmJhY2tncm91bmQgPSAnYmxhY2snO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgfSlcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVNoaXBDbGFzZXMgKHNoaXBzLCBzZWxlY3RlZCkge1xyXG4gICAgc2hpcHMuZm9yRWFjaChzaGlwID0+IHtcclxuICAgICAgICBpZiAoc2hpcC5jbGFzc0xpc3QuY29udGFpbnMoJ3NoaXAtc2VsZWN0ZWQnKSkge1xyXG4gICAgICAgICAgICBzaGlwLmNsYXNzTGlzdC5yZW1vdmUoJ3NoaXAtc2VsZWN0ZWQnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNoaXAgPT09IHNlbGVjdGVkKSBzaGlwLmNsYXNzTGlzdC5hZGQoJ3NoaXAtc2VsZWN0ZWQnKTtcclxuICAgIH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRyb3BTaGlwcyAoYWRqYWNlbnRzKSB7XHJcbiAgICAvLyA0IGFkamFjZW50cyAvLyBpZiBrZXkgdXAgc2hvdyBhZGphY2VudHNbMF0sIGlmIGtleSBkb3duIHNob3cgYWRqYWNlbnRzWzJdIGFuZCBzbyBvbiAvLyBcclxuXHJcblxyXG4gICAgbGV0IGJveGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm15LWRpdi1ib3gnKTtcclxuICAgIFxyXG4gICAgYm94ZXMuZm9yRWFjaChkaXYgPT4ge1xyXG4gICAgICAgIGRpdi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgYm94SWQgPSBkaXYuaWQ7XHJcbiAgICAgICAgICAgIC8vIDQsNCAvL1xyXG4gICAgICAgICAgICBsZXQgc3BsaXQgPSBib3hJZC5zcGxpdCgnLCcpO1xyXG4gICAgICAgICAgICBsZXQgYWRqYWNlbnRzID0gW2JveElkXTtcclxuICAgICAgICAgICAgbGV0IGogPSBzcGxpdFsxXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2l6ZTsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBqKys7XHJcbiAgICAgICAgICAgICAgICBpZiAoaiA+IDcpIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgYWRqYWNlbnRzLnB1c2goYCR7c3BsaXRbMF19LCAke3NwbGl0W2pdfWApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGFkamFjZW50cy5mb3JFYWNoKGFkaiA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgc2lkZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChhZGopO1xyXG4gICAgICAgICAgICAgICAgc2lkZXMuc3R5bGUuYmFja2dyb3VuZCA9ICdibGFjayc7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC8vIGRpdi5zdHlsZS5iYWNrZ3JvdW5kID0gJ2JsYWNrJztcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBkaXYuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdXQnLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICBkaXYuc3R5bGUuYmFja2dyb3VuZCA9ICdsaWdodGdvbGRlbnJvZHllbGxvdyc7XHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbmRlcldpbiAoKSB7XHJcbiAgICBjb25zdCBtYWluID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW4nKTtcclxuICAgIGNvbnN0IGJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpOyBcclxuICAgIGNvbnN0IHBsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxyXG5cclxuICAgIGJveC5jbGFzc0xpc3QuYWRkKCdwb3AtdXAtYm94Jyk7XHJcbiAgICB0aXRsZS5jbGFzc0xpc3QuYWRkKCd0aXRsZS1wb3AtdXAnKTtcclxuICAgIHBsYXkuY2xhc3NMaXN0LmFkZCgncGxheS1idXR0b24nKTtcclxuXHJcbiAgICB0aXRsZS50ZXh0Q29udGVudCA9ICdZb3UgV2luJztcclxuICAgIHBsYXkuaW5uZXJIVE1MID0gJ1BsYXkgQWdhaW4nO1xyXG4gICAgcGxheS50eXBlID0gJ3N1Ym1pdCc7XHJcblxyXG4gICAgYm94LmFwcGVuZENoaWxkKHRpdGxlKTtcclxuICAgIGJveC5hcHBlbmRDaGlsZChwbGF5KTtcclxuXHJcbiAgICBtYWluLmFwcGVuZENoaWxkKGJveCk7XHJcblxyXG4gICAgcGxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICBjbGVhbigpO1xyXG4gICAgICAgIHdyaXRlTmFtZSgpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbmRlckxvc2UgKCkge1xyXG4gICAgY29uc3QgbWFpbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluJyk7XHJcbiAgICBjb25zdCBib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTsgXHJcbiAgICBjb25zdCBwbGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJylcclxuXHJcbiAgICBib3guY2xhc3NMaXN0LmFkZCgncG9wLXVwLWJveCcpO1xyXG4gICAgdGl0bGUuY2xhc3NMaXN0LmFkZCgndGl0bGUtcG9wLXVwJyk7XHJcbiAgICBwbGF5LmNsYXNzTGlzdC5hZGQoJ3BsYXktYnV0dG9uJyk7XHJcblxyXG4gICAgdGl0bGUudGV4dENvbnRlbnQgPSAnWW91IExvc2UnO1xyXG4gICAgcGxheS5pbm5lckhUTUwgPSAnUGxheSBBZ2Fpbic7XHJcbiAgICBwbGF5LnR5cGUgPSAnc3VibWl0JztcclxuXHJcbiAgICBib3guYXBwZW5kQ2hpbGQodGl0bGUpO1xyXG4gICAgYm94LmFwcGVuZENoaWxkKHBsYXkpO1xyXG5cclxuICAgIG1haW4uYXBwZW5kQ2hpbGQoYm94KTtcclxuXHJcbiAgICBwbGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgIGNsZWFuKCk7XHJcbiAgICAgICAgd3JpdGVOYW1lKCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2xlYW4gKCkge1xyXG4gICAgY29uc3QgbWFpbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluJyk7XHJcbiAgICBtYWluLmlubmVySFRNTCA9ICcnO1xyXG59XHJcblxyXG5cclxuZXhwb3J0IHt3cml0ZU5hbWUsIGNsZWFuLCByZW5kZXJJbml0YWxCb2FyZHMsIHJlbmRlck15Qm9hcmQsIHJlbmRlckVuZW15Qm9hcmQsIHJlbmRlcldpbiwgcmVuZGVyTG9zZSwgc2VsZWN0U2hpcHMsIGFkZEJveGVzTGlzdGVuZXJ9O1xyXG4iLCJpbXBvcnQgeyBTaGlwLCBHYW1lYm9hcmQsIFBsYXllciB9IGZyb20gXCIuL2ZhY3Rvcmllc1wiO1xyXG5pbXBvcnQgeyB3cml0ZU5hbWUsIHJlbmRlckluaXRhbEJvYXJkcywgcmVuZGVyTXlCb2FyZCwgcmVuZGVyRW5lbXlCb2FyZCwgIGNsZWFuLCByZW5kZXJXaW4sIHJlbmRlckxvc2UsIHNlbGVjdFNoaXBzLCBhZGRCb3hlc0xpc3RlbmVyIH0gZnJvbSBcIi4vcmVuZGVyXCI7XHJcblxyXG5cclxuZnVuY3Rpb24gZ2FtZSAobmFtZSkge1xyXG4gICAgbGV0IG15Qm9hcmQgPSBuZXcgR2FtZWJvYXJkKCk7XHJcbiAgICBsZXQgZW5lbXlCb2FyZCA9IG5ldyBHYW1lYm9hcmQoKTtcclxuICAgIFxyXG4gICAgbXlCb2FyZC5jcmVhdGVCb2FyZCgpO1xyXG4gICAgZW5lbXlCb2FyZC5jcmVhdGVCb2FyZCgpO1xyXG5cclxuICAgIHJlbmRlckluaXRhbEJvYXJkcyhuYW1lKTtcclxuICAgIHNlbGVjdFNoaXBzKG15Qm9hcmQpO1xyXG4gICAgXHJcbiAgICBcclxuICAgIFxyXG4gICAgbGV0IHBsYXllciA9IG5ldyBQbGF5ZXIobXlCb2FyZCk7XHJcbiAgICBsZXQgZW5lbXkgPSBuZXcgUGxheWVyKGVuZW15Qm9hcmQpO1xyXG5cclxuICAgIHJlbmRlck15Qm9hcmQocGxheWVyLmdhbWVib2FyZCk7XHJcbiAgICByZW5kZXJFbmVteUJvYXJkKGVuZW15LmdhbWVib2FyZCk7XHJcblxyXG4gICAgY29uc3QgZW5lbXlCb3hlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lbmVteS1kaXYtYm94Jyk7XHJcbiAgICBsZXQgZUJveGVzID0gWy4uLmVuZW15Qm94ZXNdO1xyXG5cclxuICAgIGVCb3hlcy5mb3JFYWNoKGVCb3ggPT4ge1xyXG4gICAgICAgIGVCb3guYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgZUNvb3JkaW5hdGVzID0gZS50YXJnZXQuaWQ7XHJcbiAgICAgICAgICAgIGxldCBlU3BsaXQgPSBlQ29vcmRpbmF0ZXMuc3BsaXQoJyAnKTtcclxuICAgICAgICAgICAgbGV0IGVOdW0gPSBlU3BsaXRbMV07IFxyXG5cclxuICAgICAgICAgICAgbGV0IGVuZW15TW92ZSA9IGVuZW15Lm1ha2VSYW5kb21Nb3ZlKCk7XHJcbiAgICAgICAgICAgIGxldCBlbmVteUF0dGFjayA9IG15Qm9hcmQucmVjZWl2ZUF0dGFjayhlbmVteU1vdmUpO1xyXG4gICAgICAgICAgICBsZXQgYXR0YWNrID0gZW5lbXlCb2FyZC5yZWNlaXZlQXR0YWNrKGVOdW0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGF0dGFjaykge1xyXG4gICAgICAgICAgICAgICAgcmVuZGVyRW5lbXlCb2FyZChlbmVteS5nYW1lYm9hcmQpO1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoIWVuZW15QXR0YWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZW15TW92ZSA9IGVuZW15Lm1ha2VSYW5kb21Nb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZW15QXR0YWNrID0gbXlCb2FyZC5yZWNlaXZlQXR0YWNrKGVuZW15TW92ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJlbmRlck15Qm9hcmQocGxheWVyLmdhbWVib2FyZCk7XHJcbiAgICAgICAgICAgICAgICAgIH0sIDEwMDApOyBcclxuICAgICAgICAgICAgICAgICAgXHJcbiAgICBcclxuICAgICAgICAgICAgICAgIGxldCBteVN1bmsgPSBteUJvYXJkLmFsbFN1bmsoKTtcclxuICAgICAgICAgICAgICAgIGxldCBlbmVteVN1bmsgPSBlbmVteUJvYXJkLmFsbFN1bmsoKTtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKG15U3Vuaykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNsZWFuKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyTG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGlmIChlbmVteVN1bmspIHtcclxuICAgICAgICAgICAgICAgICAgICBjbGVhbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlbmRlcldpbigpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5cclxuXHJcblxyXG5cclxuLy8gMS4gQ3JlYXRlIHRoZSBtYWluIGdhbWUgbG9vcCBhbmQgYSBtb2R1bGUgZm9yIERPTSBpbnRlcmFjdGlvbi5cclxuLy8gICAgICBhLiBBdCB0aGlzIHBvaW50IGl0IGlzIGFwcHJvcHJpYXRlIHRvIGJlZ2luIGNyYWZ0aW5nIHlvdXIgVXNlciBJbnRlcmZhY2UuXHJcbi8vICAgICAgYi4gVGhlIGdhbWUgbG9vcCBzaG91bGQgc2V0IHVwIGEgbmV3IGdhbWUgYnkgY3JlYXRpbmcgUGxheWVycyBhbmQgR2FtZWJvYXJkcy4gRm9yIG5vdyBqdXN0IHBvcHVsYXRlIGVhY2ggR2FtZWJvYXJkIHdpdGggcHJlZGV0ZXJtaW5lZCBjb29yZGluYXRlcy4gWW91IGNhbiBpbXBsZW1lbnQgYSBzeXN0ZW0gZm9yIGFsbG93aW5nIHBsYXllcnMgdG8gcGxhY2UgdGhlaXIgc2hpcHMgbGF0ZXIuXHJcbi8vICAgICAgYy4gV2XigJlsbCBsZWF2ZSB0aGUgSFRNTCBpbXBsZW1lbnRhdGlvbiB1cCB0byB5b3UgZm9yIG5vdywgYnV0IHlvdSBzaG91bGQgZGlzcGxheSBib3RoIHRoZSBwbGF5ZXLigJlzIGJvYXJkcyBhbmQgcmVuZGVyIHRoZW0gdXNpbmcgaW5mb3JtYXRpb24gZnJvbSB0aGUgR2FtZWJvYXJkIGNsYXNzL2ZhY3RvcnkuXHJcbi8vICAgICAgICAgIGEuIFlvdSBuZWVkIG1ldGhvZHMgdG8gcmVuZGVyIHRoZSBnYW1lYm9hcmRzIGFuZCB0byB0YWtlIHVzZXIgaW5wdXQgZm9yIGF0dGFja2luZy4gRm9yIGF0dGFja3MsIGxldCB0aGUgdXNlciBjbGljayBvbiBhIGNvb3JkaW5hdGUgaW4gdGhlIGVuZW15IEdhbWVib2FyZC5cclxuLy8gICAgICBkLiBUaGUgZ2FtZSBsb29wIHNob3VsZCBzdGVwIHRocm91Z2ggdGhlIGdhbWUgdHVybiBieSB0dXJuIHVzaW5nIG9ubHkgbWV0aG9kcyBmcm9tIG90aGVyIG9iamVjdHMuIElmIGF0IGFueSBwb2ludCB5b3UgYXJlIHRlbXB0ZWQgdG8gd3JpdGUgYSBuZXcgZnVuY3Rpb24gaW5zaWRlIHRoZSBnYW1lIGxvb3AsIHN0ZXAgYmFjayBhbmQgZmlndXJlIG91dCB3aGljaCBjbGFzcyBvciBtb2R1bGUgdGhhdCBmdW5jdGlvbiBzaG91bGQgYmVsb25nIHRvLlxyXG4vLyAgICAgIGUuIENyZWF0ZSBjb25kaXRpb25zIHNvIHRoYXQgdGhlIGdhbWUgZW5kcyBvbmNlIG9uZSBwbGF5ZXLigJlzIHNoaXBzIGhhdmUgYWxsIGJlZW4gc3Vuay4gVGhpcyBmdW5jdGlvbiBpcyBhcHByb3ByaWF0ZSBmb3IgdGhlIEdhbWUgbW9kdWxlLlxyXG5cclxuXHJcbi8vIDIuIEZpbmlzaCBpdCB1cFxyXG4vLyAgICAgIGEuIFRoZXJlIGFyZSBzZXZlcmFsIG9wdGlvbnMgYXZhaWxhYmxlIGZvciBsZXR0aW5nIHVzZXJzIHBsYWNlIHRoZWlyIHNoaXBzLiBZb3UgY2FuIGxldCB0aGVtIHR5cGUgY29vcmRpbmF0ZXMgZm9yIGVhY2ggc2hpcCwgb3IgaW52ZXN0aWdhdGUgaW1wbGVtZW50aW5nIGRyYWcgYW5kIGRyb3AuXHJcbi8vICAgICAgYi4gWW91IGNhbiBwb2xpc2ggdGhlIGludGVsbGlnZW5jZSBvZiB0aGUgY29tcHV0ZXIgcGxheWVyIGJ5IGhhdmluZyBpdCB0cnkgYWRqYWNlbnQgc2xvdHMgYWZ0ZXIgZ2V0dGluZyBhIOKAmGhpdOKAmS5cclxuLy8gICAgICBjLiBPcHRpb25hbGx5LCBjcmVhdGUgYSAyIHBsYXllciBvcHRpb24gdGhhdCBsZXRzIHVzZXJzIHRha2UgdHVybnMgYnkgcGFzc2luZyB0aGUgZGV2aWNlIGJhY2sgYW5kIGZvcnRoLiBJZiB5b3XigJlyZSBnb2luZyB0byBnbyB0aGlzIHJvdXRlLCBtYWtlIHN1cmUgdGhlIGdhbWUgaXMgcGxheWFibGUgb24gYSBtb2JpbGUgc2NyZWVuIGFuZCBpbXBsZW1lbnQgYSDigJhwYXNzIGRldmljZeKAmSBzY3JlZW4gc28gdGhhdCBwbGF5ZXJzIGRvbuKAmXQgc2VlIGVhY2ggb3RoZXJzIGJvYXJkcyFcclxuIFxyXG5cclxuLy8gIFRoZSA1IHNoaXBzIGFyZTogQ2FycmllciAob2NjdXBpZXMgNSBzcGFjZXMpLCBCYXR0bGVzaGlwICg0KSwgQ3J1aXNlciAoMyksIFN1Ym1hcmluZSAoMyksIGFuZCBEZXN0cm95ZXIgKDIpLiAvL1xyXG5cclxuXHJcblxyXG5leHBvcnQge2dhbWV9OyIsIi8vIExpbnRlciwgUHJldHRpZXIsIEplc3QuY29uZmlnIC8vIFxyXG5cclxuaW1wb3J0IHsgU2hpcCwgR2FtZWJvYXJkLCBQbGF5ZXIgfSBmcm9tIFwiLi9mYWN0b3JpZXNcIjtcclxuaW1wb3J0IHsgd3JpdGVOYW1lLCBjbGVhbiwgcmVuZGVySW5pdGFsQm9hcmRzLCByZW5kZXJXaW4sIHJlbmRlckxvc2UsIHNlbGVjdFNoaXBzIH0gZnJvbSBcIi4vcmVuZGVyXCI7XHJcbmltcG9ydCB7IGdhbWUgfSBmcm9tIFwiLi9nYW1lXCI7XHJcblxyXG53cml0ZU5hbWUoKTtcclxuIl0sIm5hbWVzIjpbIlNoaXAiLCJjb25zdHJ1Y3RvciIsInNpemUiLCJ0aGlzIiwiaGl0Iiwic3VuayIsImNvb3JkaW5hdGVzIiwicmVnaXN0ZXJIaXQiLCJpc1N1bmsiLCJhZGRDb29yZGluYXRlcyIsInBvc2l0aW9uIiwicHVzaCIsIkdhbWVib2FyZCIsImJvYXJkIiwic2hpcHMiLCJjcmVhdGVCb2FyZCIsImkiLCJqIiwiY29vcmRpbmF0ZSIsImF0dGFja2VkIiwibWlzc2VkIiwiaGFzU2hpcCIsInNoaXAiLCJpc1ZhbGlkIiwiYXJyIiwic3BsaXQiLCJhIiwiTnVtYmVyIiwiYiIsImdldEJvYXJkIiwiYWRkU2hpcCIsInBsYWNlU2hpcCIsImxlbmd0aCIsImlzTW92ZUxlZ2FsIiwibW92ZSIsInBsYWNlRW5lbXlTaGlwcyIsImNyZWF0ZUNvb3JkaW5hdGVzIiwibnVtMSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsIm51bTIiLCJyZXN1bHQiLCJnZXRBZGphY2VudHMiLCJhcnJheUJvYXJkIiwiYWRqYWNlbnRzIiwidXAiLCJyaWdodCIsImRvd24iLCJsZWZ0IiwiaW5kZXgiLCJwbGFjZSIsImluY2x1ZGVzIiwicGxhY2VTcGxpdCIsInJlY2VpdmVBdHRhY2siLCJzdHIiLCJmb3JFYWNoIiwiZ2V0U2hpcHMiLCJhbGxTdW5rIiwiZXZlcnkiLCJib2FyZEFycmF5Iiwib2JqIiwiYXJyYXkiLCJrZXkiLCJQbGF5ZXIiLCJnYW1lYm9hcmQiLCJtYWtlUmFuZG9tTW92ZSIsIm1vZHVsZSIsImV4cG9ydHMiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwid3JpdGVOYW1lIiwibWFpbiIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJib3giLCJjcmVhdGVFbGVtZW50IiwidGl0bGUiLCJpbnB1dCIsInBsYXkiLCJjbGFzc0xpc3QiLCJhZGQiLCJ0ZXh0Q29udGVudCIsImlubmVySFRNTCIsInR5cGUiLCJhcHBlbmRDaGlsZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbGVhbiIsIm5hbWUiLCJteUJvYXJkIiwiZW5lbXlCb2FyZCIsIm15U2VjdGlvbiIsIm15R2FtZVNlY3Rpb24iLCJteU5hbWVCb3giLCJteU5hbWUiLCJzaGlwc0NvbnRhaW5lciIsImVuZW15U2VjdGlvbiIsImVuZW15R2FtZVNlY3Rpb24iLCJlbmVteU5hbWVCb3giLCJlbmVteU5hbWUiLCJjYXJyaWVyIiwiYmF0dGxlc2hpcCIsImNydWlzZXIiLCJzdWJtYXJpbmUiLCJkZXN0cm95ZXIiLCJzcmMiLCJkaXYiLCJkaXZFbmVteSIsImlkIiwicmVuZGVySW5pdGFsQm9hcmRzIiwicXVlcnlTZWxlY3RvckFsbCIsInNpemVzIiwiZGF0YXNldCIsImUiLCJoYW5kbGVTaGlwQ2xhc2VzIiwiYWRkQm94ZXNMaXN0ZW5lciIsInRhcmdldCIsInNlbGVjdFNoaXBzIiwicGxheWVyIiwiZW5lbXkiLCJyZW5kZXJNeUJvYXJkIiwicmVuZGVyRW5lbXlCb2FyZCIsImVCb3giLCJlTnVtIiwiZW5lbXlNb3ZlIiwiZW5lbXlBdHRhY2siLCJzZXRUaW1lb3V0IiwibXlTdW5rIiwiZW5lbXlTdW5rIiwicmVuZGVyTG9zZSIsInJlbmRlcldpbiIsImdhbWUiLCJ2YWx1ZSIsImJveGVzIiwibnVtIiwic3R5bGUiLCJiYWNrZ3JvdW5kIiwiYWRqIiwicHJpbnRBZGphY2VudHMiLCJzZWxlY3RlZCIsImNvbnRhaW5zIiwicmVtb3ZlIl0sInNvdXJjZVJvb3QiOiIifQ==