(()=>{var e={776:e=>{class t{constructor(e){this.size=e,this.hit=0,this.sunk=!1,this.coordinates=[]}registerHit(){return this.hit+=1}isSunk(){return this.hit===this.size}addCoordinates(e){this.coordinates.push(e)}}class a{constructor(){this.board=[],this.ships=[]}createBoard(e=8){for(let t=0;t<e;t+=1)for(let a=0;a<e;a+=1){const e=`${t},${a}`;this.board[e]={coordinates:e,attacked:!1,missed:!1,hasShip:!1,ship:[]}}return this.board}isValid(e){let t=e.split(","),a=Number(t[0]),s=Number(t[1]);return a>=0&&a<=7&&s>=0&&s<=7}getBoard(){return this.board}addShip(e){this.ships.push(e)}placeShip(e,a){if(e!==a.length)return"Size and coordinates length should be equal";const s=new t(e);for(let e=0;e<a.length;e++){if(!this.isValid(a[e]))return`There is a Ship in ${a[e]}`;this.board[a[e]].ship.push(a),this.board[a[e]].hasShip=!0}return s.addCoordinates(a),this.addShip(s),this.board}isMoveLegal(e){return!this.board[e].attacked&&!this.board[e].missed}hasShip(e){return this.board[e].hasShip}placeEnemyShips(){let e=this.createCoordinates(),t=this.createCoordinates(),a=this.createCoordinates(),s=this.createCoordinates(),i=this.createCoordinates(),r=this.boardArray(),d=[this.getAdjacents(r,5,e),this.getAdjacents(r,4,t),this.getAdjacents(r,3,a),this.getAdjacents(r,3,s),this.getAdjacents(r,2,i)],o=[5,4,3,3,2],n=[];for(let e=0;e<d.length;e++){let t=d[e].filter((t=>t.length===o[e]));n.push(t)}n.forEach((e=>{this.placeShip(e[0].length,e[0])}))}createCoordinates(){let e=Math.floor(8*Math.random()),t=Math.floor(8*Math.random()),a=`${e},${t}`;if(this.hasShip(a)){for(;this.hasShip(a);)e=Math.floor(8*Math.random()),t=Math.floor(8*Math.random()),a=`${e},${t}`;return a}return a}getAdjacents(e,t,a){let s=[[],[],[],[]],i=8,r=1,d=8,o=1,n=0;for(let t=0;t<e.length;t++)if(e[t].coordinates===a){n=t;break}for(let l=0;l<t;l++){if(e[n-i]){let t=a.split(","),r=e[n-i].coordinates;r.split(","),r&&r.includes(t[1])&&(s[0].push(e[n-i].coordinates),i+=8)}if(e[n+r]){let t=a.split(","),i=e[n+r].coordinates,d=i.split(",");i&&d[0]===t[0]&&(s[1].push(e[n+r].coordinates),r++)}if(e[n+d]){let t=a.split(","),i=e[n+d].coordinates;i.split(","),i&&i.includes(t[1])&&(s[2].push(e[n+d].coordinates),d+=8)}if(e[n-o]){let t=a.split(","),i=e[n-o].coordinates,r=i.split(",");i&&r[0]===t[0]&&(s[3].push(e[n-o].coordinates),o++)}}return s}receiveAttack(e){let t=`${e}`;if(!this.board[t].attacked&&!this.board[t].missed)return this.board[t].hasShip?(this.board[t].attacked=!0,this.ships.forEach((e=>{e.coordinates[0].includes(t)&&(e.registerHit(),e.isSunk()&&(e.sunk=!0))}))):this.board[t].missed=!0,!0}getShips(){return this.ships}allSunk(){return this.ships.every((e=>!0===e.sunk))}boardArray(){const e=this.board,t=[];for(let a in e)t.push(e[a]);return t}}let s=new a;s.createBoard();let i=s.placeEnemyShips();console.log(i),e.exports={Ship:t,Gameboard:a,Player:class{constructor(e){this.gameboard=e}isMoveLegal(e){return!this.gameboard.board[e].attacked&&!this.gameboard.board[e].missed}makeRandomMove(){let e=Math.floor(8*Math.random()),t=Math.floor(8*Math.random()),a=`${e},${t}`;if(this.isMoveLegal(a))return a;for(;!this.isMoveLegal(a);)e=Math.floor(8*Math.random()),t=Math.floor(8*Math.random()),a=`${e},${t}`;return a}}}}},t={};function a(s){var i=t[s];if(void 0!==i)return i.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,a),r.exports}(()=>{"use strict";var e=a(776);function t(e){const t=document.querySelectorAll(".my-div-box");for(const a of t){let t=a.id.split(" ")[1];e.board[t].hasShip&&(a.style.background="green"),e.board[t].attacked&&(a.innerHTML="❌",a.style.background="#F5C2C1"),e.board[t].missed&&(a.innerHTML="💦",a.style.background="lightblue")}}function s(e){const t=document.querySelectorAll(".enemy-div-box");for(const a of t){let t=a.id.split(" ")[1];e.board[t].hasShip&&(a.style.background="orange"),e.board[t].attacked&&(a.innerHTML="❌",a.style.background="#F5C2C1"),e.board[t].missed&&(a.innerHTML="💦",a.style.background="lightblue"),e.board[t].hasShip&&(a.innerHTML="🚢",a.style.background="lightblue")}}function i(e,t){let a=document.querySelectorAll(".my-div-box"),s=e.boardArray();t?a.forEach((a=>{a.addEventListener("mouseover",(()=>{let i=a.id.split(","),r=`${i[0].split(" ")[1]},${i[1]}`;e.getAdjacents(s,t-1,r).forEach((e=>{for(let t=0;t<e.length;t++){let a=`P ${e[t]}`;document.getElementById(a).classList.add("over")}}))})),a.addEventListener("mouseout",(()=>{let i=a.id.split(","),r=`${i[0].split(" ")[1]},${i[1]}`;e.getAdjacents(s,t-1,r).forEach((e=>{e.forEach((e=>{let t=`P ${e}`;document.getElementById(t).classList.remove("over")}))}))}))})):alert("No size")}function r(e,t){e.forEach((e=>{e.classList.contains("ship-selected")&&e.classList.remove("ship-selected"),e===t&&e.classList.add("ship-selected")}))}!function(a){let d=new e.Gameboard,o=new e.Gameboard;d.createBoard(),o.createBoard(),function(e){const t=document.getElementById("main"),a=document.createElement("div"),s=document.createElement("div"),i=document.createElement("div"),r=document.createElement("div"),d=document.createElement("h3"),o=document.createElement("div"),n=document.createElement("div"),l=document.createElement("div"),c=document.createElement("div"),h=document.createElement("div"),m=document.createElement("h3"),u=document.createElement("img"),p=document.createElement("img"),g=document.createElement("img"),b=document.createElement("img"),f=document.createElement("img");u.src="../dist/Images/5.png",p.src="../dist/Images/5.png",g.src="../dist/Images/5.png",b.src="../dist/Images/5.png",f.src="../dist/Images/5.png",[u,p,g,b,f].forEach((e=>{e.classList.add("ship"),o.appendChild(e)})),a.classList.add("my-section"),s.classList.add("my-game-section"),i.classList.add("my-board"),r.classList.add("my-name-box"),d.classList.add("my-name"),o.classList.add("my-ships"),n.classList.add("enemy-section"),l.classList.add("enemy-game-section"),c.classList.add("enemy-board"),h.classList.add("enemy-name-box"),m.classList.add("enemy-name");for(let e=0;e<8;e+=1)for(let t=0;t<8;t+=1){const a=`${e},${t}`,s=document.createElement("div"),r=document.createElement("div");s.classList.add("my-div-box"),r.classList.add("enemy-div-box"),s.id=`P ${a}`,r.id=`E ${a}`,i.appendChild(s),c.appendChild(r)}d.textContent=undefined,m.textContent="Enemy",r.appendChild(d),s.appendChild(i),a.appendChild(r),a.appendChild(s),h.appendChild(m),l.appendChild(c),n.appendChild(h),n.appendChild(l),t.appendChild(a),t.appendChild(o),t.appendChild(n),t.classList.add("main-game")}(),function(e){let t=document.querySelectorAll(".ship"),a=[5,4,3,3,2];document.querySelectorAll(".my-div-box");for(let s=0;s<t.length;s++){let d=t[s].dataset.size=a[s];t[s].addEventListener("click",(()=>{i(e,d),r(t,t[s])})),0===s&&t[s].click()}}(d);let n=new e.Player(d),l=new e.Player(o);o.receiveAttack("0,4"),o.placeEnemyShips(),t(n.gameboard),s(l.gameboard),[...document.querySelectorAll(".enemy-div-box")].forEach((e=>{e.addEventListener("click",(e=>{let a=e.target.id.split(" ")[1],i=l.makeRandomMove(),r=d.receiveAttack(i);o.receiveAttack(a)&&(s(l.gameboard),setTimeout((function(){for(;!r;)i=l.makeRandomMove(),r=d.receiveAttack(i);t(n.gameboard)}),1e3),d.allSunk(),o.allSunk())}))}))}()})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBTTdCLEdBRXpDRixFQUFNRSxHQUFHc0YsaUJBQWlCLFNBQVMsS0FDL0JGLEVBQWlCQyxFQUFTbkcsR0FDMUI0RyxFQUFpQmhHLEVBQU9BLEVBQU1FLEdBQUcsSUFFMUIsSUFBTkEsR0FBU0YsRUFBTUUsR0FBR3lILE9BQzNCLENBQ0gsQ0MvS0lDLENBQVlyQyxHQUlaLElBQUlzQyxFQUFTLElBQUksRUFBQTNELE9BQU9xQixHQUNwQnVDLEVBQVEsSUFBSSxFQUFBNUQsT0FBT0wsR0FDdkJBLEVBQVdQLGNBQWMsT0FDekJPLEVBQVd4QyxrQkFHWHNELEVBQWNrRCxFQUFPMUQsV0FDckJrQixFQUFpQnlDLEVBQU0zRCxXQUdWLElBRE1VLFNBQVNDLGlCQUFpQixtQkFHdEMxQyxTQUFRMkYsSUFDWEEsRUFBS3ZDLGlCQUFpQixTQUFVd0MsSUFDNUIsSUFFSUMsRUFGZUQsRUFBRUUsT0FBT2pELEdBQ0Z0RSxNQUFNLEtBQ2QsR0FFZHdILEVBQVlMLEVBQU0xRCxpQkFDbEJnRSxFQUFjN0MsRUFBUWpDLGNBQWM2RSxHQUMzQnRFLEVBQVdQLGNBQWMyRSxLQUdsQzVDLEVBQWlCeUMsRUFBTTNELFdBQ3ZCa0UsWUFBVyxXQUNQLE1BQVFELEdBQ0pELEVBQVlMLEVBQU0xRCxpQkFDbEJnRSxFQUFjN0MsRUFBUWpDLGNBQWM2RSxHQUV4Q3hELEVBQWNrRCxFQUFPMUQsVUFDdkIsR0FBRyxLQUdRb0IsRUFBUTlCLFVBQ0xJLEVBQVdKLFVBVS9CLEdBRUYsR0FFVixDQzFEQSxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9mYWN0b3JpZXMuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3JlbmRlci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2dhbWUuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTaGlwIENsYXNzIC8vXHJcbmNsYXNzIFNoaXAge1xyXG4gICAgY29uc3RydWN0b3IgKHNpemUpIHtcclxuICAgICAgICB0aGlzLnNpemUgPSBzaXplO1xyXG4gICAgICAgIHRoaXMuaGl0ID0gMDtcclxuICAgICAgICB0aGlzLnN1bmsgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNvb3JkaW5hdGVzID0gW107XHJcbiAgICB9XHJcblxyXG4gICAgcmVnaXN0ZXJIaXQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaGl0ICs9IDE7XHJcbiAgICB9XHJcblxyXG4gICAgaXNTdW5rKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmhpdCA9PT0gdGhpcy5zaXplO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZENvb3JkaW5hdGVzIChwb3NpdGlvbikge1xyXG4gICAgICAgIHRoaXMuY29vcmRpbmF0ZXMucHVzaChwb3NpdGlvbik7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIEdhbWVib2FyZCBDbGFzcyAvL1xyXG5jbGFzcyBHYW1lYm9hcmQge1xyXG4gICAgY29uc3RydWN0b3IgKCkge1xyXG4gICAgICAgIHRoaXMuYm9hcmQgPSBbXSBcclxuICAgICAgICB0aGlzLnNoaXBzID0gW11cclxuICAgIH1cclxuICAgIFxyXG4gICAgY3JlYXRlQm9hcmQoc2l6ZSA9IDggKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpICs9IDEpIHtcclxuICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgc2l6ZTsgaiArPSAxKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvb3JkaW5hdGUgPSBgJHtpfSwke2p9YDtcclxuICAgICAgICAgICAgdGhpcy5ib2FyZFtjb29yZGluYXRlXSA9IHsgY29vcmRpbmF0ZXM6IGNvb3JkaW5hdGUsIGF0dGFja2VkOiBmYWxzZSwgbWlzc2VkOiBmYWxzZSwgaGFzU2hpcDogZmFsc2UsIHNoaXA6IFtdIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5ib2FyZDtcclxuICAgICAgfVxyXG5cclxuICAgICAgaXNWYWxpZCAoY29vcmRpbmF0ZXMpIHtcclxuICAgICAgICBsZXQgYXJyID0gY29vcmRpbmF0ZXMuc3BsaXQoJywnKTtcclxuICAgICAgICBsZXQgYSA9IE51bWJlcihhcnJbMF0pO1xyXG4gICAgICAgIGxldCBiID0gTnVtYmVyKGFyclsxXSk7XHJcblxyXG5cclxuICAgICAgICByZXR1cm4gYSA+PSAwICYmIGEgPD0gNyAmJiBiID49IDAgJiYgYiA8PSA3O1xyXG4gICAgICB9XHJcblxyXG4gICAgICBnZXRCb2FyZCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5ib2FyZDtcclxuICAgICAgfVxyXG5cclxuICAgICAgYWRkU2hpcCAoc2hpcCkge1xyXG4gICAgICAgIHRoaXMuc2hpcHMucHVzaChzaGlwKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcGxhY2VTaGlwIChzaXplLCBjb29yZGluYXRlcykge1xyXG4gICAgICAgIGlmIChzaXplICE9PSBjb29yZGluYXRlcy5sZW5ndGgpIHJldHVybiAnU2l6ZSBhbmQgY29vcmRpbmF0ZXMgbGVuZ3RoIHNob3VsZCBiZSBlcXVhbCc7XHJcblxyXG4gICAgICAgIGNvbnN0IHNoaXAgPSBuZXcgU2hpcChzaXplKTtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb29yZGluYXRlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNWYWxpZChjb29yZGluYXRlc1tpXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJvYXJkW2Nvb3JkaW5hdGVzW2ldXS5zaGlwLnB1c2goY29vcmRpbmF0ZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYm9hcmRbY29vcmRpbmF0ZXNbaV1dLmhhc1NoaXAgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSByZXR1cm4gYFRoZXJlIGlzIGEgU2hpcCBpbiAke2Nvb3JkaW5hdGVzW2ldfWA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2hpcC5hZGRDb29yZGluYXRlcyhjb29yZGluYXRlcyk7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkU2hpcChzaGlwKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYm9hcmQ7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlzTW92ZUxlZ2FsIChtb3ZlKSB7XHJcbiAgICAgICAgcmV0dXJuICF0aGlzLmJvYXJkW21vdmVdLmF0dGFja2VkICYmICF0aGlzLmJvYXJkW21vdmVdLm1pc3NlZDtcclxuICAgIH1cclxuICAgICAgICBcclxuICAgIGhhc1NoaXAgKGNvb3JkaW5hdGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYm9hcmRbY29vcmRpbmF0ZV0uaGFzU2hpcDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICBwbGFjZUVuZW15U2hpcHMgKCkge1xyXG4gICAgICAgICAgICBsZXQgY29vcmRpbmF0ZUNhcnJpZXIgPSB0aGlzLmNyZWF0ZUNvb3JkaW5hdGVzKCk7XHJcbiAgICAgICAgICAgIGxldCBjb29yZGluYXRlQmF0dGxlc2hpcCA9IHRoaXMuY3JlYXRlQ29vcmRpbmF0ZXMoKTtcclxuICAgICAgICAgICAgbGV0IGNvb3JkaW5hdGVDcnVpc2VyID0gdGhpcy5jcmVhdGVDb29yZGluYXRlcygpO1xyXG4gICAgICAgICAgICBsZXQgY29vcmRpbmF0ZVN1Ym1hcmluZSA9IHRoaXMuY3JlYXRlQ29vcmRpbmF0ZXMoKTtcclxuICAgICAgICAgICAgbGV0IGNvb3JkaW5hdGVEZXN0cm95ZXIgPSB0aGlzLmNyZWF0ZUNvb3JkaW5hdGVzKCk7XHJcblxyXG4gICAgICAgICAgICBsZXQgYXJyYXkgPSB0aGlzLmJvYXJkQXJyYXkoKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBjYXJyaWVyID0gdGhpcy5nZXRBZGphY2VudHMoYXJyYXksIDUsIGNvb3JkaW5hdGVDYXJyaWVyKTtcclxuICAgICAgICAgICAgbGV0IGJhdHRsZXNoaXAgPSB0aGlzLmdldEFkamFjZW50cyhhcnJheSwgNCwgY29vcmRpbmF0ZUJhdHRsZXNoaXApO1xyXG4gICAgICAgICAgICBsZXQgY3J1aXNlciA9IHRoaXMuZ2V0QWRqYWNlbnRzKGFycmF5LCAzLCBjb29yZGluYXRlQ3J1aXNlcik7XHJcbiAgICAgICAgICAgIGxldCBzdWJtYXJpbmUgPSB0aGlzLmdldEFkamFjZW50cyhhcnJheSwgMywgY29vcmRpbmF0ZVN1Ym1hcmluZSk7XHJcbiAgICAgICAgICAgIGxldCBkZXN0cm95ZXIgPSB0aGlzLmdldEFkamFjZW50cyhhcnJheSwgMiwgY29vcmRpbmF0ZURlc3Ryb3llcik7XHJcblxyXG4gICAgICAgICAgICBsZXQgc2hpcHMgPSBbY2FycmllciwgYmF0dGxlc2hpcCwgY3J1aXNlciwgc3VibWFyaW5lLCBkZXN0cm95ZXJdO1xyXG4gICAgICAgICAgICBsZXQgc2l6ZXMgPSBbNSw0LDMsMywyXTtcclxuICAgICAgICAgICAgbGV0IGZpbHRlcmVkID0gW107XHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXBzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdGVtcCA9IHNoaXBzW2ldLmZpbHRlcihwb3MgPT4gcG9zLmxlbmd0aCA9PT0gc2l6ZXNbaV0pO1xyXG4gICAgICAgICAgICAgICAgZmlsdGVyZWQucHVzaCh0ZW1wKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcblxyXG4gICAgICAgICAgICBmaWx0ZXJlZC5mb3JFYWNoKHNldE9mQ29vcmRpbmF0ZXMgPT4geyBcclxuICAgICAgICAgICAgICAgIHRoaXMucGxhY2VTaGlwKHNldE9mQ29vcmRpbmF0ZXNbMF0ubGVuZ3RoLCBzZXRPZkNvb3JkaW5hdGVzWzBdKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gc2V0T2ZDb29yZGluYXRlcy5mb3JFYWNoKGNvb3JkaW5hdGVzID0+IHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAvLyBsZXQgYWZmaXJtYXRpdmUgPSBjb29yZGluYXRlcy5ldmVyeShwb3NpdGlvbiA9PiAhdGhpcy5oYXNTaGlwKHBvc2l0aW9uKSk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy5wbGFjZVNoaXAoY29vcmRpbmF0ZXMubGVuZ3RoLCBjb29yZGluYXRlcyk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgLy8gY29vcmRpbmF0ZXMuZm9yRWFjaChwb3NpdGlvbiA9PiB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgLy8gfSlcclxuICAgICAgICAgICAgICAgIC8vIH0pO1xyXG4gICAgICAgICAgICB9KTsgIFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY3JlYXRlQ29vcmRpbmF0ZXMgKCkge1xyXG4gICAgICAgIGxldCBudW0xID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogOCk7IFxyXG4gICAgICAgIGxldCBudW0yID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogOCk7IFxyXG4gICAgICAgIGxldCByZXN1bHQgPSBgJHtudW0xfSwke251bTJ9YDtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmhhc1NoaXAocmVzdWx0KSkgcmV0dXJuIHJlc3VsdDtcclxuXHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHdoaWxlICh0aGlzLmhhc1NoaXAocmVzdWx0KSkge1xyXG4gICAgICAgICAgICAgICAgbnVtMSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDgpOyBcclxuICAgICAgICAgICAgICAgIG51bTIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA4KTsgXHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBgJHtudW0xfSwke251bTJ9YDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgICAgZ2V0QWRqYWNlbnRzIChhcnJheUJvYXJkLCBzaXplLCBjb29yZGluYXRlcykge1xyXG4gICAgICAgIGxldCBhZGphY2VudHMgPSBbW10sW10sW10sW11dO1xyXG4gICAgICAgIGxldCB1cCA9IDg7XHJcbiAgICAgICAgbGV0IHJpZ2h0ID0gMTtcclxuICAgICAgICBsZXQgZG93biA9IDg7XHJcbiAgICAgICAgbGV0IGxlZnQgPSAxO1xyXG4gICAgICAgIGxldCBpbmRleCA9IDA7XHJcblxyXG4gICAgICAgIC8vIGdldCBpbmRleCAvL1xyXG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgYXJyYXlCb2FyZC5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICBpZiAoYXJyYXlCb2FyZFtqXS5jb29yZGluYXRlcyA9PT0gY29vcmRpbmF0ZXMpIHtcclxuICAgICAgICAgICAgICAgIGluZGV4ID0gajtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpemU7IGkrKykge1xyXG4gICAgICAgICAgICAvLyA0IGFkamFjZW50cyAvLyBcclxuICAgICAgICAgICAgaWYgKGFycmF5Qm9hcmRbaW5kZXggLSB1cF0pIHtcclxuICAgICAgICAgICAgICAgIGxldCBzcGxpdCA9IGNvb3JkaW5hdGVzLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgICAgICAgICBsZXQgcGxhY2UgPSBhcnJheUJvYXJkW2luZGV4IC0gdXBdLmNvb3JkaW5hdGVzO1xyXG4gICAgICAgICAgICAgICAgbGV0IHBsYWNlU3BsaXQgPSBwbGFjZS5zcGxpdCgnLCcpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHBsYWNlICYmIHBsYWNlLmluY2x1ZGVzKHNwbGl0WzFdKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFkamFjZW50c1swXS5wdXNoKGFycmF5Qm9hcmRbaW5kZXggLSB1cF0uY29vcmRpbmF0ZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHVwICs9IDg7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGFycmF5Qm9hcmRbaW5kZXggKyByaWdodF0pIHtcclxuICAgICAgICAgICAgICAgIGxldCBzcGxpdCA9IGNvb3JkaW5hdGVzLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgICAgICAgICBsZXQgcGxhY2UgPSBhcnJheUJvYXJkW2luZGV4ICsgcmlnaHRdLmNvb3JkaW5hdGVzO1xyXG4gICAgICAgICAgICAgICAgbGV0IHBsYWNlU3BsaXQgPSBwbGFjZS5zcGxpdCgnLCcpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHBsYWNlICYmIHBsYWNlU3BsaXRbMF0gPT09IHNwbGl0WzBdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRqYWNlbnRzWzFdLnB1c2goYXJyYXlCb2FyZFtpbmRleCArIHJpZ2h0XS5jb29yZGluYXRlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmlnaHQrKztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoYXJyYXlCb2FyZFtpbmRleCArIGRvd25dKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgc3BsaXQgPSBjb29yZGluYXRlcy5zcGxpdCgnLCcpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHBsYWNlID0gYXJyYXlCb2FyZFtpbmRleCArIGRvd25dLmNvb3JkaW5hdGVzO1xyXG4gICAgICAgICAgICAgICAgbGV0IHBsYWNlU3BsaXQgPSBwbGFjZS5zcGxpdCgnLCcpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHBsYWNlICYmIHBsYWNlLmluY2x1ZGVzKHNwbGl0WzFdKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFkamFjZW50c1syXS5wdXNoKGFycmF5Qm9hcmRbaW5kZXggKyBkb3duXS5jb29yZGluYXRlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgZG93biArPSA4O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChhcnJheUJvYXJkW2luZGV4IC0gbGVmdF0pIHtcclxuICAgICAgICAgICAgICAgIGxldCBzcGxpdCA9IGNvb3JkaW5hdGVzLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgICAgICAgICBsZXQgcGxhY2UgPSBhcnJheUJvYXJkW2luZGV4IC0gbGVmdF0uY29vcmRpbmF0ZXM7XHJcbiAgICAgICAgICAgICAgICBsZXQgcGxhY2VTcGxpdCA9IHBsYWNlLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgICAgICAgICBpZiAocGxhY2UgJiYgcGxhY2VTcGxpdFswXSA9PT0gc3BsaXRbMF0pIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGphY2VudHNbM10ucHVzaChhcnJheUJvYXJkW2luZGV4IC0gbGVmdF0uY29vcmRpbmF0ZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxlZnQrKztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYWRqYWNlbnRzO1xyXG4gICAgfVxyXG5cclxuICAgICAgcmVjZWl2ZUF0dGFjayAoY29vcmRpbmF0ZXMpIHtcclxuICAgICAgICBsZXQgc3RyID0gYCR7Y29vcmRpbmF0ZXN9YDtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuYm9hcmRbc3RyXS5hdHRhY2tlZCB8fCB0aGlzLmJvYXJkW3N0cl0ubWlzc2VkKSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmJvYXJkW3N0cl0uaGFzU2hpcCkge1xyXG4gICAgICAgICAgICB0aGlzLmJvYXJkW3N0cl0uYXR0YWNrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLnNoaXBzLmZvckVhY2goc2hpcCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2hpcC5jb29yZGluYXRlc1swXS5pbmNsdWRlcyhzdHIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hpcC5yZWdpc3RlckhpdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzaGlwLmlzU3VuaygpKSBzaGlwLnN1bmsgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ib2FyZFtzdHJdLm1pc3NlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBnZXRTaGlwcyAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2hpcHM7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGFsbFN1bmsgKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNoaXBzLmV2ZXJ5KHNoaXAgPT4gc2hpcC5zdW5rID09PSB0cnVlKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgYm9hcmRBcnJheSAoKSB7XHJcbiAgICAgICAgY29uc3Qgb2JqID0gdGhpcy5ib2FyZDtcclxuICAgICAgICBjb25zdCBhcnJheSA9IFtdO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgICAgIGFycmF5LnB1c2gob2JqW2tleV0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIGFycmF5O1xyXG4gICAgICB9XHJcbn1cclxuXHJcblxyXG5sZXQgZW5lbXlCb2FyZCA9IG5ldyBHYW1lYm9hcmQoKTtcclxuZW5lbXlCb2FyZC5jcmVhdGVCb2FyZCgpO1xyXG5cclxuXHJcbmxldCByZXN1bHQgPSBlbmVteUJvYXJkLnBsYWNlRW5lbXlTaGlwcygpO1xyXG5jb25zb2xlLmxvZyhyZXN1bHQpO1xyXG5cclxuXHJcblxyXG5cclxuLy8gUGxheWVyIENsYXNzIC8vXHJcbmNsYXNzIFBsYXllciB7XHJcbiAgICBjb25zdHJ1Y3RvciAoZ2FtZWJvYXJkKSB7XHJcbiAgICAgICAgdGhpcy5nYW1lYm9hcmQgPSBnYW1lYm9hcmQ7XHJcbiAgICB9XHJcblxyXG4gICAgaXNNb3ZlTGVnYWwgKG1vdmUpIHtcclxuICAgICAgICByZXR1cm4gIXRoaXMuZ2FtZWJvYXJkLmJvYXJkW21vdmVdLmF0dGFja2VkICYmICF0aGlzLmdhbWVib2FyZC5ib2FyZFttb3ZlXS5taXNzZWQ7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIG1ha2VSYW5kb21Nb3ZlICgpIHtcclxuICAgICAgICBsZXQgbnVtMSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDgpOyBcclxuICAgICAgICBsZXQgbnVtMiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDgpOyBcclxuICAgICAgICBsZXQgcmVzdWx0ID0gYCR7bnVtMX0sJHtudW0yfWA7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmlzTW92ZUxlZ2FsKHJlc3VsdCkpIHJldHVybiByZXN1bHQ7XHJcblxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB3aGlsZSAoIXRoaXMuaXNNb3ZlTGVnYWwocmVzdWx0KSkge1xyXG4gICAgICAgICAgICAgICAgbnVtMSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDgpOyBcclxuICAgICAgICAgICAgICAgIG51bTIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA4KTsgXHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBgJHtudW0xfSwke251bTJ9YDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG59XHJcblxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB7U2hpcCwgR2FtZWJvYXJkLCBQbGF5ZXJ9OyIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBET00gTWFuaXB1bGF0aW9uLCBSZW5kZXIgdGhlIEdhbWUgLy8gXHJcblxyXG4vLyBSZW5kZXIgV3JpdGUgWW91ciBOYW1lIC8vIFxyXG5pbXBvcnQgeyBnYW1lIH0gZnJvbSBcIi4vZ2FtZVwiO1xyXG5cclxuZnVuY3Rpb24gd3JpdGVOYW1lICgpIHtcclxuICAgIGNvbnN0IG1haW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbicpO1xyXG4gICAgY29uc3QgYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XHJcbiAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XHJcbiAgICBjb25zdCBwbGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJylcclxuXHJcbiAgICBib3guY2xhc3NMaXN0LmFkZCgncG9wLXVwLWJveCcpO1xyXG4gICAgdGl0bGUuY2xhc3NMaXN0LmFkZCgndGl0bGUtcG9wLXVwJyk7XHJcbiAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKCdpbnB1dC1wb3AtdXAnKTtcclxuICAgIHBsYXkuY2xhc3NMaXN0LmFkZCgncGxheS1idXR0b24nKTtcclxuXHJcblxyXG4gICAgdGl0bGUudGV4dENvbnRlbnQgPSAnV3JpdGUgeW91ciBOYW1lJztcclxuICAgIHBsYXkuaW5uZXJIVE1MID0gJ0JhdHRsZSc7XHJcbiAgICBpbnB1dC50eXBlID0gJ3RleHQnO1xyXG4gICAgcGxheS50eXBlID0gJ3N1Ym1pdCc7XHJcblxyXG4gICAgYm94LmFwcGVuZENoaWxkKHRpdGxlKTtcclxuICAgIGJveC5hcHBlbmRDaGlsZChpbnB1dCk7XHJcbiAgICBib3guYXBwZW5kQ2hpbGQocGxheSk7XHJcblxyXG4gICAgbWFpbi5hcHBlbmRDaGlsZChib3gpO1xyXG5cclxuICAgIHBsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgY2xlYW4oKTtcclxuICAgICAgICBnYW1lKGlucHV0LnZhbHVlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW5kZXJJbml0YWxCb2FyZHMgKG5hbWUpIHtcclxuICAgIGNvbnN0IG1haW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbicpO1xyXG5cclxuICAgIGNvbnN0IG15U2VjdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgbXlHYW1lU2VjdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgbXlCb2FyZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgbXlOYW1lQm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCBteU5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpO1xyXG4gICAgXHJcbiAgICBjb25zdCBzaGlwc0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgXHJcbiAgICBjb25zdCBlbmVteVNlY3Rpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IGVuZW15R2FtZVNlY3Rpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IGVuZW15Qm9hcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IGVuZW15TmFtZUJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgZW5lbXlOYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTtcclxuXHJcbiAgICBjb25zdCBjYXJyaWVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XHJcbiAgICBjb25zdCBiYXR0bGVzaGlwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XHJcbiAgICBjb25zdCBjcnVpc2VyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XHJcbiAgICBjb25zdCBzdWJtYXJpbmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcclxuICAgIGNvbnN0IGRlc3Ryb3llciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG5cclxuICAgIGNhcnJpZXIuc3JjID0gJy4uL2Rpc3QvSW1hZ2VzLzUucG5nJztcclxuICAgIGJhdHRsZXNoaXAuc3JjID0gJy4uL2Rpc3QvSW1hZ2VzLzUucG5nJztcclxuICAgIGNydWlzZXIuc3JjID0gJy4uL2Rpc3QvSW1hZ2VzLzUucG5nJztcclxuICAgIHN1Ym1hcmluZS5zcmMgPSAnLi4vZGlzdC9JbWFnZXMvNS5wbmcnO1xyXG4gICAgZGVzdHJveWVyLnNyYyA9ICcuLi9kaXN0L0ltYWdlcy81LnBuZyc7XHJcblxyXG5cclxuICAgIGNvbnN0IHNoaXBzID0gW2NhcnJpZXIsIGJhdHRsZXNoaXAsIGNydWlzZXIsIHN1Ym1hcmluZSwgZGVzdHJveWVyXTtcclxuXHJcblxyXG4gICAgc2hpcHMuZm9yRWFjaChzaGlwID0+IHtcclxuICAgICAgICBzaGlwLmNsYXNzTGlzdC5hZGQoJ3NoaXAnKTtcclxuICAgICAgICBzaGlwc0NvbnRhaW5lci5hcHBlbmRDaGlsZChzaGlwKTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBcclxuICAgIFxyXG4gICAgbXlTZWN0aW9uLmNsYXNzTGlzdC5hZGQoJ215LXNlY3Rpb24nKTtcclxuICAgIG15R2FtZVNlY3Rpb24uY2xhc3NMaXN0LmFkZCgnbXktZ2FtZS1zZWN0aW9uJyk7XHJcbiAgICBteUJvYXJkLmNsYXNzTGlzdC5hZGQoJ215LWJvYXJkJyk7XHJcbiAgICBteU5hbWVCb3guY2xhc3NMaXN0LmFkZCgnbXktbmFtZS1ib3gnKTtcclxuICAgIG15TmFtZS5jbGFzc0xpc3QuYWRkKCdteS1uYW1lJyk7XHJcbiAgICBcclxuICAgIHNoaXBzQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ215LXNoaXBzJyk7XHJcbiAgICBlbmVteVNlY3Rpb24uY2xhc3NMaXN0LmFkZCgnZW5lbXktc2VjdGlvbicpO1xyXG4gICAgZW5lbXlHYW1lU2VjdGlvbi5jbGFzc0xpc3QuYWRkKCdlbmVteS1nYW1lLXNlY3Rpb24nKTtcclxuICAgIGVuZW15Qm9hcmQuY2xhc3NMaXN0LmFkZCgnZW5lbXktYm9hcmQnKTtcclxuICAgIGVuZW15TmFtZUJveC5jbGFzc0xpc3QuYWRkKCdlbmVteS1uYW1lLWJveCcpO1xyXG4gICAgZW5lbXlOYW1lLmNsYXNzTGlzdC5hZGQoJ2VuZW15LW5hbWUnKTtcclxuXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDg7IGkgKz0gMSkge1xyXG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgODsgaiArPSAxKSB7XHJcbiAgICAgICAgICBjb25zdCBjb29yZGluYXRlID0gYCR7aX0sJHtqfWA7XHJcbiAgICAgICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgIGNvbnN0IGRpdkVuZW15ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICBkaXYuY2xhc3NMaXN0LmFkZCgnbXktZGl2LWJveCcpO1xyXG4gICAgICAgICAgZGl2RW5lbXkuY2xhc3NMaXN0LmFkZCgnZW5lbXktZGl2LWJveCcpO1xyXG5cclxuICAgICAgICAgIGRpdi5pZCA9IGBQICR7Y29vcmRpbmF0ZX1gO1xyXG4gICAgICAgICAgZGl2RW5lbXkuaWQgPSBgRSAke2Nvb3JkaW5hdGV9YDtcclxuICBcclxuICAgICAgICAgIG15Qm9hcmQuYXBwZW5kQ2hpbGQoZGl2KTtcclxuICAgICAgICAgIGVuZW15Qm9hcmQuYXBwZW5kQ2hpbGQoZGl2RW5lbXkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBteU5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgZW5lbXlOYW1lLnRleHRDb250ZW50ID0gJ0VuZW15JztcclxuXHJcbiAgICBteU5hbWVCb3guYXBwZW5kQ2hpbGQobXlOYW1lKTtcclxuICAgIG15R2FtZVNlY3Rpb24uYXBwZW5kQ2hpbGQobXlCb2FyZCk7XHJcbiAgICBteVNlY3Rpb24uYXBwZW5kQ2hpbGQobXlOYW1lQm94KTtcclxuICAgIG15U2VjdGlvbi5hcHBlbmRDaGlsZChteUdhbWVTZWN0aW9uKTtcclxuICAgIFxyXG4gICAgZW5lbXlOYW1lQm94LmFwcGVuZENoaWxkKGVuZW15TmFtZSk7XHJcbiAgICBlbmVteUdhbWVTZWN0aW9uLmFwcGVuZENoaWxkKGVuZW15Qm9hcmQpO1xyXG4gICAgZW5lbXlTZWN0aW9uLmFwcGVuZENoaWxkKGVuZW15TmFtZUJveCk7XHJcbiAgICBlbmVteVNlY3Rpb24uYXBwZW5kQ2hpbGQoZW5lbXlHYW1lU2VjdGlvbik7XHJcblxyXG4gICAgbWFpbi5hcHBlbmRDaGlsZChteVNlY3Rpb24pO1xyXG4gICAgbWFpbi5hcHBlbmRDaGlsZChzaGlwc0NvbnRhaW5lcik7XHJcbiAgICBtYWluLmFwcGVuZENoaWxkKGVuZW15U2VjdGlvbik7XHJcblxyXG4gICAgbWFpbi5jbGFzc0xpc3QuYWRkKCdtYWluLWdhbWUnKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVuZGVyTXlCb2FyZCAoYm9hcmQpIHtcclxuICAgIGNvbnN0IGJveGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm15LWRpdi1ib3gnKTtcclxuXHJcbiAgICBmb3IgKGNvbnN0IGJveCBvZiBib3hlcykge1xyXG4gICAgICAgIGxldCBjb29yZGluYXRlcyA9IGJveC5pZDtcclxuICAgICAgICBsZXQgc3BsaXQgPSBjb29yZGluYXRlcy5zcGxpdCgnICcpO1xyXG4gICAgICAgIGxldCBudW0gPSBzcGxpdFsxXTsgXHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGJvYXJkLmJvYXJkW251bV0uaGFzU2hpcCkge1xyXG4gICAgICAgICAgICBib3guc3R5bGUuYmFja2dyb3VuZCA9ICdncmVlbic7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChib2FyZC5ib2FyZFtudW1dLmF0dGFja2VkKSB7XHJcbiAgICAgICAgICAgIGJveC5pbm5lckhUTUwgPSAn4p2MJztcclxuICAgICAgICAgICAgYm94LnN0eWxlLmJhY2tncm91bmQgPSAnI0Y1QzJDMSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChib2FyZC5ib2FyZFtudW1dLm1pc3NlZCkge1xyXG4gICAgICAgICAgICBib3guaW5uZXJIVE1MID0gJ/CfkqYnO1xyXG4gICAgICAgICAgICBib3guc3R5bGUuYmFja2dyb3VuZCA9ICdsaWdodGJsdWUnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gcmVuZGVyRW5lbXlCb2FyZCAoYm9hcmQpIHtcclxuICAgIGNvbnN0IGJveGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmVuZW15LWRpdi1ib3gnKTtcclxuXHJcbiAgICBmb3IgKGNvbnN0IGJveCBvZiBib3hlcykge1xyXG4gICAgICAgIGxldCBjb29yZGluYXRlcyA9IGJveC5pZDtcclxuICAgICAgICBsZXQgc3BsaXQgPSBjb29yZGluYXRlcy5zcGxpdCgnICcpO1xyXG4gICAgICAgIGxldCBudW0gPSBzcGxpdFsxXTsgXHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGJvYXJkLmJvYXJkW251bV0uaGFzU2hpcCkge1xyXG4gICAgICAgICAgICBib3guc3R5bGUuYmFja2dyb3VuZCA9ICdvcmFuZ2UnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYm9hcmQuYm9hcmRbbnVtXS5hdHRhY2tlZCkge1xyXG4gICAgICAgICAgICBib3guaW5uZXJIVE1MID0gJ+KdjCc7XHJcbiAgICAgICAgICAgIGJveC5zdHlsZS5iYWNrZ3JvdW5kID0gJyNGNUMyQzEnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYm9hcmQuYm9hcmRbbnVtXS5taXNzZWQpIHtcclxuICAgICAgICAgICAgYm94LmlubmVySFRNTCA9ICfwn5KmJztcclxuICAgICAgICAgICAgYm94LnN0eWxlLmJhY2tncm91bmQgPSAnbGlnaHRibHVlJztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGJvYXJkLmJvYXJkW251bV0uaGFzU2hpcCkge1xyXG4gICAgICAgICAgICBib3guaW5uZXJIVE1MID0gJ/CfmqInO1xyXG4gICAgICAgICAgICBib3guc3R5bGUuYmFja2dyb3VuZCA9ICdsaWdodGJsdWUnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gc2VsZWN0U2hpcHMgKG15Qm9hcmQpIHtcclxuICAgIGxldCBzaGlwcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zaGlwJyk7XHJcbiAgICBsZXQgc2l6ZXMgPSBbNSw0LDMsMywyXTtcclxuICAgIGxldCBib3hlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5teS1kaXYtYm94Jyk7XHJcblxyXG5cclxuICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgbGV0IHNpemUgPSBzaGlwc1tpXS5kYXRhc2V0LnNpemUgPSBzaXplc1tpXTtcclxuICAgICAgIFxyXG4gICAgICAgc2hpcHNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgYWRkQm94ZXNMaXN0ZW5lcihteUJvYXJkLCBzaXplKTtcclxuICAgICAgICAgICBoYW5kbGVTaGlwQ2xhc2VzKHNoaXBzLCBzaGlwc1tpXSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKGkgPT09IDApIHNoaXBzW2ldLmNsaWNrKCk7XHJcbiAgIH07XHJcbn07XHJcblxyXG5cclxuZnVuY3Rpb24gYWRkQm94ZXNMaXN0ZW5lciAobXlCb2FyZCwgc2l6ZSkge1xyXG4gICAgbGV0IGJveGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm15LWRpdi1ib3gnKTtcclxuICAgIGxldCBhcnJheSA9IG15Qm9hcmQuYm9hcmRBcnJheSgpO1xyXG5cclxuICAgIGlmIChzaXplKSB7XHJcbiAgICAgICAgYm94ZXMuZm9yRWFjaChib3ggPT4ge1xyXG4gICAgICAgICAgICBib3guYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IGJveElkID0gYm94LmlkO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNwbGl0ID0gYm94SWQuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgICAgIGxldCBjdXQgPSBzcGxpdFswXS5zcGxpdCgnICcpO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBjb29yZGluYXRlcyA9IGAke2N1dFsxXX0sJHtzcGxpdFsxXX1gO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBsZXQgYWRqYWNlbnRzID0gbXlCb2FyZC5nZXRBZGphY2VudHMoYXJyYXksIHNpemUgLSAxLCBjb29yZGluYXRlcyk7IC8vIGdldCA0IGFkamFjZW50cyAvL1xyXG5cclxuICAgICAgICAgICAgICAgIGFkamFjZW50cy5mb3JFYWNoKGFkaiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhZGoubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGlkID0gYFAgJHthZGpbaV19YDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGl2LmNsYXNzTGlzdC5hZGQoJ292ZXInKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYWRqLmZvckVhY2goc2V0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgbGV0IGlkID0gYFAgJHtzZXR9YDtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgbGV0IGRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgLy8gZml4IGJ1ZyByZW5kZXIgc2l6ZXMvL1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICBkaXYuc3R5bGUuYmFja2dyb3VuZCA9ICdibGFjayc7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIGRpdi5zdHlsZS5ib3JkZXIgPSAnMXB4IHNvbGlkIHdoaXRlJztcclxuICAgICAgICAgICAgICAgICAgICAvLyB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgYm94LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3V0JywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IGJveElkID0gYm94LmlkO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNwbGl0ID0gYm94SWQuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgICAgIGxldCBjdXQgPSBzcGxpdFswXS5zcGxpdCgnICcpO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBjb29yZGluYXRlcyA9IGAke2N1dFsxXX0sJHtzcGxpdFsxXX1gO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBsZXQgYWRqYWNlbnRzID0gbXlCb2FyZC5nZXRBZGphY2VudHMoYXJyYXksIHNpemUgLSAxLCBjb29yZGluYXRlcyk7IC8vIGdldCA0IGFkamFjZW50cyAvL1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBhZGphY2VudHMuZm9yRWFjaChhZGogPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGFkai5mb3JFYWNoKHNldCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpZCA9IGBQICR7c2V0fWA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5jbGFzc0xpc3QucmVtb3ZlKCdvdmVyJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYWxlcnQoJ05vIHNpemUnKTsgfVxyXG59O1xyXG5cclxuZnVuY3Rpb24gcmVtb3ZlQm94ZXNMaXN0ZW5lciAobXlCb2FyZCwgc2l6ZSkge1xyXG4gICAgbGV0IGJveGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm15LWRpdi1ib3gnKTtcclxuICAgIGJveGVzLmZvckVhY2goYm94ID0+IHtcclxuICAgICAgICBib3gucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgYm94SWQgPSBib3guaWQ7XHJcbiAgICAgICAgICAgIGxldCBzcGxpdCA9IGJveElkLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgICAgIGxldCBjdXQgPSBzcGxpdFswXS5zcGxpdCgnICcpO1xyXG5cclxuICAgICAgICAgICAgbGV0IGNvb3JkaW5hdGVzID0gYCR7Y3V0WzFdfSwke3NwbGl0WzFdfWA7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBsZXQgYWRqYWNlbnRzID0gbXlCb2FyZC5nZXRBZGphY2VudHMoYXJyYXksIHNpemUsIGNvb3JkaW5hdGVzKTsgLy8gZ2V0IDQgYWRqYWNlbnRzIC8vXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBhZGphY2VudHMuZm9yRWFjaChhZGogPT4ge1xyXG4gICAgICAgICAgICAgICAgYWRqLmZvckVhY2goc2V0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgaWQgPSBgUCAke3NldH1gO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmJhY2tncm91bmQgPSAnYmxhY2snO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGJveC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsICgpID0+IHtcclxuICAgICAgICAgICAgbGV0IGJveElkID0gYm94LmlkO1xyXG4gICAgICAgICAgICBsZXQgc3BsaXQgPSBib3hJZC5zcGxpdCgnLCcpO1xyXG4gICAgICAgICAgICBsZXQgY3V0ID0gc3BsaXRbMF0uc3BsaXQoJyAnKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBjb29yZGluYXRlcyA9IGAke2N1dFsxXX0sJHtzcGxpdFsxXX1gO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbGV0IGFkamFjZW50cyA9IG15Qm9hcmQuZ2V0QWRqYWNlbnRzKGFycmF5LCBzaXplLCBjb29yZGluYXRlcyk7IC8vIGdldCA0IGFkamFjZW50cyAvL1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgYWRqYWNlbnRzLmZvckVhY2goYWRqID0+IHtcclxuICAgICAgICAgICAgICAgIGFkai5mb3JFYWNoKHNldCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGlkID0gYFAgJHtzZXR9YDtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5iYWNrZ3JvdW5kID0gJ2xpZ2h0Z29sZGVucm9keWVsbG93JztcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgfSk7XHJcbn07XHJcblxyXG5cclxuZnVuY3Rpb24gcHJpbnRBZGphY2VudHMgKGFkamFjZW50cywgc2l6ZSkge1xyXG4gICAgY29uc29sZS5sb2coYWRqYWNlbnRzKTtcclxuICAgIC8vIGlmIChhZGphY2VudHMubGVuZ3RoICE9PSBzaXplKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAvLyBhZGphY2VudHMuZm9yRWFjaChhZGogPT4ge1xyXG4gICAgLy8gICAgIGxldCBpZCA9IGBQICR7YWRqfWA7XHJcbiAgICAvLyAgICAgbGV0IGRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcclxuICAgICAgICBcclxuICAgIC8vICAgICBkaXYuc3R5bGUuYmFja2dyb3VuZCA9ICdibGFjayc7XHJcbiAgICAvLyB9KVxyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gaGFuZGxlU2hpcENsYXNlcyAoc2hpcHMsIHNlbGVjdGVkKSB7XHJcbiAgICBzaGlwcy5mb3JFYWNoKHNoaXAgPT4ge1xyXG4gICAgICAgIGlmIChzaGlwLmNsYXNzTGlzdC5jb250YWlucygnc2hpcC1zZWxlY3RlZCcpKSB7XHJcbiAgICAgICAgICAgIHNoaXAuY2xhc3NMaXN0LnJlbW92ZSgnc2hpcC1zZWxlY3RlZCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoc2hpcCA9PT0gc2VsZWN0ZWQpIHNoaXAuY2xhc3NMaXN0LmFkZCgnc2hpcC1zZWxlY3RlZCcpO1xyXG4gICAgfSlcclxufVxyXG5cclxuZnVuY3Rpb24gZHJvcFNoaXBzIChhZGphY2VudHMpIHtcclxuICAgIC8vIDQgYWRqYWNlbnRzIC8vIGlmIGtleSB1cCBzaG93IGFkamFjZW50c1swXSwgaWYga2V5IGRvd24gc2hvdyBhZGphY2VudHNbMl0gYW5kIHNvIG9uIC8vIFxyXG5cclxuXHJcbiAgICBsZXQgYm94ZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubXktZGl2LWJveCcpO1xyXG4gICAgXHJcbiAgICBib3hlcy5mb3JFYWNoKGRpdiA9PiB7XHJcbiAgICAgICAgZGl2LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBib3hJZCA9IGRpdi5pZDtcclxuICAgICAgICAgICAgLy8gNCw0IC8vXHJcbiAgICAgICAgICAgIGxldCBzcGxpdCA9IGJveElkLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgICAgIGxldCBhZGphY2VudHMgPSBbYm94SWRdO1xyXG4gICAgICAgICAgICBsZXQgaiA9IHNwbGl0WzFdO1xyXG5cclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGorKztcclxuICAgICAgICAgICAgICAgIGlmIChqID4gNykgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBhZGphY2VudHMucHVzaChgJHtzcGxpdFswXX0sICR7c3BsaXRbal19YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYWRqYWNlbnRzLmZvckVhY2goYWRqID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCBzaWRlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGFkaik7XHJcbiAgICAgICAgICAgICAgICBzaWRlcy5zdHlsZS5iYWNrZ3JvdW5kID0gJ2JsYWNrJztcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLy8gZGl2LnN0eWxlLmJhY2tncm91bmQgPSAnYmxhY2snO1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGRpdi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGRpdi5zdHlsZS5iYWNrZ3JvdW5kID0gJ2xpZ2h0Z29sZGVucm9keWVsbG93JztcclxuICAgICAgICB9KVxyXG4gICAgfSlcclxufVxyXG5cclxuZnVuY3Rpb24gcmVuZGVyV2luICgpIHtcclxuICAgIGNvbnN0IG1haW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbicpO1xyXG4gICAgY29uc3QgYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7IFxyXG4gICAgY29uc3QgcGxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpXHJcblxyXG4gICAgYm94LmNsYXNzTGlzdC5hZGQoJ3BvcC11cC1ib3gnKTtcclxuICAgIHRpdGxlLmNsYXNzTGlzdC5hZGQoJ3RpdGxlLXBvcC11cCcpO1xyXG4gICAgcGxheS5jbGFzc0xpc3QuYWRkKCdwbGF5LWJ1dHRvbicpO1xyXG5cclxuICAgIHRpdGxlLnRleHRDb250ZW50ID0gJ1lvdSBXaW4nO1xyXG4gICAgcGxheS5pbm5lckhUTUwgPSAnUGxheSBBZ2Fpbic7XHJcbiAgICBwbGF5LnR5cGUgPSAnc3VibWl0JztcclxuXHJcbiAgICBib3guYXBwZW5kQ2hpbGQodGl0bGUpO1xyXG4gICAgYm94LmFwcGVuZENoaWxkKHBsYXkpO1xyXG5cclxuICAgIG1haW4uYXBwZW5kQ2hpbGQoYm94KTtcclxuXHJcbiAgICBwbGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgIGNsZWFuKCk7XHJcbiAgICAgICAgd3JpdGVOYW1lKCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVuZGVyTG9zZSAoKSB7XHJcbiAgICBjb25zdCBtYWluID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW4nKTtcclxuICAgIGNvbnN0IGJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpOyBcclxuICAgIGNvbnN0IHBsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxyXG5cclxuICAgIGJveC5jbGFzc0xpc3QuYWRkKCdwb3AtdXAtYm94Jyk7XHJcbiAgICB0aXRsZS5jbGFzc0xpc3QuYWRkKCd0aXRsZS1wb3AtdXAnKTtcclxuICAgIHBsYXkuY2xhc3NMaXN0LmFkZCgncGxheS1idXR0b24nKTtcclxuXHJcbiAgICB0aXRsZS50ZXh0Q29udGVudCA9ICdZb3UgTG9zZSc7XHJcbiAgICBwbGF5LmlubmVySFRNTCA9ICdQbGF5IEFnYWluJztcclxuICAgIHBsYXkudHlwZSA9ICdzdWJtaXQnO1xyXG5cclxuICAgIGJveC5hcHBlbmRDaGlsZCh0aXRsZSk7XHJcbiAgICBib3guYXBwZW5kQ2hpbGQocGxheSk7XHJcblxyXG4gICAgbWFpbi5hcHBlbmRDaGlsZChib3gpO1xyXG5cclxuICAgIHBsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgY2xlYW4oKTtcclxuICAgICAgICB3cml0ZU5hbWUoKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjbGVhbiAoKSB7XHJcbiAgICBjb25zdCBtYWluID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW4nKTtcclxuICAgIG1haW4uaW5uZXJIVE1MID0gJyc7XHJcbn1cclxuXHJcblxyXG5leHBvcnQge3dyaXRlTmFtZSwgY2xlYW4sIHJlbmRlckluaXRhbEJvYXJkcywgcmVuZGVyTXlCb2FyZCwgcmVuZGVyRW5lbXlCb2FyZCwgcmVuZGVyV2luLCByZW5kZXJMb3NlLCBzZWxlY3RTaGlwcywgYWRkQm94ZXNMaXN0ZW5lcn07XHJcbiIsImltcG9ydCB7IFNoaXAsIEdhbWVib2FyZCwgUGxheWVyIH0gZnJvbSBcIi4vZmFjdG9yaWVzXCI7XHJcbmltcG9ydCB7IHdyaXRlTmFtZSwgcmVuZGVySW5pdGFsQm9hcmRzLCByZW5kZXJNeUJvYXJkLCByZW5kZXJFbmVteUJvYXJkLCAgY2xlYW4sIHJlbmRlcldpbiwgcmVuZGVyTG9zZSwgc2VsZWN0U2hpcHMsIGFkZEJveGVzTGlzdGVuZXIgfSBmcm9tIFwiLi9yZW5kZXJcIjtcclxuXHJcblxyXG5mdW5jdGlvbiBnYW1lIChuYW1lKSB7XHJcbiAgICBsZXQgbXlCb2FyZCA9IG5ldyBHYW1lYm9hcmQoKTtcclxuICAgIGxldCBlbmVteUJvYXJkID0gbmV3IEdhbWVib2FyZCgpO1xyXG4gICAgXHJcbiAgICBteUJvYXJkLmNyZWF0ZUJvYXJkKCk7XHJcbiAgICBlbmVteUJvYXJkLmNyZWF0ZUJvYXJkKCk7XHJcblxyXG4gICAgcmVuZGVySW5pdGFsQm9hcmRzKG5hbWUpO1xyXG4gICAgc2VsZWN0U2hpcHMobXlCb2FyZCk7XHJcbiAgICBcclxuICAgIFxyXG4gICAgXHJcbiAgICBsZXQgcGxheWVyID0gbmV3IFBsYXllcihteUJvYXJkKTtcclxuICAgIGxldCBlbmVteSA9IG5ldyBQbGF5ZXIoZW5lbXlCb2FyZCk7XHJcbiAgICBlbmVteUJvYXJkLnJlY2VpdmVBdHRhY2soJzAsNCcpO1xyXG4gICAgZW5lbXlCb2FyZC5wbGFjZUVuZW15U2hpcHMoKTtcclxuXHJcbiAgICBcclxuICAgIHJlbmRlck15Qm9hcmQocGxheWVyLmdhbWVib2FyZCk7XHJcbiAgICByZW5kZXJFbmVteUJvYXJkKGVuZW15LmdhbWVib2FyZCk7XHJcblxyXG4gICAgY29uc3QgZW5lbXlCb3hlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lbmVteS1kaXYtYm94Jyk7XHJcbiAgICBsZXQgZUJveGVzID0gWy4uLmVuZW15Qm94ZXNdO1xyXG5cclxuICAgIGVCb3hlcy5mb3JFYWNoKGVCb3ggPT4ge1xyXG4gICAgICAgIGVCb3guYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgZUNvb3JkaW5hdGVzID0gZS50YXJnZXQuaWQ7XHJcbiAgICAgICAgICAgIGxldCBlU3BsaXQgPSBlQ29vcmRpbmF0ZXMuc3BsaXQoJyAnKTtcclxuICAgICAgICAgICAgbGV0IGVOdW0gPSBlU3BsaXRbMV07IFxyXG5cclxuICAgICAgICAgICAgbGV0IGVuZW15TW92ZSA9IGVuZW15Lm1ha2VSYW5kb21Nb3ZlKCk7XHJcbiAgICAgICAgICAgIGxldCBlbmVteUF0dGFjayA9IG15Qm9hcmQucmVjZWl2ZUF0dGFjayhlbmVteU1vdmUpO1xyXG4gICAgICAgICAgICBsZXQgYXR0YWNrID0gZW5lbXlCb2FyZC5yZWNlaXZlQXR0YWNrKGVOdW0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGF0dGFjaykge1xyXG4gICAgICAgICAgICAgICAgcmVuZGVyRW5lbXlCb2FyZChlbmVteS5nYW1lYm9hcmQpO1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoIWVuZW15QXR0YWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZW15TW92ZSA9IGVuZW15Lm1ha2VSYW5kb21Nb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZW15QXR0YWNrID0gbXlCb2FyZC5yZWNlaXZlQXR0YWNrKGVuZW15TW92ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJlbmRlck15Qm9hcmQocGxheWVyLmdhbWVib2FyZCk7XHJcbiAgICAgICAgICAgICAgICAgIH0sIDEwMDApOyBcclxuICAgICAgICAgICAgICAgICAgXHJcbiAgICBcclxuICAgICAgICAgICAgICAgIGxldCBteVN1bmsgPSBteUJvYXJkLmFsbFN1bmsoKTtcclxuICAgICAgICAgICAgICAgIGxldCBlbmVteVN1bmsgPSBlbmVteUJvYXJkLmFsbFN1bmsoKTtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gaWYgKG15U3Vuaykge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIGNsZWFuKCk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgcmVuZGVyTG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgLy8gfTtcclxuICAgICAgICAgICAgICAgIC8vIGlmIChlbmVteVN1bmspIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICBjbGVhbigpO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIHJlbmRlcldpbigpO1xyXG4gICAgICAgICAgICAgICAgLy8gfTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5cclxuXHJcblxyXG5cclxuLy8gMS4gQ3JlYXRlIHRoZSBtYWluIGdhbWUgbG9vcCBhbmQgYSBtb2R1bGUgZm9yIERPTSBpbnRlcmFjdGlvbi5cclxuLy8gICAgICBhLiBBdCB0aGlzIHBvaW50IGl0IGlzIGFwcHJvcHJpYXRlIHRvIGJlZ2luIGNyYWZ0aW5nIHlvdXIgVXNlciBJbnRlcmZhY2UuXHJcbi8vICAgICAgYi4gVGhlIGdhbWUgbG9vcCBzaG91bGQgc2V0IHVwIGEgbmV3IGdhbWUgYnkgY3JlYXRpbmcgUGxheWVycyBhbmQgR2FtZWJvYXJkcy4gRm9yIG5vdyBqdXN0IHBvcHVsYXRlIGVhY2ggR2FtZWJvYXJkIHdpdGggcHJlZGV0ZXJtaW5lZCBjb29yZGluYXRlcy4gWW91IGNhbiBpbXBsZW1lbnQgYSBzeXN0ZW0gZm9yIGFsbG93aW5nIHBsYXllcnMgdG8gcGxhY2UgdGhlaXIgc2hpcHMgbGF0ZXIuXHJcbi8vICAgICAgYy4gV2XigJlsbCBsZWF2ZSB0aGUgSFRNTCBpbXBsZW1lbnRhdGlvbiB1cCB0byB5b3UgZm9yIG5vdywgYnV0IHlvdSBzaG91bGQgZGlzcGxheSBib3RoIHRoZSBwbGF5ZXLigJlzIGJvYXJkcyBhbmQgcmVuZGVyIHRoZW0gdXNpbmcgaW5mb3JtYXRpb24gZnJvbSB0aGUgR2FtZWJvYXJkIGNsYXNzL2ZhY3RvcnkuXHJcbi8vICAgICAgICAgIGEuIFlvdSBuZWVkIG1ldGhvZHMgdG8gcmVuZGVyIHRoZSBnYW1lYm9hcmRzIGFuZCB0byB0YWtlIHVzZXIgaW5wdXQgZm9yIGF0dGFja2luZy4gRm9yIGF0dGFja3MsIGxldCB0aGUgdXNlciBjbGljayBvbiBhIGNvb3JkaW5hdGUgaW4gdGhlIGVuZW15IEdhbWVib2FyZC5cclxuLy8gICAgICBkLiBUaGUgZ2FtZSBsb29wIHNob3VsZCBzdGVwIHRocm91Z2ggdGhlIGdhbWUgdHVybiBieSB0dXJuIHVzaW5nIG9ubHkgbWV0aG9kcyBmcm9tIG90aGVyIG9iamVjdHMuIElmIGF0IGFueSBwb2ludCB5b3UgYXJlIHRlbXB0ZWQgdG8gd3JpdGUgYSBuZXcgZnVuY3Rpb24gaW5zaWRlIHRoZSBnYW1lIGxvb3AsIHN0ZXAgYmFjayBhbmQgZmlndXJlIG91dCB3aGljaCBjbGFzcyBvciBtb2R1bGUgdGhhdCBmdW5jdGlvbiBzaG91bGQgYmVsb25nIHRvLlxyXG4vLyAgICAgIGUuIENyZWF0ZSBjb25kaXRpb25zIHNvIHRoYXQgdGhlIGdhbWUgZW5kcyBvbmNlIG9uZSBwbGF5ZXLigJlzIHNoaXBzIGhhdmUgYWxsIGJlZW4gc3Vuay4gVGhpcyBmdW5jdGlvbiBpcyBhcHByb3ByaWF0ZSBmb3IgdGhlIEdhbWUgbW9kdWxlLlxyXG5cclxuXHJcbi8vIDIuIEZpbmlzaCBpdCB1cFxyXG4vLyAgICAgIGEuIFRoZXJlIGFyZSBzZXZlcmFsIG9wdGlvbnMgYXZhaWxhYmxlIGZvciBsZXR0aW5nIHVzZXJzIHBsYWNlIHRoZWlyIHNoaXBzLiBZb3UgY2FuIGxldCB0aGVtIHR5cGUgY29vcmRpbmF0ZXMgZm9yIGVhY2ggc2hpcCwgb3IgaW52ZXN0aWdhdGUgaW1wbGVtZW50aW5nIGRyYWcgYW5kIGRyb3AuXHJcbi8vICAgICAgYi4gWW91IGNhbiBwb2xpc2ggdGhlIGludGVsbGlnZW5jZSBvZiB0aGUgY29tcHV0ZXIgcGxheWVyIGJ5IGhhdmluZyBpdCB0cnkgYWRqYWNlbnQgc2xvdHMgYWZ0ZXIgZ2V0dGluZyBhIOKAmGhpdOKAmS5cclxuLy8gICAgICBjLiBPcHRpb25hbGx5LCBjcmVhdGUgYSAyIHBsYXllciBvcHRpb24gdGhhdCBsZXRzIHVzZXJzIHRha2UgdHVybnMgYnkgcGFzc2luZyB0aGUgZGV2aWNlIGJhY2sgYW5kIGZvcnRoLiBJZiB5b3XigJlyZSBnb2luZyB0byBnbyB0aGlzIHJvdXRlLCBtYWtlIHN1cmUgdGhlIGdhbWUgaXMgcGxheWFibGUgb24gYSBtb2JpbGUgc2NyZWVuIGFuZCBpbXBsZW1lbnQgYSDigJhwYXNzIGRldmljZeKAmSBzY3JlZW4gc28gdGhhdCBwbGF5ZXJzIGRvbuKAmXQgc2VlIGVhY2ggb3RoZXJzIGJvYXJkcyFcclxuIFxyXG5cclxuLy8gIFRoZSA1IHNoaXBzIGFyZTogQ2FycmllciAob2NjdXBpZXMgNSBzcGFjZXMpLCBCYXR0bGVzaGlwICg0KSwgQ3J1aXNlciAoMyksIFN1Ym1hcmluZSAoMyksIGFuZCBEZXN0cm95ZXIgKDIpLiAvL1xyXG5cclxuXHJcblxyXG5leHBvcnQge2dhbWV9OyIsIi8vIExpbnRlciwgUHJldHRpZXIsIEplc3QuY29uZmlnIC8vIFxyXG5cclxuaW1wb3J0IHsgU2hpcCwgR2FtZWJvYXJkLCBQbGF5ZXIgfSBmcm9tIFwiLi9mYWN0b3JpZXNcIjtcclxuaW1wb3J0IHsgd3JpdGVOYW1lLCBjbGVhbiwgcmVuZGVySW5pdGFsQm9hcmRzLCByZW5kZXJXaW4sIHJlbmRlckxvc2UsIHNlbGVjdFNoaXBzIH0gZnJvbSBcIi4vcmVuZGVyXCI7XHJcbmltcG9ydCB7IGdhbWUgfSBmcm9tIFwiLi9nYW1lXCI7XHJcblxyXG5nYW1lKCk7Il0sIm5hbWVzIjpbIlNoaXAiLCJjb25zdHJ1Y3RvciIsInNpemUiLCJ0aGlzIiwiaGl0Iiwic3VuayIsImNvb3JkaW5hdGVzIiwicmVnaXN0ZXJIaXQiLCJpc1N1bmsiLCJhZGRDb29yZGluYXRlcyIsInBvc2l0aW9uIiwicHVzaCIsIkdhbWVib2FyZCIsImJvYXJkIiwic2hpcHMiLCJjcmVhdGVCb2FyZCIsImkiLCJqIiwiY29vcmRpbmF0ZSIsImF0dGFja2VkIiwibWlzc2VkIiwiaGFzU2hpcCIsInNoaXAiLCJpc1ZhbGlkIiwiYXJyIiwic3BsaXQiLCJhIiwiTnVtYmVyIiwiYiIsImdldEJvYXJkIiwiYWRkU2hpcCIsInBsYWNlU2hpcCIsImxlbmd0aCIsImlzTW92ZUxlZ2FsIiwibW92ZSIsInBsYWNlRW5lbXlTaGlwcyIsImNvb3JkaW5hdGVDYXJyaWVyIiwiY3JlYXRlQ29vcmRpbmF0ZXMiLCJjb29yZGluYXRlQmF0dGxlc2hpcCIsImNvb3JkaW5hdGVDcnVpc2VyIiwiY29vcmRpbmF0ZVN1Ym1hcmluZSIsImNvb3JkaW5hdGVEZXN0cm95ZXIiLCJhcnJheSIsImJvYXJkQXJyYXkiLCJnZXRBZGphY2VudHMiLCJzaXplcyIsImZpbHRlcmVkIiwidGVtcCIsImZpbHRlciIsInBvcyIsImZvckVhY2giLCJzZXRPZkNvb3JkaW5hdGVzIiwibnVtMSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsIm51bTIiLCJyZXN1bHQiLCJhcnJheUJvYXJkIiwiYWRqYWNlbnRzIiwidXAiLCJyaWdodCIsImRvd24iLCJsZWZ0IiwiaW5kZXgiLCJwbGFjZSIsImluY2x1ZGVzIiwicGxhY2VTcGxpdCIsInJlY2VpdmVBdHRhY2siLCJzdHIiLCJnZXRTaGlwcyIsImFsbFN1bmsiLCJldmVyeSIsIm9iaiIsImtleSIsImVuZW15Qm9hcmQiLCJjb25zb2xlIiwibG9nIiwibW9kdWxlIiwiZXhwb3J0cyIsIlBsYXllciIsImdhbWVib2FyZCIsIm1ha2VSYW5kb21Nb3ZlIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsInJlbmRlck15Qm9hcmQiLCJib3hlcyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImJveCIsIm51bSIsImlkIiwic3R5bGUiLCJiYWNrZ3JvdW5kIiwiaW5uZXJIVE1MIiwicmVuZGVyRW5lbXlCb2FyZCIsImFkZEJveGVzTGlzdGVuZXIiLCJteUJvYXJkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImFkaiIsImdldEVsZW1lbnRCeUlkIiwiY2xhc3NMaXN0IiwiYWRkIiwic2V0IiwicmVtb3ZlIiwiYWxlcnQiLCJoYW5kbGVTaGlwQ2xhc2VzIiwic2VsZWN0ZWQiLCJjb250YWlucyIsIm5hbWUiLCJtYWluIiwibXlTZWN0aW9uIiwiY3JlYXRlRWxlbWVudCIsIm15R2FtZVNlY3Rpb24iLCJteU5hbWVCb3giLCJteU5hbWUiLCJzaGlwc0NvbnRhaW5lciIsImVuZW15U2VjdGlvbiIsImVuZW15R2FtZVNlY3Rpb24iLCJlbmVteU5hbWVCb3giLCJlbmVteU5hbWUiLCJjYXJyaWVyIiwiYmF0dGxlc2hpcCIsImNydWlzZXIiLCJzdWJtYXJpbmUiLCJkZXN0cm95ZXIiLCJzcmMiLCJhcHBlbmRDaGlsZCIsImRpdiIsImRpdkVuZW15IiwidGV4dENvbnRlbnQiLCJyZW5kZXJJbml0YWxCb2FyZHMiLCJkYXRhc2V0IiwiY2xpY2siLCJzZWxlY3RTaGlwcyIsInBsYXllciIsImVuZW15IiwiZUJveCIsImUiLCJlTnVtIiwidGFyZ2V0IiwiZW5lbXlNb3ZlIiwiZW5lbXlBdHRhY2siLCJzZXRUaW1lb3V0Il0sInNvdXJjZVJvb3QiOiIifQ==