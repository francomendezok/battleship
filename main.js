(()=>{var e={776:e=>{class t{constructor(e){this.size=e,this.hit=0,this.sunk=!1,this.coordinates=[]}registerHit(){return this.hit+=1}isSunk(){return this.hit===this.size}addCoordinates(e){this.coordinates.push(e)}}e.exports={Ship:t,Gameboard:class{constructor(){this.board=[],this.ships=[]}createBoard(e=8){for(let t=0;t<e;t+=1)for(let a=0;a<e;a+=1){const e=`${t},${a}`;this.board[e]={coordinates:e,attacked:!1,missed:!1,hasShip:!1,ship:[]}}return this.board}isValid(e){let t=e.split(","),a=Number(t[0]),d=Number(t[1]);return a>=0&&a<=7&&d>=0&&d<=7}getBoard(){return this.board}addShip(e){this.ships.push(e)}placeShip(e,a){if(e!==a.length)return"Size and coordinates length should be equal";const d=new t(e);for(let e=0;e<a.length;e++){if(this.hasShip(a[e]))return!1;this.board[a[e]].ship.push(a),this.board[a[e]].hasShip=!0}return d.addCoordinates(a),this.addShip(d),!0}isMoveLegal(e){return!this.board[e].attacked&&!this.board[e].missed}hasShip(e){return this.board[e].hasShip}placeEnemyShips(){let e=this.createCoordinates(),t=this.createCoordinates(),a=this.createCoordinates(),d=this.createCoordinates(),s=this.createCoordinates(),n=this.boardArray(),o=[this.getAdjacents(n,5,e),this.getAdjacents(n,4,t),this.getAdjacents(n,3,a),this.getAdjacents(n,3,d),this.getAdjacents(n,2,s)],r=[5,4,3,3,2],i=[];for(let e=0;e<o.length;e++){let t=o[e].filter((t=>t.length===r[e]));i.push(t)}i.forEach((e=>{this.placeShip(e[0].length,e[0])}))}createCoordinates(){let e=Math.floor(8*Math.random()),t=Math.floor(8*Math.random()),a=`${e},${t}`;if(this.hasShip(a)){for(;this.hasShip(a);)e=Math.floor(8*Math.random()),t=Math.floor(8*Math.random()),a=`${e},${t}`;return a}return a}getAdjacents(e,t,a){let d=e.boardArray(),s=[[],[]],n=1,o=8,r=0;for(let e=0;e<d.length;e++)if(d[e].coordinates===a){r=e;break}for(let e=0;e<t;e++){if(d[r+n]){let e=a.split(","),t=d[r+n].coordinates,o=t.split(",");t&&o[0]===e[0]&&(s[0].push(d[r+n].coordinates),n++)}if(d[r+o]){let e=a.split(","),t=d[r+o].coordinates;t.split(","),t&&t.includes(e[1])&&(s[1].push(d[r+o].coordinates),o+=8)}}return s}hasAllShipsPlaced(){return 5===this.ships.length}receiveAttack(e){let t=`${e}`;if(!this.board[t].attacked&&!this.board[t].missed)return this.board[t].hasShip?(this.board[t].attacked=!0,this.ships.forEach((e=>{e.coordinates[0].includes(t)&&(e.registerHit(),e.isSunk()&&(e.sunk=!0))}))):this.board[t].missed=!0,!0}getShips(){return this.ships}allSunk(){return this.ships.every((e=>!0===e.sunk))}boardArray(){const e=this.board,t=[];for(let a in e)t.push(e[a]);return t}},Player:class{constructor(e){this.gameboard=e}isMoveLegal(e){return!this.gameboard.board[e].attacked&&!this.gameboard.board[e].missed}makeRandomMove(){let e=Math.floor(8*Math.random()),t=Math.floor(8*Math.random()),a=`${e},${t}`;if(this.isMoveLegal(a))return a;for(;!this.isMoveLegal(a);)e=Math.floor(8*Math.random()),t=Math.floor(8*Math.random()),a=`${e},${t}`;return a}}}}},t={};function a(d){var s=t[d];if(void 0!==s)return s.exports;var n=t[d]={exports:{}};return e[d](n,n.exports,a),n.exports}(()=>{"use strict";var e=a(776);function t(e){const t=document.getElementById("main"),a=document.createElement("div"),d=document.createElement("div"),s=document.createElement("div"),n=document.createElement("div"),o=document.createElement("h3"),r=document.createElement("div"),i=document.createElement("div"),l=document.createElement("div"),c=document.createElement("div"),h=document.createElement("h3");a.classList.add("my-section"),d.classList.add("my-game-section"),s.classList.add("my-board"),n.classList.add("my-name-box"),o.classList.add("my-name"),r.classList.add("enemy-section"),i.classList.add("enemy-game-section"),l.classList.add("enemy-board"),c.classList.add("enemy-name-box"),h.classList.add("enemy-name");for(let e=0;e<8;e+=1)for(let t=0;t<8;t+=1){const a=`${e},${t}`,d=document.createElement("div"),n=document.createElement("div");d.classList.add("my-div-box"),n.classList.add("enemy-div-box"),d.id=`P ${a}`,n.id=`E ${a}`,s.appendChild(d),l.appendChild(n)}o.textContent=e,h.textContent="Enemy",n.appendChild(o),d.appendChild(s),a.appendChild(n),a.appendChild(d),c.appendChild(h),i.appendChild(l),r.appendChild(c),r.appendChild(i),t.appendChild(a),t.appendChild(r),t.classList.add("main-game")}function d(){document.getElementById("main").innerHTML=""}!function(){const a=document.getElementById("main"),s=document.createElement("div"),n=document.createElement("h3"),o=document.createElement("input"),r=document.createElement("button");s.classList.add("pop-up-box"),n.classList.add("title-pop-up"),o.classList.add("input-pop-up"),r.classList.add("play-button"),n.textContent="Write your Name",r.innerHTML="Battle",o.type="text",r.type="submit",s.appendChild(n),s.appendChild(o),s.appendChild(r),a.appendChild(s),r.addEventListener("click",(()=>{o.value?(d(),function(a){const s=document.getElementById("main"),n=document.createElement("div"),o=document.createElement("div"),r=document.createElement("div"),i=document.createElement("div"),l=document.createElement("h3"),c=document.createElement("button"),h=["Carrier","Battleship","Cruiser","Submarine","Destroyer"];let m=[4,3,2,2,1];s.classList.add("main-game"),n.classList.add("my-section"),o.classList.add("my-game-section"),r.classList.add("my-board"),i.classList.add("my-name-box"),l.classList.add("my-name"),c.classList.add("axis");let u=0;l.textContent=`${a},  place your  ${h[u]}`,l.dataset.size=u,c.innerHTML="Axis X",c.addEventListener("click",(()=>{"Axis X"===c.innerHTML?c.innerHTML="Axis Y":c.innerHTML="Axis X"}));let p=new e.Gameboard;p.createBoard(),new e.Player(p);for(let e=0;e<8;e+=1)for(let s=0;s<8;s+=1){const n=`${e},${s}`,o=document.createElement("div");o.classList.add("my-div-box"),o.id=`${n}`,7===s&&(o.dataset.xNotAllowed=!0),7===e&&(o.dataset.yNotAllowed=!0),o.addEventListener("mouseover",(()=>{let e=document.querySelector(".my-name").textContent.split(" "),t=e[e.length-1],a=h.indexOf(t),d=m[a],s=document.querySelector(".axis").textContent.split(" ")[1],n=p.getAdjacents(p,d,o.id);if("X"===s){let e=n[0].some((e=>p.hasShip(e)));(!o.dataset.xNotAllowed||!e||!n[0].length<d)&&n[0].forEach((e=>{let t=document.getElementById(e);o.style.background="black",t.style.background="black",o.style.cursor="crosshair"})),(p.hasShip(o.id)||o.dataset.xNotAllowed||e||n[0].length<d)&&(o.dataset.xNotAllowed?(o.style.background="red",o.style.cursor="not-allowed"):n[0].forEach((e=>{let t=document.getElementById(e);o.style.background="red",t.style.background="red",o.style.cursor="not-allowed"})))}if("Y"===s){let e=n[1].some((e=>p.hasShip(e)));(!o.dataset.yNotAllowed||!e||!n[1].length<d)&&n[1].forEach((e=>{let t=document.getElementById(e);o.style.background="black",t.style.background="black",o.style.cursor="crosshair"})),(p.hasShip(o.id)||o.dataset.yNotAllowed||e||n[1].length<d)&&(o.dataset.yNotAllowed?(o.style.background="red",o.style.cursor="not-allowed"):n[1].forEach((e=>{let t=document.getElementById(e);o.style.background="red",t.style.background="red",o.style.cursor="not-allowed"})))}})),o.addEventListener("mouseleave",(()=>{let e=document.querySelector(".my-name").textContent.split(" "),t=e[e.length-1],a=h.indexOf(t),d=m[a],s=document.querySelector(".axis").textContent.split(" ")[1],n=p.getAdjacents(p,d,o.id);"X"===s&&(o.dataset.xNotAllowed&&(o.style.background="lightgoldenrodyellow",o.style.cursor="crosshair"),n[0].forEach((e=>{let t=document.getElementById(e);o.style.background="lightgoldenrodyellow",t.style.background="lightgoldenrodyellow",p.hasShip(t.id)&&(o.style.background="green",t.style.background="green")}))),"Y"===s&&(o.dataset.yNotAllowed&&(o.style.background="lightgoldenrodyellow",o.style.cursor="crosshair"),n[1].forEach((e=>{let t=document.getElementById(e);o.style.background="lightgoldenrodyellow",t.style.background="lightgoldenrodyellow"})))})),o.addEventListener("click",(()=>{u+=1,u===h.length&&(d(),t(a)),l.textContent=`${a},  place your  ${h[u]}`})),r.appendChild(o)}i.appendChild(l),i.appendChild(c),o.appendChild(r),n.appendChild(i),n.appendChild(o),p.placeShip(3,["0,1","0,2","0,3"]),s.appendChild(n),function(e){document.querySelectorAll(".my-div-box").forEach((t=>{let a=t.id;e.board[a].hasShip&&(t.style.background="green"),e.board[a].attacked&&(t.innerHTML="‚ùå",t.style.background="#F5C2C1"),e.board[a].missed&&(t.innerHTML="üí¶",t.style.background="lightblue")}))}(p)}(o.value)):alert("Please Write Your Name")}))}()})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bUJBQXNCckUsRUFBTW1DLElBQU0sSUFRaEV5QyxFQUFRYSxZQUFZSCxFQUN0QixDQUlKVCxFQUFVWSxZQUFZWCxHQUN0QkQsRUFBVVksWUFBWVcsR0FDdEJ6QixFQUFjYyxZQUFZYixHQUMxQkgsRUFBVWdCLFlBQVlaLEdBQ3RCSixFQUFVZ0IsWUFBWWQsR0FFdEI1RSxFQUFNa0IsVUFBVSxFQUFHLENBQUMsTUFBTyxNQUFPLFFBQ2xDcUQsRUFBS21CLFlBQVloQixHQXdFckIsU0FBd0IxRSxHQUNOd0UsU0FBUzJDLGlCQUFpQixlQUNsQzlFLFNBQVF5RCxJQUNYLElBQUl2RyxFQUFjdUcsRUFBSUwsR0FDakJ6RixFQUFNQSxNQUFNVCxHQUFhaUIsVUFDekJzRixFQUFJa0IsTUFBTUMsV0FBYSxTQUV2QmpILEVBQU1BLE1BQU1ULEdBQWFlLFdBQ3pCd0YsRUFBSUQsVUFBWSxJQUNoQkMsRUFBSWtCLE1BQU1DLFdBQWEsV0FFdkJqSCxFQUFNQSxNQUFNVCxHQUFhZ0IsU0FDekJ1RixFQUFJRCxVQUFZLEtBQ2hCQyxFQUFJa0IsTUFBTUMsV0FBYSxZQUMzQixHQUtSLENBMUZJLENBQWNqSCxFQUtsQixDQW5PWW9ILENBQWlCcEIsRUFBTUksUUFFbEJpQixNQUFNLHlCQUF5QixHQUVoRCxDQy9CQUMsRSIsInNvdXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZmFjdG9yaWVzLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9yZW5kZXIuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTaGlwIENsYXNzIC8vXHJcbmNsYXNzIFNoaXAge1xyXG4gICAgY29uc3RydWN0b3IgKHNpemUpIHtcclxuICAgICAgICB0aGlzLnNpemUgPSBzaXplO1xyXG4gICAgICAgIHRoaXMuaGl0ID0gMDtcclxuICAgICAgICB0aGlzLnN1bmsgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNvb3JkaW5hdGVzID0gW107XHJcbiAgICB9XHJcblxyXG4gICAgcmVnaXN0ZXJIaXQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaGl0ICs9IDE7XHJcbiAgICB9XHJcblxyXG4gICAgaXNTdW5rKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmhpdCA9PT0gdGhpcy5zaXplO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZENvb3JkaW5hdGVzIChwb3NpdGlvbikge1xyXG4gICAgICAgIHRoaXMuY29vcmRpbmF0ZXMucHVzaChwb3NpdGlvbik7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIEdhbWVib2FyZCBDbGFzcyAvL1xyXG5jbGFzcyBHYW1lYm9hcmQge1xyXG4gICAgY29uc3RydWN0b3IgKCkge1xyXG4gICAgICAgIHRoaXMuYm9hcmQgPSBbXSBcclxuICAgICAgICB0aGlzLnNoaXBzID0gW11cclxuICAgIH1cclxuICAgIFxyXG4gICAgY3JlYXRlQm9hcmQoc2l6ZSA9IDggKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpICs9IDEpIHtcclxuICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgc2l6ZTsgaiArPSAxKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvb3JkaW5hdGUgPSBgJHtpfSwke2p9YDtcclxuICAgICAgICAgICAgdGhpcy5ib2FyZFtjb29yZGluYXRlXSA9IHsgY29vcmRpbmF0ZXM6IGNvb3JkaW5hdGUsIGF0dGFja2VkOiBmYWxzZSwgbWlzc2VkOiBmYWxzZSwgaGFzU2hpcDogZmFsc2UsIHNoaXA6IFtdIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5ib2FyZDtcclxuICAgICAgfVxyXG5cclxuICAgICAgaXNWYWxpZCAoY29vcmRpbmF0ZXMpIHtcclxuICAgICAgICBsZXQgYXJyID0gY29vcmRpbmF0ZXMuc3BsaXQoJywnKTtcclxuICAgICAgICBsZXQgYSA9IE51bWJlcihhcnJbMF0pO1xyXG4gICAgICAgIGxldCBiID0gTnVtYmVyKGFyclsxXSk7XHJcblxyXG5cclxuICAgICAgICByZXR1cm4gYSA+PSAwICYmIGEgPD0gNyAmJiBiID49IDAgJiYgYiA8PSA3O1xyXG4gICAgICB9XHJcblxyXG4gICAgICBnZXRCb2FyZCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5ib2FyZDtcclxuICAgICAgfVxyXG5cclxuICAgICAgYWRkU2hpcCAoc2hpcCkge1xyXG4gICAgICAgIHRoaXMuc2hpcHMucHVzaChzaGlwKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcGxhY2VTaGlwIChzaXplLCBjb29yZGluYXRlcykge1xyXG4gICAgICAgIGlmIChzaXplICE9PSBjb29yZGluYXRlcy5sZW5ndGgpIHJldHVybiAnU2l6ZSBhbmQgY29vcmRpbmF0ZXMgbGVuZ3RoIHNob3VsZCBiZSBlcXVhbCc7XHJcblxyXG4gICAgICAgIGNvbnN0IHNoaXAgPSBuZXcgU2hpcChzaXplKTtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb29yZGluYXRlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmhhc1NoaXAoY29vcmRpbmF0ZXNbaV0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ib2FyZFtjb29yZGluYXRlc1tpXV0uc2hpcC5wdXNoKGNvb3JkaW5hdGVzKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJvYXJkW2Nvb3JkaW5hdGVzW2ldXS5oYXNTaGlwID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNoaXAuYWRkQ29vcmRpbmF0ZXMoY29vcmRpbmF0ZXMpO1xyXG4gICAgICAgICAgICB0aGlzLmFkZFNoaXAoc2hpcCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpc01vdmVMZWdhbCAobW92ZSkge1xyXG4gICAgICAgIHJldHVybiAhdGhpcy5ib2FyZFttb3ZlXS5hdHRhY2tlZCAmJiAhdGhpcy5ib2FyZFttb3ZlXS5taXNzZWQ7XHJcbiAgICB9XHJcbiAgICAgICAgXHJcbiAgICBoYXNTaGlwIChjb29yZGluYXRlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJvYXJkW2Nvb3JkaW5hdGVdLmhhc1NoaXA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgcGxhY2VFbmVteVNoaXBzICgpIHtcclxuICAgICAgICAgICAgbGV0IGNvb3JkaW5hdGVDYXJyaWVyID0gdGhpcy5jcmVhdGVDb29yZGluYXRlcygpO1xyXG4gICAgICAgICAgICBsZXQgY29vcmRpbmF0ZUJhdHRsZXNoaXAgPSB0aGlzLmNyZWF0ZUNvb3JkaW5hdGVzKCk7XHJcbiAgICAgICAgICAgIGxldCBjb29yZGluYXRlQ3J1aXNlciA9IHRoaXMuY3JlYXRlQ29vcmRpbmF0ZXMoKTtcclxuICAgICAgICAgICAgbGV0IGNvb3JkaW5hdGVTdWJtYXJpbmUgPSB0aGlzLmNyZWF0ZUNvb3JkaW5hdGVzKCk7XHJcbiAgICAgICAgICAgIGxldCBjb29yZGluYXRlRGVzdHJveWVyID0gdGhpcy5jcmVhdGVDb29yZGluYXRlcygpO1xyXG5cclxuICAgICAgICAgICAgbGV0IGFycmF5ID0gdGhpcy5ib2FyZEFycmF5KCk7XHJcblxyXG4gICAgICAgICAgICBsZXQgY2FycmllciA9IHRoaXMuZ2V0QWRqYWNlbnRzKGFycmF5LCA1LCBjb29yZGluYXRlQ2Fycmllcik7XHJcbiAgICAgICAgICAgIGxldCBiYXR0bGVzaGlwID0gdGhpcy5nZXRBZGphY2VudHMoYXJyYXksIDQsIGNvb3JkaW5hdGVCYXR0bGVzaGlwKTtcclxuICAgICAgICAgICAgbGV0IGNydWlzZXIgPSB0aGlzLmdldEFkamFjZW50cyhhcnJheSwgMywgY29vcmRpbmF0ZUNydWlzZXIpO1xyXG4gICAgICAgICAgICBsZXQgc3VibWFyaW5lID0gdGhpcy5nZXRBZGphY2VudHMoYXJyYXksIDMsIGNvb3JkaW5hdGVTdWJtYXJpbmUpO1xyXG4gICAgICAgICAgICBsZXQgZGVzdHJveWVyID0gdGhpcy5nZXRBZGphY2VudHMoYXJyYXksIDIsIGNvb3JkaW5hdGVEZXN0cm95ZXIpO1xyXG5cclxuICAgICAgICAgICAgbGV0IHNoaXBzID0gW2NhcnJpZXIsIGJhdHRsZXNoaXAsIGNydWlzZXIsIHN1Ym1hcmluZSwgZGVzdHJveWVyXTtcclxuICAgICAgICAgICAgbGV0IHNpemVzID0gWzUsNCwzLDMsMl07XHJcbiAgICAgICAgICAgIGxldCBmaWx0ZXJlZCA9IFtdO1xyXG5cclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgbGV0IHRlbXAgPSBzaGlwc1tpXS5maWx0ZXIocG9zID0+IHBvcy5sZW5ndGggPT09IHNpemVzW2ldKTtcclxuICAgICAgICAgICAgICAgIGZpbHRlcmVkLnB1c2godGVtcCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcblxyXG5cclxuICAgICAgICAgICAgZmlsdGVyZWQuZm9yRWFjaChzZXRPZkNvb3JkaW5hdGVzID0+IHsgXHJcbiAgICAgICAgICAgICAgICB0aGlzLnBsYWNlU2hpcChzZXRPZkNvb3JkaW5hdGVzWzBdLmxlbmd0aCwgc2V0T2ZDb29yZGluYXRlc1swXSk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIHNldE9mQ29vcmRpbmF0ZXMuZm9yRWFjaChjb29yZGluYXRlcyA9PiB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgLy8gbGV0IGFmZmlybWF0aXZlID0gY29vcmRpbmF0ZXMuZXZlcnkocG9zaXRpb24gPT4gIXRoaXMuaGFzU2hpcChwb3NpdGlvbikpO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIHRoaXMucGxhY2VTaGlwKGNvb3JkaW5hdGVzLmxlbmd0aCwgY29vcmRpbmF0ZXMpO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIC8vIGNvb3JkaW5hdGVzLmZvckVhY2gocG9zaXRpb24gPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIC8vIH0pXHJcbiAgICAgICAgICAgICAgICAvLyB9KTtcclxuICAgICAgICAgICAgfSk7ICBcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNyZWF0ZUNvb3JkaW5hdGVzICgpIHtcclxuICAgICAgICBsZXQgbnVtMSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDgpOyBcclxuICAgICAgICBsZXQgbnVtMiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDgpOyBcclxuICAgICAgICBsZXQgcmVzdWx0ID0gYCR7bnVtMX0sJHtudW0yfWA7XHJcblxyXG4gICAgICAgIGlmICghdGhpcy5oYXNTaGlwKHJlc3VsdCkpIHJldHVybiByZXN1bHQ7XHJcblxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB3aGlsZSAodGhpcy5oYXNTaGlwKHJlc3VsdCkpIHtcclxuICAgICAgICAgICAgICAgIG51bTEgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA4KTsgXHJcbiAgICAgICAgICAgICAgICBudW0yID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogOCk7IFxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gYCR7bnVtMX0sJHtudW0yfWA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAgIGdldEFkamFjZW50cyAoYm9hcmQsIHNpemUsIGNvb3JkaW5hdGVzKSB7XHJcbiAgICAgICAgbGV0IGFycmF5Qm9hcmQgPSBib2FyZC5ib2FyZEFycmF5KCk7XHJcbiAgICAgICAgbGV0IGFkamFjZW50cyA9IFtbXSxbXV07XHJcbiAgICAgICAgLy8gbGV0IHVwID0gODtcclxuICAgICAgICBsZXQgcmlnaHQgPSAxO1xyXG4gICAgICAgIGxldCBkb3duID0gODtcclxuICAgICAgICAvLyBsZXQgbGVmdCA9IDE7XHJcbiAgICAgICAgbGV0IGluZGV4ID0gMDtcclxuXHJcbiAgICAgICAgLy8gZ2V0IGluZGV4IC8vXHJcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBhcnJheUJvYXJkLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgIGlmIChhcnJheUJvYXJkW2pdLmNvb3JkaW5hdGVzID09PSBjb29yZGluYXRlcykge1xyXG4gICAgICAgICAgICAgICAgaW5kZXggPSBqO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2l6ZTsgaSsrKSB7XHJcbiAgICAgICAgICAgIC8vIDIgYWRqYWNlbnRzIC8vIFxyXG4gICAgICAgICAgICAvLyBpZiAoYXJyYXlCb2FyZFtpbmRleCAtIHVwXSkge1xyXG4gICAgICAgICAgICAvLyAgICAgbGV0IHNwbGl0ID0gY29vcmRpbmF0ZXMuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgLy8gICAgIGxldCBwbGFjZSA9IGFycmF5Qm9hcmRbaW5kZXggLSB1cF0uY29vcmRpbmF0ZXM7XHJcbiAgICAgICAgICAgIC8vICAgICBsZXQgcGxhY2VTcGxpdCA9IHBsYWNlLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgICAgIC8vICAgICBpZiAocGxhY2UgJiYgcGxhY2UuaW5jbHVkZXMoc3BsaXRbMV0pKSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgYWRqYWNlbnRzWzBdLnB1c2goYXJyYXlCb2FyZFtpbmRleCAtIHVwXS5jb29yZGluYXRlcyk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgdXAgKz0gODtcclxuICAgICAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICBpZiAoYXJyYXlCb2FyZFtpbmRleCArIHJpZ2h0XSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHNwbGl0ID0gY29vcmRpbmF0ZXMuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgICAgIGxldCBwbGFjZSA9IGFycmF5Qm9hcmRbaW5kZXggKyByaWdodF0uY29vcmRpbmF0ZXM7XHJcbiAgICAgICAgICAgICAgICBsZXQgcGxhY2VTcGxpdCA9IHBsYWNlLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgICAgICAgICBpZiAocGxhY2UgJiYgcGxhY2VTcGxpdFswXSA9PT0gc3BsaXRbMF0pIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGphY2VudHNbMF0ucHVzaChhcnJheUJvYXJkW2luZGV4ICsgcmlnaHRdLmNvb3JkaW5hdGVzKTtcclxuICAgICAgICAgICAgICAgICAgICByaWdodCsrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChhcnJheUJvYXJkW2luZGV4ICsgZG93bl0pIHtcclxuICAgICAgICAgICAgICAgIGxldCBzcGxpdCA9IGNvb3JkaW5hdGVzLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgICAgICAgICBsZXQgcGxhY2UgPSBhcnJheUJvYXJkW2luZGV4ICsgZG93bl0uY29vcmRpbmF0ZXM7XHJcbiAgICAgICAgICAgICAgICBsZXQgcGxhY2VTcGxpdCA9IHBsYWNlLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgICAgICAgICBpZiAocGxhY2UgJiYgcGxhY2UuaW5jbHVkZXMoc3BsaXRbMV0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRqYWNlbnRzWzFdLnB1c2goYXJyYXlCb2FyZFtpbmRleCArIGRvd25dLmNvb3JkaW5hdGVzKTtcclxuICAgICAgICAgICAgICAgICAgICBkb3duICs9IDg7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gaWYgKGFycmF5Qm9hcmRbaW5kZXggLSBsZWZ0XSkge1xyXG4gICAgICAgICAgICAvLyAgICAgbGV0IHNwbGl0ID0gY29vcmRpbmF0ZXMuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgLy8gICAgIGxldCBwbGFjZSA9IGFycmF5Qm9hcmRbaW5kZXggLSBsZWZ0XS5jb29yZGluYXRlcztcclxuICAgICAgICAgICAgLy8gICAgIGxldCBwbGFjZVNwbGl0ID0gcGxhY2Uuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgLy8gICAgIGlmIChwbGFjZSAmJiBwbGFjZVNwbGl0WzBdID09PSBzcGxpdFswXSkge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIGFkamFjZW50c1szXS5wdXNoKGFycmF5Qm9hcmRbaW5kZXggLSBsZWZ0XS5jb29yZGluYXRlcyk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgbGVmdCsrO1xyXG4gICAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBhZGphY2VudHM7XHJcbiAgICB9XHJcblxyXG4gICAgaGFzQWxsU2hpcHNQbGFjZWQgKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNoaXBzLmxlbmd0aCA9PT0gNTtcclxuICAgIH1cclxuXHJcbiAgICAgIHJlY2VpdmVBdHRhY2sgKGNvb3JkaW5hdGVzKSB7XHJcbiAgICAgICAgbGV0IHN0ciA9IGAke2Nvb3JkaW5hdGVzfWA7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmJvYXJkW3N0cl0uYXR0YWNrZWQgfHwgdGhpcy5ib2FyZFtzdHJdLm1pc3NlZCkgcmV0dXJuO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5ib2FyZFtzdHJdLmhhc1NoaXApIHtcclxuICAgICAgICAgICAgdGhpcy5ib2FyZFtzdHJdLmF0dGFja2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5zaGlwcy5mb3JFYWNoKHNoaXAgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHNoaXAuY29vcmRpbmF0ZXNbMF0uaW5jbHVkZXMoc3RyKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNoaXAucmVnaXN0ZXJIaXQoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2hpcC5pc1N1bmsoKSkgc2hpcC5zdW5rID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYm9hcmRbc3RyXS5taXNzZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZ2V0U2hpcHMgKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNoaXBzO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBhbGxTdW5rICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zaGlwcy5ldmVyeShzaGlwID0+IHNoaXAuc3VuayA9PT0gdHJ1ZSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGJvYXJkQXJyYXkgKCkge1xyXG4gICAgICAgIGNvbnN0IG9iaiA9IHRoaXMuYm9hcmQ7XHJcbiAgICAgICAgY29uc3QgYXJyYXkgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQga2V5IGluIG9iaikge1xyXG4gICAgICAgICAgICBhcnJheS5wdXNoKG9ialtrZXldKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiBhcnJheTtcclxuICAgICAgfVxyXG59XHJcblxyXG4vLyBQbGF5ZXIgQ2xhc3MgLy9cclxuY2xhc3MgUGxheWVyIHtcclxuICAgIGNvbnN0cnVjdG9yIChnYW1lYm9hcmQpIHtcclxuICAgICAgICB0aGlzLmdhbWVib2FyZCA9IGdhbWVib2FyZDtcclxuICAgIH1cclxuXHJcbiAgICBpc01vdmVMZWdhbCAobW92ZSkge1xyXG4gICAgICAgIHJldHVybiAhdGhpcy5nYW1lYm9hcmQuYm9hcmRbbW92ZV0uYXR0YWNrZWQgJiYgIXRoaXMuZ2FtZWJvYXJkLmJvYXJkW21vdmVdLm1pc3NlZDtcclxuICAgIH1cclxuXHJcblxyXG4gICAgbWFrZVJhbmRvbU1vdmUgKCkge1xyXG4gICAgICAgIGxldCBudW0xID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogOCk7IFxyXG4gICAgICAgIGxldCBudW0yID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogOCk7IFxyXG4gICAgICAgIGxldCByZXN1bHQgPSBgJHtudW0xfSwke251bTJ9YDtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuaXNNb3ZlTGVnYWwocmVzdWx0KSkgcmV0dXJuIHJlc3VsdDtcclxuXHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHdoaWxlICghdGhpcy5pc01vdmVMZWdhbChyZXN1bHQpKSB7XHJcbiAgICAgICAgICAgICAgICBudW0xID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogOCk7IFxyXG4gICAgICAgICAgICAgICAgbnVtMiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDgpOyBcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IGAke251bTF9LCR7bnVtMn1gO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtTaGlwLCBHYW1lYm9hcmQsIFBsYXllcn07IiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIERPTSBNYW5pcHVsYXRpb24sIFJlbmRlciB0aGUgR2FtZSAvLyBcclxuXHJcbi8vIFJlbmRlciBXcml0ZSBZb3VyIE5hbWUgLy8gXHJcbmltcG9ydCB7IGdhbWUgfSBmcm9tIFwiLi9nYW1lXCI7XHJcbmltcG9ydCB7IEdhbWVib2FyZCwgUGxheWVyLCBTaGlwIH0gZnJvbSBcIi4vZmFjdG9yaWVzXCI7XHJcblxyXG5mdW5jdGlvbiB3cml0ZU5hbWUgKCkge1xyXG4gICAgY29uc3QgbWFpbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluJyk7XHJcbiAgICBjb25zdCBib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTtcclxuICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcclxuICAgIGNvbnN0IHBsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxyXG5cclxuICAgIGJveC5jbGFzc0xpc3QuYWRkKCdwb3AtdXAtYm94Jyk7XHJcbiAgICB0aXRsZS5jbGFzc0xpc3QuYWRkKCd0aXRsZS1wb3AtdXAnKTtcclxuICAgIGlucHV0LmNsYXNzTGlzdC5hZGQoJ2lucHV0LXBvcC11cCcpO1xyXG4gICAgcGxheS5jbGFzc0xpc3QuYWRkKCdwbGF5LWJ1dHRvbicpO1xyXG5cclxuXHJcbiAgICB0aXRsZS50ZXh0Q29udGVudCA9ICdXcml0ZSB5b3VyIE5hbWUnO1xyXG4gICAgcGxheS5pbm5lckhUTUwgPSAnQmF0dGxlJztcclxuICAgIGlucHV0LnR5cGUgPSAndGV4dCc7XHJcbiAgICBwbGF5LnR5cGUgPSAnc3VibWl0JztcclxuXHJcbiAgICBib3guYXBwZW5kQ2hpbGQodGl0bGUpO1xyXG4gICAgYm94LmFwcGVuZENoaWxkKGlucHV0KTtcclxuICAgIGJveC5hcHBlbmRDaGlsZChwbGF5KTtcclxuXHJcbiAgICBtYWluLmFwcGVuZENoaWxkKGJveCk7XHJcblxyXG4gICAgcGxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICBpZiAoaW5wdXQudmFsdWUpIHtcclxuICAgICAgICAgICAgY2xlYW4oKTtcclxuICAgICAgICAgICAgcmVuZGVyUGxhY2VTaGlwcyhpbnB1dC52YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGFsZXJ0KCdQbGVhc2UgV3JpdGUgWW91ciBOYW1lJyk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIHJlbmRlclBsYWNlU2hpcHMgKG5hbWUpIHtcclxuICAgIGNvbnN0IG1haW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbicpO1xyXG4gICAgY29uc3QgbXlTZWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCBteUdhbWVTZWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCBteUJvYXJkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCBteU5hbWVCb3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IG15TmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XHJcbiAgICBjb25zdCBheGlzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcblxyXG4gICAgY29uc3Qgc2hpcHMgPSBbJ0NhcnJpZXInLCAnQmF0dGxlc2hpcCcsICdDcnVpc2VyJywgJ1N1Ym1hcmluZScsICdEZXN0cm95ZXInXTtcclxuICAgIGxldCBzaXplcyA9IFs0LDMsMiwyLDFdO1xyXG5cclxuICAgIG1haW4uY2xhc3NMaXN0LmFkZCgnbWFpbi1nYW1lJyk7XHJcbiAgICBteVNlY3Rpb24uY2xhc3NMaXN0LmFkZCgnbXktc2VjdGlvbicpO1xyXG4gICAgbXlHYW1lU2VjdGlvbi5jbGFzc0xpc3QuYWRkKCdteS1nYW1lLXNlY3Rpb24nKTtcclxuICAgIG15Qm9hcmQuY2xhc3NMaXN0LmFkZCgnbXktYm9hcmQnKTtcclxuICAgIG15TmFtZUJveC5jbGFzc0xpc3QuYWRkKCdteS1uYW1lLWJveCcpO1xyXG4gICAgbXlOYW1lLmNsYXNzTGlzdC5hZGQoJ215LW5hbWUnKTtcclxuICAgIGF4aXMuY2xhc3NMaXN0LmFkZCgnYXhpcycpO1xyXG5cclxuICAgIGxldCBwb3MgPSAwO1xyXG5cclxuICAgIG15TmFtZS50ZXh0Q29udGVudCA9IGAke25hbWV9LCAgcGxhY2UgeW91ciAgJHtzaGlwc1twb3NdfWA7XHJcbiAgICBteU5hbWUuZGF0YXNldC5zaXplID0gcG9zO1xyXG5cclxuICAgIGF4aXMuaW5uZXJIVE1MID0gJ0F4aXMgWCc7XHJcblxyXG4gICAgYXhpcy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICBpZiAoYXhpcy5pbm5lckhUTUwgPT09ICdBeGlzIFgnKSB7XHJcbiAgICAgICAgICAgIGF4aXMuaW5uZXJIVE1MID0gJ0F4aXMgWSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGF4aXMuaW5uZXJIVE1MID0gJ0F4aXMgWCc7XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICBsZXQgYm9hcmQgPSBuZXcgR2FtZWJvYXJkKCk7XHJcblxyXG4gICAgYm9hcmQuY3JlYXRlQm9hcmQoKTtcclxuICAgXHJcbiAgICBsZXQgcGxheWVyID0gbmV3IFBsYXllcihib2FyZCk7XHJcbiAgICBcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgODsgaSArPSAxKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCA4OyBqICs9IDEpIHtcclxuICAgICAgICAgIGNvbnN0IGNvb3JkaW5hdGUgPSBgJHtpfSwke2p9YDtcclxuICAgICAgICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgZGl2LmNsYXNzTGlzdC5hZGQoJ215LWRpdi1ib3gnKTtcclxuICAgICAgICAgIGRpdi5pZCA9IGAke2Nvb3JkaW5hdGV9YDtcclxuICAgICAgICAgIGlmIChqID09PSA3KSB7XHJcbiAgICAgICAgICAgIGRpdi5kYXRhc2V0LnhOb3RBbGxvd2VkID0gdHJ1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmIChpID09PSA3KSB7XHJcbiAgICAgICAgICAgIGRpdi5kYXRhc2V0LnlOb3RBbGxvd2VkID0gdHJ1ZTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBkaXYuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgdGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubXktbmFtZScpO1xyXG4gICAgICAgICAgICBsZXQgbmFtZSA9IHRpdGxlLnRleHRDb250ZW50O1xyXG4gICAgICAgICAgICBsZXQgc3BsaXQgPSBuYW1lLnNwbGl0KCcgJyk7XHJcbiAgICAgICAgICAgIGxldCBzaGlwID0gc3BsaXRbc3BsaXQubGVuZ3RoIC0xXTtcclxuICAgICAgICAgICAgbGV0IGluZGV4ID0gc2hpcHMuaW5kZXhPZihzaGlwKTtcclxuICAgICAgICAgICAgbGV0IHNpemUgPSBzaXplc1tpbmRleF07XHJcbiAgICAgICAgICAgIGxldCBheGlzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmF4aXMnKTtcclxuICAgICAgICAgICAgbGV0IGF4aXNUZXh0ID0gYXhpcy50ZXh0Q29udGVudC5zcGxpdCgnICcpWzFdO1xyXG5cclxuICAgICAgICAgICAgbGV0IGFkamFjZW50cyA9IGJvYXJkLmdldEFkamFjZW50cyhib2FyZCwgc2l6ZSwgZGl2LmlkKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChheGlzVGV4dCA9PT0gJ1gnKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBCTEFDSyAvL1xyXG4gICAgICAgICAgICAgICAgbGV0IGFkaldpdGhTaGlwID0gYWRqYWNlbnRzWzBdLnNvbWUoeCA9PiBib2FyZC5oYXNTaGlwKHgpKTtcclxuICAgICAgICAgICAgICAgIGlmICghZGl2LmRhdGFzZXQueE5vdEFsbG93ZWQgfHwgIWFkaldpdGhTaGlwICB8fCAhYWRqYWNlbnRzWzBdLmxlbmd0aCA8IHNpemUpIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGphY2VudHNbMF0uZm9yRWFjaChwb3NpdGlvbiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB1YmkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5iYWNrZ3JvdW5kID0gJ2JsYWNrJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgdWJpLnN0eWxlLmJhY2tncm91bmQgPSAnYmxhY2snO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuY3Vyc29yID0gJ2Nyb3NzaGFpcic7IFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBSRUQgLy9cclxuICAgICAgICAgICAgICAgIGlmIChib2FyZC5oYXNTaGlwKGRpdi5pZCkgfHwgZGl2LmRhdGFzZXQueE5vdEFsbG93ZWQgfHwgYWRqV2l0aFNoaXAgIHx8IGFkamFjZW50c1swXS5sZW5ndGggPCBzaXplKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRpdi5kYXRhc2V0LnhOb3RBbGxvd2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5iYWNrZ3JvdW5kID0gJ3JlZCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5jdXJzb3IgPSAnbm90LWFsbG93ZWQnO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWRqYWNlbnRzWzBdLmZvckVhY2gocG9zaXRpb24gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHViaSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5iYWNrZ3JvdW5kID0gJ3JlZCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1Ymkuc3R5bGUuYmFja2dyb3VuZCA9ICdyZWQnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmN1cnNvciA9ICdub3QtYWxsb3dlZCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTsgICBcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGlmIChheGlzVGV4dCA9PT0gJ1knKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBCTEFDSyAvL1xyXG4gICAgICAgICAgICAgICAgbGV0IGFkaldpdGhTaGlwID0gYWRqYWNlbnRzWzFdLnNvbWUoeCA9PiBib2FyZC5oYXNTaGlwKHgpKTtcclxuICAgICAgICAgICAgICAgIGlmICghZGl2LmRhdGFzZXQueU5vdEFsbG93ZWQgfHwgIWFkaldpdGhTaGlwICB8fCAhYWRqYWNlbnRzWzFdLmxlbmd0aCA8IHNpemUpIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGphY2VudHNbMV0uZm9yRWFjaChwb3NpdGlvbiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB1YmkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5iYWNrZ3JvdW5kID0gJ2JsYWNrJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgdWJpLnN0eWxlLmJhY2tncm91bmQgPSAnYmxhY2snO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuY3Vyc29yID0gJ2Nyb3NzaGFpcic7IFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgIC8vIFJFRCAvL1xyXG4gICAgICAgICAgICAgICBpZiAoYm9hcmQuaGFzU2hpcChkaXYuaWQpIHx8IGRpdi5kYXRhc2V0LnlOb3RBbGxvd2VkIHx8IGFkaldpdGhTaGlwICB8fCBhZGphY2VudHNbMV0ubGVuZ3RoIDwgc2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRpdi5kYXRhc2V0LnlOb3RBbGxvd2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmJhY2tncm91bmQgPSAncmVkJztcclxuICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuY3Vyc29yID0gJ25vdC1hbGxvd2VkJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGFkamFjZW50c1sxXS5mb3JFYWNoKHBvc2l0aW9uID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHViaSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmJhY2tncm91bmQgPSAncmVkJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgdWJpLnN0eWxlLmJhY2tncm91bmQgPSAncmVkJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmN1cnNvciA9ICdub3QtYWxsb3dlZCc7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTsgIFxyXG4gICAgICAgICAgICB9OyBcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIGRpdi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgdGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubXktbmFtZScpO1xyXG4gICAgICAgICAgICBsZXQgbmFtZSA9IHRpdGxlLnRleHRDb250ZW50O1xyXG4gICAgICAgICAgICBsZXQgc3BsaXQgPSBuYW1lLnNwbGl0KCcgJyk7XHJcbiAgICAgICAgICAgIGxldCBzaGlwID0gc3BsaXRbc3BsaXQubGVuZ3RoIC0xXTtcclxuICAgICAgICAgICAgbGV0IGluZGV4ID0gc2hpcHMuaW5kZXhPZihzaGlwKTtcclxuICAgICAgICAgICAgbGV0IHNpemUgPSBzaXplc1tpbmRleF07XHJcbiAgICAgICAgICAgIGxldCBheGlzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmF4aXMnKTtcclxuICAgICAgICAgICAgbGV0IGF4aXNUZXh0ID0gYXhpcy50ZXh0Q29udGVudC5zcGxpdCgnICcpWzFdO1xyXG5cclxuICAgICAgICAgICAgbGV0IGFkamFjZW50cyA9IGJvYXJkLmdldEFkamFjZW50cyhib2FyZCwgc2l6ZSwgZGl2LmlkKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChheGlzVGV4dCA9PT0gJ1gnKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGl2LmRhdGFzZXQueE5vdEFsbG93ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuYmFja2dyb3VuZCA9ICdsaWdodGdvbGRlbnJvZHllbGxvdyc7XHJcbiAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmN1cnNvciA9ICdjcm9zc2hhaXInOyBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGFkamFjZW50c1swXS5mb3JFYWNoKHBvc2l0aW9uID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgdWJpID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5iYWNrZ3JvdW5kID0gJ2xpZ2h0Z29sZGVucm9keWVsbG93JztcclxuICAgICAgICAgICAgICAgICAgICB1Ymkuc3R5bGUuYmFja2dyb3VuZCA9ICdsaWdodGdvbGRlbnJvZHllbGxvdyc7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChib2FyZC5oYXNTaGlwKHViaS5pZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmJhY2tncm91bmQgPSAnZ3JlZW4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1Ymkuc3R5bGUuYmFja2dyb3VuZCA9ICdncmVlbic7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBpZiAoYXhpc1RleHQgPT09ICdZJykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRpdi5kYXRhc2V0LnlOb3RBbGxvd2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmJhY2tncm91bmQgPSAnbGlnaHRnb2xkZW5yb2R5ZWxsb3cnO1xyXG4gICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5jdXJzb3IgPSAnY3Jvc3NoYWlyJzsgXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBhZGphY2VudHNbMV0uZm9yRWFjaChwb3NpdGlvbiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB1YmkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5iYWNrZ3JvdW5kID0gJ2xpZ2h0Z29sZGVucm9keWVsbG93JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgdWJpLnN0eWxlLmJhY2tncm91bmQgPSAnbGlnaHRnb2xkZW5yb2R5ZWxsb3cnO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIC8vIGFkamFjZW50cyBjYW5jZWwgaG92ZXIgLy9cclxuICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgZGl2LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBsZXQgdGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubXktbmFtZScpO1xyXG4gICAgICAgICAgICAvLyBsZXQgbmFtZSA9IHRpdGxlLnRleHRDb250ZW50O1xyXG4gICAgICAgICAgICAvLyBsZXQgc3BsaXQgPSBuYW1lLnNwbGl0KCcgJyk7XHJcbiAgICAgICAgICAgIC8vIGxldCBzaGlwID0gc3BsaXRbc3BsaXQubGVuZ3RoIC0xXTtcclxuICAgICAgICAgICAgLy8gbGV0IGluZGV4ID0gc2hpcHMuaW5kZXhPZihzaGlwKTtcclxuICAgICAgICAgICAgLy8gbGV0IHNpemUgPSBzaXplc1tpbmRleF07XHJcbiAgICAgICAgICAgIC8vIGxldCBheGlzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmF4aXMnKTtcclxuICAgICAgICAgICAgLy8gbGV0IGF4aXNUZXh0ID0gYXhpcy50ZXh0Q29udGVudC5zcGxpdCgnICcpWzFdO1xyXG5cclxuICAgICAgICAgICAgLy8gbGV0IGFkamFjZW50cyA9IGJvYXJkLmdldEFkamFjZW50cyhib2FyZCwgc2l6ZSwgZGl2LmlkKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGlmIChheGlzVGV4dCA9PT0gJ1gnKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBsZXQgcGxhY2VkID0gYm9hcmQucGxhY2VTaGlwKHNpemUsIGFkamFjZW50c1swXSk7XHJcbiAgICAgICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgICAgIC8vIGlmIChheGlzVGV4dCA9PT0gJ1knKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBsZXQgcGxhY2VkID0gYm9hcmQucGxhY2VTaGlwKHNpemUsIGFkamFjZW50c1thXSk7XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIHJlbmRlck15Qm9hcmQoYm9hcmQpO1xyXG4gICAgICAgICAgICAvLyBpZiAocGxhY2Ugc2hpcCBpcyB0aG9zZSBjb29yZGluYXRlcyA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgcG9zICs9IDE7XHJcbiAgICAgICAgICAgICAgICBpZiAocG9zID09PSBzaGlwcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xlYW4oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVySW5pdGFsQm9hcmRzKG5hbWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbXlOYW1lLnRleHRDb250ZW50ID0gYCR7bmFtZX0sICBwbGFjZSB5b3VyICAke3NoaXBzW3Bvc119YDtcclxuICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy9yZW5kZXIgYm9hcmQgLy8gXHJcbiAgICAgICAgICAgIC8vIHJlbmRlciB0ZXh0IHdpdGggbmFtZSBvZiBzaGlwIC8vIFxyXG4gICAgICAgICAgICAvLyBjaGVjayBpZiBoYXNBbGxTaGlwc1BsYWNlZCAvLyBcclxuICAgICAgICAgICAgLy8gaWYgc28sIHJlbmRlciBpbml0aWFsIGJvYXJkcyB0byBwbGF5IC8vIFxyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIG15Qm9hcmQuYXBwZW5kQ2hpbGQoZGl2KTtcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIFxyXG5cclxuICAgIG15TmFtZUJveC5hcHBlbmRDaGlsZChteU5hbWUpO1xyXG4gICAgbXlOYW1lQm94LmFwcGVuZENoaWxkKGF4aXMpO1xyXG4gICAgbXlHYW1lU2VjdGlvbi5hcHBlbmRDaGlsZChteUJvYXJkKTtcclxuICAgIG15U2VjdGlvbi5hcHBlbmRDaGlsZChteU5hbWVCb3gpO1xyXG4gICAgbXlTZWN0aW9uLmFwcGVuZENoaWxkKG15R2FtZVNlY3Rpb24pO1xyXG4gICAgXHJcbiAgICBib2FyZC5wbGFjZVNoaXAoMywgWycwLDEnLCAnMCwyJywgJzAsMyddKTtcclxuICAgIG1haW4uYXBwZW5kQ2hpbGQobXlTZWN0aW9uKTtcclxuICAgIHJlbmRlck15Qm9hcmQoYm9hcmQpO1xyXG5cclxuICAgIC8vIElGIEFOWSBPRiBBREpBQ0VOVFMgSEFTIFNISVAgTUFSS0VEIFdJVEggUkVEIEFORCBDUk9TUyAvLyBcclxuICAgIFxyXG5cclxufVxyXG5cclxuZnVuY3Rpb24gcmVuZGVySW5pdGFsQm9hcmRzIChuYW1lKSB7XHJcbiAgICBjb25zdCBtYWluID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW4nKTtcclxuXHJcbiAgICBjb25zdCBteVNlY3Rpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IG15R2FtZVNlY3Rpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IG15Qm9hcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IG15TmFtZUJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgbXlOYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTtcclxuICAgICAgICBcclxuICAgIGNvbnN0IGVuZW15U2VjdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgZW5lbXlHYW1lU2VjdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgZW5lbXlCb2FyZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgZW5lbXlOYW1lQm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCBlbmVteU5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpO1xyXG5cclxuICAgIFxyXG4gICAgbXlTZWN0aW9uLmNsYXNzTGlzdC5hZGQoJ215LXNlY3Rpb24nKTtcclxuICAgIG15R2FtZVNlY3Rpb24uY2xhc3NMaXN0LmFkZCgnbXktZ2FtZS1zZWN0aW9uJyk7XHJcbiAgICBteUJvYXJkLmNsYXNzTGlzdC5hZGQoJ215LWJvYXJkJyk7XHJcbiAgICBteU5hbWVCb3guY2xhc3NMaXN0LmFkZCgnbXktbmFtZS1ib3gnKTtcclxuICAgIG15TmFtZS5jbGFzc0xpc3QuYWRkKCdteS1uYW1lJyk7XHJcbiAgICBcclxuICAgIGVuZW15U2VjdGlvbi5jbGFzc0xpc3QuYWRkKCdlbmVteS1zZWN0aW9uJyk7XHJcbiAgICBlbmVteUdhbWVTZWN0aW9uLmNsYXNzTGlzdC5hZGQoJ2VuZW15LWdhbWUtc2VjdGlvbicpO1xyXG4gICAgZW5lbXlCb2FyZC5jbGFzc0xpc3QuYWRkKCdlbmVteS1ib2FyZCcpO1xyXG4gICAgZW5lbXlOYW1lQm94LmNsYXNzTGlzdC5hZGQoJ2VuZW15LW5hbWUtYm94Jyk7XHJcbiAgICBlbmVteU5hbWUuY2xhc3NMaXN0LmFkZCgnZW5lbXktbmFtZScpO1xyXG5cclxuXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDg7IGkgKz0gMSkge1xyXG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgODsgaiArPSAxKSB7XHJcbiAgICAgICAgICBjb25zdCBjb29yZGluYXRlID0gYCR7aX0sJHtqfWA7XHJcbiAgICAgICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgIGNvbnN0IGRpdkVuZW15ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICBkaXYuY2xhc3NMaXN0LmFkZCgnbXktZGl2LWJveCcpO1xyXG4gICAgICAgICAgZGl2RW5lbXkuY2xhc3NMaXN0LmFkZCgnZW5lbXktZGl2LWJveCcpO1xyXG5cclxuICAgICAgICAgIGRpdi5pZCA9IGBQICR7Y29vcmRpbmF0ZX1gO1xyXG4gICAgICAgICAgZGl2RW5lbXkuaWQgPSBgRSAke2Nvb3JkaW5hdGV9YDtcclxuICBcclxuICAgICAgICAgIG15Qm9hcmQuYXBwZW5kQ2hpbGQoZGl2KTtcclxuICAgICAgICAgIGVuZW15Qm9hcmQuYXBwZW5kQ2hpbGQoZGl2RW5lbXkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBteU5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgZW5lbXlOYW1lLnRleHRDb250ZW50ID0gJ0VuZW15JztcclxuXHJcbiAgICBteU5hbWVCb3guYXBwZW5kQ2hpbGQobXlOYW1lKTtcclxuICAgIG15R2FtZVNlY3Rpb24uYXBwZW5kQ2hpbGQobXlCb2FyZCk7XHJcbiAgICBteVNlY3Rpb24uYXBwZW5kQ2hpbGQobXlOYW1lQm94KTtcclxuICAgIG15U2VjdGlvbi5hcHBlbmRDaGlsZChteUdhbWVTZWN0aW9uKTtcclxuICAgIFxyXG4gICAgZW5lbXlOYW1lQm94LmFwcGVuZENoaWxkKGVuZW15TmFtZSk7XHJcbiAgICBlbmVteUdhbWVTZWN0aW9uLmFwcGVuZENoaWxkKGVuZW15Qm9hcmQpO1xyXG4gICAgZW5lbXlTZWN0aW9uLmFwcGVuZENoaWxkKGVuZW15TmFtZUJveCk7XHJcbiAgICBlbmVteVNlY3Rpb24uYXBwZW5kQ2hpbGQoZW5lbXlHYW1lU2VjdGlvbik7XHJcblxyXG4gICAgbWFpbi5hcHBlbmRDaGlsZChteVNlY3Rpb24pO1xyXG4gICAgbWFpbi5hcHBlbmRDaGlsZChlbmVteVNlY3Rpb24pO1xyXG5cclxuICAgIG1haW4uY2xhc3NMaXN0LmFkZCgnbWFpbi1nYW1lJyk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbmRlck15Qm9hcmQgKGJvYXJkKSB7XHJcbiAgICBjb25zdCBib3hlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5teS1kaXYtYm94Jyk7XHJcbiAgICBib3hlcy5mb3JFYWNoKGJveCA9PiB7XHJcbiAgICAgICBsZXQgY29vcmRpbmF0ZXMgPSBib3guaWQ7XHJcbiAgICAgICAgaWYgKGJvYXJkLmJvYXJkW2Nvb3JkaW5hdGVzXS5oYXNTaGlwKSB7XHJcbiAgICAgICAgICAgIGJveC5zdHlsZS5iYWNrZ3JvdW5kID0gJ2dyZWVuJztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGJvYXJkLmJvYXJkW2Nvb3JkaW5hdGVzXS5hdHRhY2tlZCkge1xyXG4gICAgICAgICAgICBib3guaW5uZXJIVE1MID0gJ+KdjCc7XHJcbiAgICAgICAgICAgIGJveC5zdHlsZS5iYWNrZ3JvdW5kID0gJyNGNUMyQzEnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYm9hcmQuYm9hcmRbY29vcmRpbmF0ZXNdLm1pc3NlZCkge1xyXG4gICAgICAgICAgICBib3guaW5uZXJIVE1MID0gJ/CfkqYnO1xyXG4gICAgICAgICAgICBib3guc3R5bGUuYmFja2dyb3VuZCA9ICdsaWdodGJsdWUnO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBlbHNlIGlmICghYm9hcmQuYm9hcmRbY29vcmRpbmF0ZXNdLm1pc3NlZCAmJiAhYm9hcmQuYm9hcmRbY29vcmRpbmF0ZXNdLmF0dGFja2VkICYmIGJvYXJkLmJvYXJkW2Nvb3JkaW5hdGVzXS5oYXNTaGlwKSB7XHJcbiAgICAgICAgLy8gICAgIGJveC5zdHlsZS5iYWNrZ3JvdW5kID0gJ2xpZ2h0Z29sZGVucm9keWVsbG93JztcclxuICAgICAgICAvLyB9XHJcbiAgICB9KTtcclxufTtcclxuXHJcblxyXG5mdW5jdGlvbiByZW5kZXJFbmVteUJvYXJkIChib2FyZCkge1xyXG4gICAgY29uc3QgYm94ZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZW5lbXktZGl2LWJveCcpO1xyXG5cclxuICAgIGZvciAoY29uc3QgYm94IG9mIGJveGVzKSB7XHJcbiAgICAgICAgbGV0IGNvb3JkaW5hdGVzID0gYm94LmlkO1xyXG4gICAgICAgIGxldCBzcGxpdCA9IGNvb3JkaW5hdGVzLnNwbGl0KCcgJyk7XHJcbiAgICAgICAgbGV0IG51bSA9IHNwbGl0WzFdOyBcclxuICAgICAgICBcclxuICAgICAgICBpZiAoYm9hcmQuYm9hcmRbbnVtXS5oYXNTaGlwKSB7XHJcbiAgICAgICAgICAgIGJveC5zdHlsZS5iYWNrZ3JvdW5kID0gJ29yYW5nZSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChib2FyZC5ib2FyZFtudW1dLmF0dGFja2VkKSB7XHJcbiAgICAgICAgICAgIGJveC5pbm5lckhUTUwgPSAn4p2MJztcclxuICAgICAgICAgICAgYm94LnN0eWxlLmJhY2tncm91bmQgPSAnI0Y1QzJDMSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChib2FyZC5ib2FyZFtudW1dLm1pc3NlZCkge1xyXG4gICAgICAgICAgICBib3guaW5uZXJIVE1MID0gJ/CfkqYnO1xyXG4gICAgICAgICAgICBib3guc3R5bGUuYmFja2dyb3VuZCA9ICdsaWdodGJsdWUnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYm9hcmQuYm9hcmRbbnVtXS5oYXNTaGlwKSB7XHJcbiAgICAgICAgICAgIGJveC5pbm5lckhUTUwgPSAn8J+aoic7XHJcbiAgICAgICAgICAgIGJveC5zdHlsZS5iYWNrZ3JvdW5kID0gJ2xpZ2h0Ymx1ZSc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5cclxuXHJcblxyXG5cclxuZnVuY3Rpb24gcmVuZGVyV2luICgpIHtcclxuICAgIGNvbnN0IG1haW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbicpO1xyXG4gICAgY29uc3QgYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7IFxyXG4gICAgY29uc3QgcGxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpXHJcblxyXG4gICAgYm94LmNsYXNzTGlzdC5hZGQoJ3BvcC11cC1ib3gnKTtcclxuICAgIHRpdGxlLmNsYXNzTGlzdC5hZGQoJ3RpdGxlLXBvcC11cCcpO1xyXG4gICAgcGxheS5jbGFzc0xpc3QuYWRkKCdwbGF5LWJ1dHRvbicpO1xyXG5cclxuICAgIHRpdGxlLnRleHRDb250ZW50ID0gJ1lvdSBXaW4nO1xyXG4gICAgcGxheS5pbm5lckhUTUwgPSAnUGxheSBBZ2Fpbic7XHJcbiAgICBwbGF5LnR5cGUgPSAnc3VibWl0JztcclxuXHJcbiAgICBib3guYXBwZW5kQ2hpbGQodGl0bGUpO1xyXG4gICAgYm94LmFwcGVuZENoaWxkKHBsYXkpO1xyXG5cclxuICAgIG1haW4uYXBwZW5kQ2hpbGQoYm94KTtcclxuXHJcbiAgICBwbGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgIGNsZWFuKCk7XHJcbiAgICAgICAgd3JpdGVOYW1lKCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVuZGVyTG9zZSAoKSB7XHJcbiAgICBjb25zdCBtYWluID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW4nKTtcclxuICAgIGNvbnN0IGJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpOyBcclxuICAgIGNvbnN0IHBsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxyXG5cclxuICAgIGJveC5jbGFzc0xpc3QuYWRkKCdwb3AtdXAtYm94Jyk7XHJcbiAgICB0aXRsZS5jbGFzc0xpc3QuYWRkKCd0aXRsZS1wb3AtdXAnKTtcclxuICAgIHBsYXkuY2xhc3NMaXN0LmFkZCgncGxheS1idXR0b24nKTtcclxuXHJcbiAgICB0aXRsZS50ZXh0Q29udGVudCA9ICdZb3UgTG9zZSc7XHJcbiAgICBwbGF5LmlubmVySFRNTCA9ICdQbGF5IEFnYWluJztcclxuICAgIHBsYXkudHlwZSA9ICdzdWJtaXQnO1xyXG5cclxuICAgIGJveC5hcHBlbmRDaGlsZCh0aXRsZSk7XHJcbiAgICBib3guYXBwZW5kQ2hpbGQocGxheSk7XHJcblxyXG4gICAgbWFpbi5hcHBlbmRDaGlsZChib3gpO1xyXG5cclxuICAgIHBsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgY2xlYW4oKTtcclxuICAgICAgICB3cml0ZU5hbWUoKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjbGVhbiAoKSB7XHJcbiAgICBjb25zdCBtYWluID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW4nKTtcclxuICAgIG1haW4uaW5uZXJIVE1MID0gJyc7XHJcbn1cclxuXHJcblxyXG5leHBvcnQge3dyaXRlTmFtZSwgY2xlYW4sIHJlbmRlckluaXRhbEJvYXJkcywgcmVuZGVyTXlCb2FyZCwgcmVuZGVyRW5lbXlCb2FyZCwgcmVuZGVyV2luLCByZW5kZXJMb3NlfTtcclxuIiwiLy8gTGludGVyLCBQcmV0dGllciwgSmVzdC5jb25maWcgLy8gXHJcblxyXG5pbXBvcnQgeyBTaGlwLCBHYW1lYm9hcmQsIFBsYXllciB9IGZyb20gXCIuL2ZhY3Rvcmllc1wiO1xyXG5pbXBvcnQgeyB3cml0ZU5hbWUsIGNsZWFuLCByZW5kZXJJbml0YWxCb2FyZHMsIHJlbmRlcldpbiwgcmVuZGVyTG9zZSwgc2VsZWN0U2hpcHMgfSBmcm9tIFwiLi9yZW5kZXJcIjtcclxuaW1wb3J0IHsgZ2FtZSB9IGZyb20gXCIuL2dhbWVcIjtcclxuXHJcbndyaXRlTmFtZSgpOyJdLCJuYW1lcyI6WyJTaGlwIiwiY29uc3RydWN0b3IiLCJzaXplIiwidGhpcyIsImhpdCIsInN1bmsiLCJjb29yZGluYXRlcyIsInJlZ2lzdGVySGl0IiwiaXNTdW5rIiwiYWRkQ29vcmRpbmF0ZXMiLCJwb3NpdGlvbiIsInB1c2giLCJtb2R1bGUiLCJleHBvcnRzIiwiR2FtZWJvYXJkIiwiYm9hcmQiLCJzaGlwcyIsImNyZWF0ZUJvYXJkIiwiaSIsImoiLCJjb29yZGluYXRlIiwiYXR0YWNrZWQiLCJtaXNzZWQiLCJoYXNTaGlwIiwic2hpcCIsImlzVmFsaWQiLCJhcnIiLCJzcGxpdCIsImEiLCJOdW1iZXIiLCJiIiwiZ2V0Qm9hcmQiLCJhZGRTaGlwIiwicGxhY2VTaGlwIiwibGVuZ3RoIiwiaXNNb3ZlTGVnYWwiLCJtb3ZlIiwicGxhY2VFbmVteVNoaXBzIiwiY29vcmRpbmF0ZUNhcnJpZXIiLCJjcmVhdGVDb29yZGluYXRlcyIsImNvb3JkaW5hdGVCYXR0bGVzaGlwIiwiY29vcmRpbmF0ZUNydWlzZXIiLCJjb29yZGluYXRlU3VibWFyaW5lIiwiY29vcmRpbmF0ZURlc3Ryb3llciIsImFycmF5IiwiYm9hcmRBcnJheSIsImdldEFkamFjZW50cyIsInNpemVzIiwiZmlsdGVyZWQiLCJ0ZW1wIiwiZmlsdGVyIiwicG9zIiwiZm9yRWFjaCIsInNldE9mQ29vcmRpbmF0ZXMiLCJudW0xIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwibnVtMiIsInJlc3VsdCIsImFycmF5Qm9hcmQiLCJhZGphY2VudHMiLCJyaWdodCIsImRvd24iLCJpbmRleCIsInBsYWNlIiwicGxhY2VTcGxpdCIsImluY2x1ZGVzIiwiaGFzQWxsU2hpcHNQbGFjZWQiLCJyZWNlaXZlQXR0YWNrIiwic3RyIiwiZ2V0U2hpcHMiLCJhbGxTdW5rIiwiZXZlcnkiLCJvYmoiLCJrZXkiLCJQbGF5ZXIiLCJnYW1lYm9hcmQiLCJtYWtlUmFuZG9tTW92ZSIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsInVuZGVmaW5lZCIsIl9fd2VicGFja19tb2R1bGVzX18iLCJuYW1lIiwibWFpbiIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJteVNlY3Rpb24iLCJjcmVhdGVFbGVtZW50IiwibXlHYW1lU2VjdGlvbiIsIm15Qm9hcmQiLCJteU5hbWVCb3giLCJteU5hbWUiLCJlbmVteVNlY3Rpb24iLCJlbmVteUdhbWVTZWN0aW9uIiwiZW5lbXlCb2FyZCIsImVuZW15TmFtZUJveCIsImVuZW15TmFtZSIsImNsYXNzTGlzdCIsImFkZCIsImRpdiIsImRpdkVuZW15IiwiaWQiLCJhcHBlbmRDaGlsZCIsInRleHRDb250ZW50IiwiY2xlYW4iLCJpbm5lckhUTUwiLCJib3giLCJ0aXRsZSIsImlucHV0IiwicGxheSIsInR5cGUiLCJhZGRFdmVudExpc3RlbmVyIiwidmFsdWUiLCJheGlzIiwiZGF0YXNldCIsInhOb3RBbGxvd2VkIiwieU5vdEFsbG93ZWQiLCJxdWVyeVNlbGVjdG9yIiwiaW5kZXhPZiIsImF4aXNUZXh0IiwiYWRqV2l0aFNoaXAiLCJzb21lIiwieCIsInViaSIsInN0eWxlIiwiYmFja2dyb3VuZCIsImN1cnNvciIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJyZW5kZXJQbGFjZVNoaXBzIiwiYWxlcnQiLCJ3cml0ZU5hbWUiXSwic291cmNlUm9vdCI6IiJ9