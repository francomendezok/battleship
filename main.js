(()=>{var e={776:e=>{class t{constructor(e){this.size=e,this.hit=0,this.sunk=!1,this.coordinates=[]}registerHit(){return this.hit+=1}isSunk(){return this.hit===this.size}addCoordinates(e){this.coordinates.push(e)}}e.exports={Ship:t,Gameboard:class{constructor(){this.board=[],this.ships=[]}createBoard(e=8){for(let t=0;t<e;t+=1)for(let a=0;a<e;a+=1){const e=`${t},${a}`;this.board[e]={coordinates:e,attacked:!1,missed:!1,hasShip:!1,ship:[]}}return this.board}isValid(e){let t=e.split(","),a=Number(t[0]),d=Number(t[1]);return a>=0&&a<=7&&d>=0&&d<=7}getBoard(){return this.board}addShip(e){this.ships.push(e)}placeShip(e,a){if(e!==a.length)return!1;const d=new t(e);for(let e=0;e<a.length;e++){if(this.hasShip(a[e]))return!1;this.board[a[e]].ship.push(a),this.board[a[e]].hasShip=!0}return d.addCoordinates(a),this.addShip(d),!0}isMoveLegal(e){return!this.board[e].attacked&&!this.board[e].missed}hasShip(e){return this.board[e].hasShip}placeEnemyShips(){let e=this.createCoordinates(),t=this.createCoordinates(),a=this.createCoordinates(),d=this.createCoordinates(),s=this.createCoordinates(),n=this.boardArray(),o=[this.getAdjacents(n,5,e),this.getAdjacents(n,4,t),this.getAdjacents(n,3,a),this.getAdjacents(n,3,d),this.getAdjacents(n,2,s)],i=[5,4,3,3,2],r=[];for(let e=0;e<o.length;e++){let t=o[e].filter((t=>t.length===i[e]));r.push(t)}r.forEach((e=>{this.placeShip(e[0].length,e[0])}))}createCoordinates(){let e=Math.floor(8*Math.random()),t=Math.floor(8*Math.random()),a=`${e},${t}`;if(this.hasShip(a)){for(;this.hasShip(a);)e=Math.floor(8*Math.random()),t=Math.floor(8*Math.random()),a=`${e},${t}`;return a}return a}getAdjacents(e,t,a){let d=e.boardArray(),s=[[],[]],n=1,o=8,i=0;for(let e=0;e<d.length;e++)if(d[e].coordinates===a){i=e;break}for(let e=0;e<t;e++){if(d[i+n]){let e=a.split(","),t=d[i+n].coordinates,o=t.split(",");t&&o[0]===e[0]&&(s[0].push(d[i+n].coordinates),n++)}if(d[i+o]){let e=a.split(","),t=d[i+o].coordinates;t.split(","),t&&t.includes(e[1])&&(s[1].push(d[i+o].coordinates),o+=8)}}return s}hasAllShipsPlaced(){return 5===this.ships.length}receiveAttack(e){let t=`${e}`;if(!this.board[t].attacked&&!this.board[t].missed)return this.board[t].hasShip?(this.board[t].attacked=!0,this.ships.forEach((e=>{e.coordinates[0].includes(t)&&(e.registerHit(),e.isSunk()&&(e.sunk=!0))}))):this.board[t].missed=!0,!0}getShips(){return this.ships}allSunk(){return this.ships.every((e=>!0===e.sunk))}boardArray(){const e=this.board,t=[];for(let a in e)t.push(e[a]);return t}},Player:class{constructor(e){this.gameboard=e}isMoveLegal(e){return!this.gameboard.board[e].attacked&&!this.gameboard.board[e].missed}makeRandomMove(){let e=Math.floor(8*Math.random()),t=Math.floor(8*Math.random()),a=`${e},${t}`;if(this.isMoveLegal(a))return a;for(;!this.isMoveLegal(a);)e=Math.floor(8*Math.random()),t=Math.floor(8*Math.random()),a=`${e},${t}`;return a}}}}},t={};function a(d){var s=t[d];if(void 0!==s)return s.exports;var n=t[d]={exports:{}};return e[d](n,n.exports,a),n.exports}(()=>{"use strict";var e=a(776);function t(e){const t=document.getElementById("main"),a=document.createElement("div"),d=document.createElement("div"),s=document.createElement("div"),n=document.createElement("div"),o=document.createElement("h3"),i=document.createElement("div"),r=document.createElement("div"),l=document.createElement("div"),c=document.createElement("div"),h=document.createElement("h3");a.classList.add("my-section"),d.classList.add("my-game-section"),s.classList.add("my-board"),n.classList.add("my-name-box"),o.classList.add("my-name"),i.classList.add("enemy-section"),r.classList.add("enemy-game-section"),l.classList.add("enemy-board"),c.classList.add("enemy-name-box"),h.classList.add("enemy-name");for(let e=0;e<8;e+=1)for(let t=0;t<8;t+=1){const a=`${e},${t}`,d=document.createElement("div"),n=document.createElement("div");d.classList.add("my-div-box"),n.classList.add("enemy-div-box"),d.id=`P ${a}`,n.id=`E ${a}`,s.appendChild(d),l.appendChild(n)}o.textContent=e,h.textContent="Enemy",n.appendChild(o),d.appendChild(s),a.appendChild(n),a.appendChild(d),c.appendChild(h),r.appendChild(l),i.appendChild(c),i.appendChild(r),t.appendChild(a),t.appendChild(i),t.classList.add("main-game")}function d(e){let t=e.boardArray();for(let e=0;e<t.length;e++){if(t[e].hasShip&&(document.getElementById(t[e].coordinates).style.background="green"),t[e].attacked){let a=document.getElementById(t[e].coordinates);a.innerHTML="❌",a.style.background="#F5C2C1"}if(t[e].missed){let a=document.getElementById(t[e].coordinates);a.innerHTML="💦",a.style.background="lightblue"}t[e].hasShip||t[e].attacked||t[e].missed||(document.getElementById(t[e].coordinates).style.background="lightgoldenrodyellow")}}function s(){document.getElementById("main").innerHTML=""}!function(){const a=document.getElementById("main"),n=document.createElement("div"),o=document.createElement("h3"),i=document.createElement("input"),r=document.createElement("button");n.classList.add("pop-up-box"),o.classList.add("title-pop-up"),i.classList.add("input-pop-up"),r.classList.add("play-button"),o.textContent="Write your Name",r.innerHTML="Battle",i.type="text",r.type="submit",n.appendChild(o),n.appendChild(i),n.appendChild(r),a.appendChild(n),r.addEventListener("click",(()=>{i.value?(s(),function(a){const n=document.getElementById("main"),o=document.createElement("div"),i=document.createElement("div"),r=document.createElement("div"),l=document.createElement("div"),c=document.createElement("h3"),h=document.createElement("button"),m=["Carrier","Battleship","Cruiser","Submarine","Destroyer"];let u=[4,3,2,2,1];n.classList.add("main-game"),o.classList.add("my-section"),i.classList.add("my-game-section"),r.classList.add("my-board"),l.classList.add("my-name-box"),c.classList.add("my-name"),h.classList.add("axis");let p=0;c.textContent=`${a},  place your  ${m[p]}`,c.dataset.size=p,h.innerHTML="Axis X",h.addEventListener("click",(()=>{"Axis X"===h.innerHTML?h.innerHTML="Axis Y":h.innerHTML="Axis X"}));let y=new e.Gameboard;y.createBoard(),new e.Player(y);for(let e=0;e<8;e+=1)for(let n=0;n<8;n+=1){const o=`${e},${n}`,i=document.createElement("div");i.classList.add("my-div-box"),i.id=`${o}`,7===n&&(i.dataset.xNotAllowed=!0),7===e&&(i.dataset.yNotAllowed=!0),i.addEventListener("mouseover",(()=>{let e=document.querySelector(".my-name").textContent.split(" "),t=e[e.length-1],a=m.indexOf(t),d=u[a],s=document.querySelector(".axis").textContent.split(" ")[1],n=y.getAdjacents(y,d,i.id);if("X"===s){let e=n[0].some((e=>y.hasShip(e)));y.hasShip(i.id)||i.dataset.cNotAllowed||e||n[0].length<d?(y.hasShip(i.id)||(i.style.background="red"),i.style.cursor="not-allowed"):n[0].forEach((e=>{y.hasShip(e)?(i.style.cursor="not-allowed",document.getElementById(e).style.background="green"):(document.getElementById(e).style.background="black",i.style.background="black",i.style.cursor="crosshair")}))}if("Y"===s){let e=n[1].some((e=>y.hasShip(e)));y.hasShip(i.id)||i.dataset.yNotAllowed||e||n[1].length<d?(y.hasShip(i.id)||(i.style.background="red"),i.style.cursor="not-allowed"):n[1].forEach((e=>{document.getElementById(e).style.background="black",i.style.background="black",i.style.cursor="crosshair"}))}})),i.addEventListener("mouseleave",(()=>{let e=document.querySelector(".my-name").textContent.split(" "),t=e[e.length-1],a=m.indexOf(t),d=u[a],s=document.querySelector(".axis").textContent.split(" ")[1],n=y.getAdjacents(y,d,i.id);"X"===s&&(i.dataset.xNotAllowed&&(i.style.background="lightgoldenrodyellow",i.style.cursor="crosshair"),y.hasShip(i.id)?(i.style.background="green",i.style.cursor="not-allowed"):n[0].forEach((e=>{y.hasShip(e)?(i.style.cursor="not-allowed",i.style.background="lightgoldenrodyellow",document.getElementById(e).style.background="green"):(document.getElementById(e).style.background="lightgoldenrodyellow",i.style.background="lightgoldenrodyellow")}))),"Y"===s&&(i.dataset.yNotAllowed&&(i.style.background="lightgoldenrodyellow",i.style.cursor="crosshair"),y.hasShip(i.id)?(i.style.background="green",i.style.cursor="not-allowed"):n[1].forEach((e=>{y.hasShip(e)?(i.style.cursor="not-allowed",document.getElementById(e).style.background="green"):(document.getElementById(e).style.background="lightgoldenrodyellow",i.style.background="lightgoldenrodyellow")})))})),i.addEventListener("click",(()=>{d(y),p+=1,p===m.length&&(s(),t(a)),c.textContent=`${a},  place your  ${m[p]}`})),r.appendChild(i)}l.appendChild(c),l.appendChild(h),i.appendChild(r),o.appendChild(l),o.appendChild(i),y.placeShip(3,["1,1","1,2","1,3"]),y.receiveAttack("5,5"),n.appendChild(o),d(y)}(i.value)):alert("Please Write Your Name")}))}()})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixRQUFRRSxjQUNabkIsRUFBSUssTUFBTUMsV0FBYSx1QkFDdkJOLEVBQUlLLE1BQU1zQixPQUFTLGFBRW5CbEgsRUFBTVEsUUFBUStFLEVBQUlFLEtBQ2xCRixFQUFJSyxNQUFNQyxXQUFhLFFBQ3ZCTixFQUFJSyxNQUFNc0IsT0FBUyxlQUduQnBFLEVBQVUsR0FBR1QsU0FBUTFDLElBQ2JLLEVBQU1RLFFBQVFiLElBQ2Q0RixFQUFJSyxNQUFNc0IsT0FBUyxjQUNUMUMsU0FBU0MsZUFBZTlFLEdBQzlCaUcsTUFBTUMsV0FBYSxVQUdickIsU0FBU0MsZUFBZTlFLEdBQzlCaUcsTUFBTUMsV0FBYSx1QkFDdkJOLEVBQUlLLE1BQU1DLFdBQWEsdUJBQzNCLElBR1gsSUFHSE4sRUFBSWMsaUJBQWlCLFNBQVMsS0FvQjVCLEVBQWNyRyxHQUVWb0MsR0FBTyxFQUNIQSxJQUFRbkMsRUFBTWtCLFNBQ1Y2RSxJQUNBLEVBQW1CMUIsSUFFM0JTLEVBQU9ZLFlBQWMsR0FBR3JCLG1CQUFzQnJFLEVBQU1tQyxJQUFNLElBUWhFeUMsRUFBUWEsWUFBWUgsRUFDdEIsQ0FJSlQsRUFBVVksWUFBWVgsR0FDdEJELEVBQVVZLFlBQVlhLEdBQ3RCM0IsRUFBY2MsWUFBWWIsR0FDMUJILEVBQVVnQixZQUFZWixHQUN0QkosRUFBVWdCLFlBQVlkLEdBRXRCNUUsRUFBTWtCLFVBQVUsRUFBRyxDQUFDLE1BQU8sTUFBTyxRQUNsQ2xCLEVBQU1zRCxjQUFjLE9BQ3BCaUIsRUFBS21CLFlBQVloQixHQUNqQixFQUFjMUUsRUFLbEIsQ0FqUFltSCxDQUFpQmpCLEVBQU1JLFFBRWxCYyxNQUFNLHlCQUF5QixHQUVoRCxDQy9CQUMsRSIsInNvdXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZmFjdG9yaWVzLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9yZW5kZXIuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTaGlwIENsYXNzIC8vXHJcbmNsYXNzIFNoaXAge1xyXG4gICAgY29uc3RydWN0b3IgKHNpemUpIHtcclxuICAgICAgICB0aGlzLnNpemUgPSBzaXplO1xyXG4gICAgICAgIHRoaXMuaGl0ID0gMDtcclxuICAgICAgICB0aGlzLnN1bmsgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNvb3JkaW5hdGVzID0gW107XHJcbiAgICB9XHJcblxyXG4gICAgcmVnaXN0ZXJIaXQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaGl0ICs9IDE7XHJcbiAgICB9XHJcblxyXG4gICAgaXNTdW5rKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmhpdCA9PT0gdGhpcy5zaXplO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZENvb3JkaW5hdGVzIChwb3NpdGlvbikge1xyXG4gICAgICAgIHRoaXMuY29vcmRpbmF0ZXMucHVzaChwb3NpdGlvbik7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIEdhbWVib2FyZCBDbGFzcyAvL1xyXG5jbGFzcyBHYW1lYm9hcmQge1xyXG4gICAgY29uc3RydWN0b3IgKCkge1xyXG4gICAgICAgIHRoaXMuYm9hcmQgPSBbXSBcclxuICAgICAgICB0aGlzLnNoaXBzID0gW11cclxuICAgIH1cclxuICAgIFxyXG4gICAgY3JlYXRlQm9hcmQoc2l6ZSA9IDggKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpICs9IDEpIHtcclxuICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgc2l6ZTsgaiArPSAxKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvb3JkaW5hdGUgPSBgJHtpfSwke2p9YDtcclxuICAgICAgICAgICAgdGhpcy5ib2FyZFtjb29yZGluYXRlXSA9IHsgY29vcmRpbmF0ZXM6IGNvb3JkaW5hdGUsIGF0dGFja2VkOiBmYWxzZSwgbWlzc2VkOiBmYWxzZSwgaGFzU2hpcDogZmFsc2UsIHNoaXA6IFtdIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5ib2FyZDtcclxuICAgICAgfVxyXG5cclxuICAgICAgaXNWYWxpZCAoY29vcmRpbmF0ZXMpIHtcclxuICAgICAgICBsZXQgYXJyID0gY29vcmRpbmF0ZXMuc3BsaXQoJywnKTtcclxuICAgICAgICBsZXQgYSA9IE51bWJlcihhcnJbMF0pO1xyXG4gICAgICAgIGxldCBiID0gTnVtYmVyKGFyclsxXSk7XHJcblxyXG5cclxuICAgICAgICByZXR1cm4gYSA+PSAwICYmIGEgPD0gNyAmJiBiID49IDAgJiYgYiA8PSA3O1xyXG4gICAgICB9XHJcblxyXG4gICAgICBnZXRCb2FyZCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5ib2FyZDtcclxuICAgICAgfVxyXG5cclxuICAgICAgYWRkU2hpcCAoc2hpcCkge1xyXG4gICAgICAgIHRoaXMuc2hpcHMucHVzaChzaGlwKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcGxhY2VTaGlwIChzaXplLCBjb29yZGluYXRlcykge1xyXG4gICAgICAgIGlmIChzaXplICE9PSBjb29yZGluYXRlcy5sZW5ndGgpIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgY29uc3Qgc2hpcCA9IG5ldyBTaGlwKHNpemUpO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvb3JkaW5hdGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaGFzU2hpcChjb29yZGluYXRlc1tpXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJvYXJkW2Nvb3JkaW5hdGVzW2ldXS5zaGlwLnB1c2goY29vcmRpbmF0ZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYm9hcmRbY29vcmRpbmF0ZXNbaV1dLmhhc1NoaXAgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2hpcC5hZGRDb29yZGluYXRlcyhjb29yZGluYXRlcyk7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkU2hpcChzaGlwKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlzTW92ZUxlZ2FsIChtb3ZlKSB7XHJcbiAgICAgICAgcmV0dXJuICF0aGlzLmJvYXJkW21vdmVdLmF0dGFja2VkICYmICF0aGlzLmJvYXJkW21vdmVdLm1pc3NlZDtcclxuICAgIH1cclxuICAgICAgICBcclxuICAgIGhhc1NoaXAgKGNvb3JkaW5hdGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYm9hcmRbY29vcmRpbmF0ZV0uaGFzU2hpcDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICBwbGFjZUVuZW15U2hpcHMgKCkge1xyXG4gICAgICAgICAgICBsZXQgY29vcmRpbmF0ZUNhcnJpZXIgPSB0aGlzLmNyZWF0ZUNvb3JkaW5hdGVzKCk7XHJcbiAgICAgICAgICAgIGxldCBjb29yZGluYXRlQmF0dGxlc2hpcCA9IHRoaXMuY3JlYXRlQ29vcmRpbmF0ZXMoKTtcclxuICAgICAgICAgICAgbGV0IGNvb3JkaW5hdGVDcnVpc2VyID0gdGhpcy5jcmVhdGVDb29yZGluYXRlcygpO1xyXG4gICAgICAgICAgICBsZXQgY29vcmRpbmF0ZVN1Ym1hcmluZSA9IHRoaXMuY3JlYXRlQ29vcmRpbmF0ZXMoKTtcclxuICAgICAgICAgICAgbGV0IGNvb3JkaW5hdGVEZXN0cm95ZXIgPSB0aGlzLmNyZWF0ZUNvb3JkaW5hdGVzKCk7XHJcblxyXG4gICAgICAgICAgICBsZXQgYXJyYXkgPSB0aGlzLmJvYXJkQXJyYXkoKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBjYXJyaWVyID0gdGhpcy5nZXRBZGphY2VudHMoYXJyYXksIDUsIGNvb3JkaW5hdGVDYXJyaWVyKTtcclxuICAgICAgICAgICAgbGV0IGJhdHRsZXNoaXAgPSB0aGlzLmdldEFkamFjZW50cyhhcnJheSwgNCwgY29vcmRpbmF0ZUJhdHRsZXNoaXApO1xyXG4gICAgICAgICAgICBsZXQgY3J1aXNlciA9IHRoaXMuZ2V0QWRqYWNlbnRzKGFycmF5LCAzLCBjb29yZGluYXRlQ3J1aXNlcik7XHJcbiAgICAgICAgICAgIGxldCBzdWJtYXJpbmUgPSB0aGlzLmdldEFkamFjZW50cyhhcnJheSwgMywgY29vcmRpbmF0ZVN1Ym1hcmluZSk7XHJcbiAgICAgICAgICAgIGxldCBkZXN0cm95ZXIgPSB0aGlzLmdldEFkamFjZW50cyhhcnJheSwgMiwgY29vcmRpbmF0ZURlc3Ryb3llcik7XHJcblxyXG4gICAgICAgICAgICBsZXQgc2hpcHMgPSBbY2FycmllciwgYmF0dGxlc2hpcCwgY3J1aXNlciwgc3VibWFyaW5lLCBkZXN0cm95ZXJdO1xyXG4gICAgICAgICAgICBsZXQgc2l6ZXMgPSBbNSw0LDMsMywyXTtcclxuICAgICAgICAgICAgbGV0IGZpbHRlcmVkID0gW107XHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXBzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdGVtcCA9IHNoaXBzW2ldLmZpbHRlcihwb3MgPT4gcG9zLmxlbmd0aCA9PT0gc2l6ZXNbaV0pO1xyXG4gICAgICAgICAgICAgICAgZmlsdGVyZWQucHVzaCh0ZW1wKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcblxyXG4gICAgICAgICAgICBmaWx0ZXJlZC5mb3JFYWNoKHNldE9mQ29vcmRpbmF0ZXMgPT4geyBcclxuICAgICAgICAgICAgICAgIHRoaXMucGxhY2VTaGlwKHNldE9mQ29vcmRpbmF0ZXNbMF0ubGVuZ3RoLCBzZXRPZkNvb3JkaW5hdGVzWzBdKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gc2V0T2ZDb29yZGluYXRlcy5mb3JFYWNoKGNvb3JkaW5hdGVzID0+IHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAvLyBsZXQgYWZmaXJtYXRpdmUgPSBjb29yZGluYXRlcy5ldmVyeShwb3NpdGlvbiA9PiAhdGhpcy5oYXNTaGlwKHBvc2l0aW9uKSk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy5wbGFjZVNoaXAoY29vcmRpbmF0ZXMubGVuZ3RoLCBjb29yZGluYXRlcyk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgLy8gY29vcmRpbmF0ZXMuZm9yRWFjaChwb3NpdGlvbiA9PiB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgLy8gfSlcclxuICAgICAgICAgICAgICAgIC8vIH0pO1xyXG4gICAgICAgICAgICB9KTsgIFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY3JlYXRlQ29vcmRpbmF0ZXMgKCkge1xyXG4gICAgICAgIGxldCBudW0xID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogOCk7IFxyXG4gICAgICAgIGxldCBudW0yID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogOCk7IFxyXG4gICAgICAgIGxldCByZXN1bHQgPSBgJHtudW0xfSwke251bTJ9YDtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmhhc1NoaXAocmVzdWx0KSkgcmV0dXJuIHJlc3VsdDtcclxuXHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHdoaWxlICh0aGlzLmhhc1NoaXAocmVzdWx0KSkge1xyXG4gICAgICAgICAgICAgICAgbnVtMSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDgpOyBcclxuICAgICAgICAgICAgICAgIG51bTIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA4KTsgXHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBgJHtudW0xfSwke251bTJ9YDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgICAgZ2V0QWRqYWNlbnRzIChib2FyZCwgc2l6ZSwgY29vcmRpbmF0ZXMpIHtcclxuICAgICAgICBsZXQgYXJyYXlCb2FyZCA9IGJvYXJkLmJvYXJkQXJyYXkoKTtcclxuICAgICAgICBsZXQgYWRqYWNlbnRzID0gW1tdLFtdXTtcclxuICAgICAgICAvLyBsZXQgdXAgPSA4O1xyXG4gICAgICAgIGxldCByaWdodCA9IDE7XHJcbiAgICAgICAgbGV0IGRvd24gPSA4O1xyXG4gICAgICAgIC8vIGxldCBsZWZ0ID0gMTtcclxuICAgICAgICBsZXQgaW5kZXggPSAwO1xyXG5cclxuICAgICAgICAvLyBnZXQgaW5kZXggLy9cclxuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGFycmF5Qm9hcmQubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgaWYgKGFycmF5Qm9hcmRbal0uY29vcmRpbmF0ZXMgPT09IGNvb3JkaW5hdGVzKSB7XHJcbiAgICAgICAgICAgICAgICBpbmRleCA9IGo7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHtcclxuICAgICAgICAgICAgLy8gMiBhZGphY2VudHMgLy8gXHJcbiAgICAgICAgICAgIC8vIGlmIChhcnJheUJvYXJkW2luZGV4IC0gdXBdKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBsZXQgc3BsaXQgPSBjb29yZGluYXRlcy5zcGxpdCgnLCcpO1xyXG4gICAgICAgICAgICAvLyAgICAgbGV0IHBsYWNlID0gYXJyYXlCb2FyZFtpbmRleCAtIHVwXS5jb29yZGluYXRlcztcclxuICAgICAgICAgICAgLy8gICAgIGxldCBwbGFjZVNwbGl0ID0gcGxhY2Uuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgLy8gICAgIGlmIChwbGFjZSAmJiBwbGFjZS5pbmNsdWRlcyhzcGxpdFsxXSkpIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICBhZGphY2VudHNbMF0ucHVzaChhcnJheUJvYXJkW2luZGV4IC0gdXBdLmNvb3JkaW5hdGVzKTtcclxuICAgICAgICAgICAgLy8gICAgICAgICB1cCArPSA4O1xyXG4gICAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIGlmIChhcnJheUJvYXJkW2luZGV4ICsgcmlnaHRdKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgc3BsaXQgPSBjb29yZGluYXRlcy5zcGxpdCgnLCcpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHBsYWNlID0gYXJyYXlCb2FyZFtpbmRleCArIHJpZ2h0XS5jb29yZGluYXRlcztcclxuICAgICAgICAgICAgICAgIGxldCBwbGFjZVNwbGl0ID0gcGxhY2Uuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgICAgIGlmIChwbGFjZSAmJiBwbGFjZVNwbGl0WzBdID09PSBzcGxpdFswXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFkamFjZW50c1swXS5wdXNoKGFycmF5Qm9hcmRbaW5kZXggKyByaWdodF0uY29vcmRpbmF0ZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0Kys7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGFycmF5Qm9hcmRbaW5kZXggKyBkb3duXSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHNwbGl0ID0gY29vcmRpbmF0ZXMuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgICAgIGxldCBwbGFjZSA9IGFycmF5Qm9hcmRbaW5kZXggKyBkb3duXS5jb29yZGluYXRlcztcclxuICAgICAgICAgICAgICAgIGxldCBwbGFjZVNwbGl0ID0gcGxhY2Uuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgICAgIGlmIChwbGFjZSAmJiBwbGFjZS5pbmNsdWRlcyhzcGxpdFsxXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGphY2VudHNbMV0ucHVzaChhcnJheUJvYXJkW2luZGV4ICsgZG93bl0uY29vcmRpbmF0ZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRvd24gKz0gODtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBpZiAoYXJyYXlCb2FyZFtpbmRleCAtIGxlZnRdKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBsZXQgc3BsaXQgPSBjb29yZGluYXRlcy5zcGxpdCgnLCcpO1xyXG4gICAgICAgICAgICAvLyAgICAgbGV0IHBsYWNlID0gYXJyYXlCb2FyZFtpbmRleCAtIGxlZnRdLmNvb3JkaW5hdGVzO1xyXG4gICAgICAgICAgICAvLyAgICAgbGV0IHBsYWNlU3BsaXQgPSBwbGFjZS5zcGxpdCgnLCcpO1xyXG4gICAgICAgICAgICAvLyAgICAgaWYgKHBsYWNlICYmIHBsYWNlU3BsaXRbMF0gPT09IHNwbGl0WzBdKSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgYWRqYWNlbnRzWzNdLnB1c2goYXJyYXlCb2FyZFtpbmRleCAtIGxlZnRdLmNvb3JkaW5hdGVzKTtcclxuICAgICAgICAgICAgLy8gICAgICAgICBsZWZ0Kys7XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGFkamFjZW50cztcclxuICAgIH1cclxuXHJcbiAgICBoYXNBbGxTaGlwc1BsYWNlZCAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2hpcHMubGVuZ3RoID09PSA1O1xyXG4gICAgfVxyXG5cclxuICAgICAgcmVjZWl2ZUF0dGFjayAoY29vcmRpbmF0ZXMpIHtcclxuICAgICAgICBsZXQgc3RyID0gYCR7Y29vcmRpbmF0ZXN9YDtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuYm9hcmRbc3RyXS5hdHRhY2tlZCB8fCB0aGlzLmJvYXJkW3N0cl0ubWlzc2VkKSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmJvYXJkW3N0cl0uaGFzU2hpcCkge1xyXG4gICAgICAgICAgICB0aGlzLmJvYXJkW3N0cl0uYXR0YWNrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLnNoaXBzLmZvckVhY2goc2hpcCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2hpcC5jb29yZGluYXRlc1swXS5pbmNsdWRlcyhzdHIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hpcC5yZWdpc3RlckhpdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzaGlwLmlzU3VuaygpKSBzaGlwLnN1bmsgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ib2FyZFtzdHJdLm1pc3NlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBnZXRTaGlwcyAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2hpcHM7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGFsbFN1bmsgKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNoaXBzLmV2ZXJ5KHNoaXAgPT4gc2hpcC5zdW5rID09PSB0cnVlKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgYm9hcmRBcnJheSAoKSB7XHJcbiAgICAgICAgY29uc3Qgb2JqID0gdGhpcy5ib2FyZDtcclxuICAgICAgICBjb25zdCBhcnJheSA9IFtdO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgICAgIGFycmF5LnB1c2gob2JqW2tleV0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIGFycmF5O1xyXG4gICAgICB9XHJcbn1cclxuXHJcbi8vIFBsYXllciBDbGFzcyAvL1xyXG5jbGFzcyBQbGF5ZXIge1xyXG4gICAgY29uc3RydWN0b3IgKGdhbWVib2FyZCkge1xyXG4gICAgICAgIHRoaXMuZ2FtZWJvYXJkID0gZ2FtZWJvYXJkO1xyXG4gICAgfVxyXG5cclxuICAgIGlzTW92ZUxlZ2FsIChtb3ZlKSB7XHJcbiAgICAgICAgcmV0dXJuICF0aGlzLmdhbWVib2FyZC5ib2FyZFttb3ZlXS5hdHRhY2tlZCAmJiAhdGhpcy5nYW1lYm9hcmQuYm9hcmRbbW92ZV0ubWlzc2VkO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBtYWtlUmFuZG9tTW92ZSAoKSB7XHJcbiAgICAgICAgbGV0IG51bTEgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA4KTsgXHJcbiAgICAgICAgbGV0IG51bTIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA4KTsgXHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IGAke251bTF9LCR7bnVtMn1gO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5pc01vdmVMZWdhbChyZXN1bHQpKSByZXR1cm4gcmVzdWx0O1xyXG5cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgd2hpbGUgKCF0aGlzLmlzTW92ZUxlZ2FsKHJlc3VsdCkpIHtcclxuICAgICAgICAgICAgICAgIG51bTEgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA4KTsgXHJcbiAgICAgICAgICAgICAgICBudW0yID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogOCk7IFxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gYCR7bnVtMX0sJHtudW0yfWA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxufVxyXG5cclxuXHJcbm1vZHVsZS5leHBvcnRzID0ge1NoaXAsIEdhbWVib2FyZCwgUGxheWVyfTsiLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gRE9NIE1hbmlwdWxhdGlvbiwgUmVuZGVyIHRoZSBHYW1lIC8vIFxyXG5cclxuLy8gUmVuZGVyIFdyaXRlIFlvdXIgTmFtZSAvLyBcclxuaW1wb3J0IHsgZ2FtZSB9IGZyb20gXCIuL2dhbWVcIjtcclxuaW1wb3J0IHsgR2FtZWJvYXJkLCBQbGF5ZXIsIFNoaXAgfSBmcm9tIFwiLi9mYWN0b3JpZXNcIjtcclxuXHJcbmZ1bmN0aW9uIHdyaXRlTmFtZSAoKSB7XHJcbiAgICBjb25zdCBtYWluID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW4nKTtcclxuICAgIGNvbnN0IGJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpO1xyXG4gICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xyXG4gICAgY29uc3QgcGxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpXHJcblxyXG4gICAgYm94LmNsYXNzTGlzdC5hZGQoJ3BvcC11cC1ib3gnKTtcclxuICAgIHRpdGxlLmNsYXNzTGlzdC5hZGQoJ3RpdGxlLXBvcC11cCcpO1xyXG4gICAgaW5wdXQuY2xhc3NMaXN0LmFkZCgnaW5wdXQtcG9wLXVwJyk7XHJcbiAgICBwbGF5LmNsYXNzTGlzdC5hZGQoJ3BsYXktYnV0dG9uJyk7XHJcblxyXG5cclxuICAgIHRpdGxlLnRleHRDb250ZW50ID0gJ1dyaXRlIHlvdXIgTmFtZSc7XHJcbiAgICBwbGF5LmlubmVySFRNTCA9ICdCYXR0bGUnO1xyXG4gICAgaW5wdXQudHlwZSA9ICd0ZXh0JztcclxuICAgIHBsYXkudHlwZSA9ICdzdWJtaXQnO1xyXG5cclxuICAgIGJveC5hcHBlbmRDaGlsZCh0aXRsZSk7XHJcbiAgICBib3guYXBwZW5kQ2hpbGQoaW5wdXQpO1xyXG4gICAgYm94LmFwcGVuZENoaWxkKHBsYXkpO1xyXG5cclxuICAgIG1haW4uYXBwZW5kQ2hpbGQoYm94KTtcclxuXHJcbiAgICBwbGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgIGlmIChpbnB1dC52YWx1ZSkge1xyXG4gICAgICAgICAgICBjbGVhbigpO1xyXG4gICAgICAgICAgICByZW5kZXJQbGFjZVNoaXBzKGlucHV0LnZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgYWxlcnQoJ1BsZWFzZSBXcml0ZSBZb3VyIE5hbWUnKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gcmVuZGVyUGxhY2VTaGlwcyAobmFtZSkge1xyXG4gICAgY29uc3QgbWFpbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluJyk7XHJcbiAgICBjb25zdCBteVNlY3Rpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IG15R2FtZVNlY3Rpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IG15Qm9hcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IG15TmFtZUJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgbXlOYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTtcclxuICAgIGNvbnN0IGF4aXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuXHJcbiAgICBjb25zdCBzaGlwcyA9IFsnQ2FycmllcicsICdCYXR0bGVzaGlwJywgJ0NydWlzZXInLCAnU3VibWFyaW5lJywgJ0Rlc3Ryb3llciddO1xyXG4gICAgbGV0IHNpemVzID0gWzQsMywyLDIsMV07XHJcblxyXG4gICAgbWFpbi5jbGFzc0xpc3QuYWRkKCdtYWluLWdhbWUnKTtcclxuICAgIG15U2VjdGlvbi5jbGFzc0xpc3QuYWRkKCdteS1zZWN0aW9uJyk7XHJcbiAgICBteUdhbWVTZWN0aW9uLmNsYXNzTGlzdC5hZGQoJ215LWdhbWUtc2VjdGlvbicpO1xyXG4gICAgbXlCb2FyZC5jbGFzc0xpc3QuYWRkKCdteS1ib2FyZCcpO1xyXG4gICAgbXlOYW1lQm94LmNsYXNzTGlzdC5hZGQoJ215LW5hbWUtYm94Jyk7XHJcbiAgICBteU5hbWUuY2xhc3NMaXN0LmFkZCgnbXktbmFtZScpO1xyXG4gICAgYXhpcy5jbGFzc0xpc3QuYWRkKCdheGlzJyk7XHJcblxyXG4gICAgbGV0IHBvcyA9IDA7XHJcblxyXG4gICAgbXlOYW1lLnRleHRDb250ZW50ID0gYCR7bmFtZX0sICBwbGFjZSB5b3VyICAke3NoaXBzW3Bvc119YDtcclxuICAgIG15TmFtZS5kYXRhc2V0LnNpemUgPSBwb3M7XHJcblxyXG4gICAgYXhpcy5pbm5lckhUTUwgPSAnQXhpcyBYJztcclxuXHJcbiAgICBheGlzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgIGlmIChheGlzLmlubmVySFRNTCA9PT0gJ0F4aXMgWCcpIHtcclxuICAgICAgICAgICAgYXhpcy5pbm5lckhUTUwgPSAnQXhpcyBZJztcclxuICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgYXhpcy5pbm5lckhUTUwgPSAnQXhpcyBYJztcclxuICAgICAgICB9KVxyXG5cclxuICAgIGxldCBib2FyZCA9IG5ldyBHYW1lYm9hcmQoKTtcclxuXHJcbiAgICBib2FyZC5jcmVhdGVCb2FyZCgpO1xyXG4gICBcclxuICAgIGxldCBwbGF5ZXIgPSBuZXcgUGxheWVyKGJvYXJkKTtcclxuICAgIFxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCA4OyBpICs9IDEpIHtcclxuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDg7IGogKz0gMSkge1xyXG4gICAgICAgICAgY29uc3QgY29vcmRpbmF0ZSA9IGAke2l9LCR7an1gO1xyXG4gICAgICAgICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICBkaXYuY2xhc3NMaXN0LmFkZCgnbXktZGl2LWJveCcpO1xyXG4gICAgICAgICAgZGl2LmlkID0gYCR7Y29vcmRpbmF0ZX1gO1xyXG4gICAgICAgICAgaWYgKGogPT09IDcpIHtcclxuICAgICAgICAgICAgZGl2LmRhdGFzZXQueE5vdEFsbG93ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKGkgPT09IDcpIHtcclxuICAgICAgICAgICAgZGl2LmRhdGFzZXQueU5vdEFsbG93ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIGRpdi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCB0aXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5teS1uYW1lJyk7XHJcbiAgICAgICAgICAgIGxldCBuYW1lID0gdGl0bGUudGV4dENvbnRlbnQ7XHJcbiAgICAgICAgICAgIGxldCBzcGxpdCA9IG5hbWUuc3BsaXQoJyAnKTtcclxuICAgICAgICAgICAgbGV0IHNoaXAgPSBzcGxpdFtzcGxpdC5sZW5ndGggLTFdO1xyXG4gICAgICAgICAgICBsZXQgaW5kZXggPSBzaGlwcy5pbmRleE9mKHNoaXApO1xyXG4gICAgICAgICAgICBsZXQgc2l6ZSA9IHNpemVzW2luZGV4XTtcclxuICAgICAgICAgICAgbGV0IGF4aXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXhpcycpO1xyXG4gICAgICAgICAgICBsZXQgYXhpc1RleHQgPSBheGlzLnRleHRDb250ZW50LnNwbGl0KCcgJylbMV07XHJcblxyXG4gICAgICAgICAgICBsZXQgYWRqYWNlbnRzID0gYm9hcmQuZ2V0QWRqYWNlbnRzKGJvYXJkLCBzaXplLCBkaXYuaWQpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGF4aXNUZXh0ID09PSAnWCcpIHtcclxuICAgICAgICAgICAgICAgIGxldCBhZGpXaXRoU2hpcCA9IGFkamFjZW50c1swXS5zb21lKHggPT4gYm9hcmQuaGFzU2hpcCh4KSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoYm9hcmQuaGFzU2hpcChkaXYuaWQpIHx8IGRpdi5kYXRhc2V0LmNOb3RBbGxvd2VkIHx8IGFkaldpdGhTaGlwICB8fCBhZGphY2VudHNbMF0ubGVuZ3RoIDwgc2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChib2FyZC5oYXNTaGlwKGRpdi5pZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmN1cnNvciA9ICdub3QtYWxsb3dlZCc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuYmFja2dyb3VuZCA9ICdyZWQnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuY3Vyc29yID0gJ25vdC1hbGxvd2VkJztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkamFjZW50c1swXS5mb3JFYWNoKHBvc2l0aW9uID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChib2FyZC5oYXNTaGlwKHBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5jdXJzb3IgPSAnbm90LWFsbG93ZWQnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB1YmkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWJpLnN0eWxlLmJhY2tncm91bmQgPSAnZ3JlZW4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHViaSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1Ymkuc3R5bGUuYmFja2dyb3VuZCA9ICdibGFjayc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmJhY2tncm91bmQgPSAnYmxhY2snO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5jdXJzb3IgPSAnY3Jvc3NoYWlyJzsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH07IFxyXG4gICAgICAgICAgICAgICAgfTsgICBcclxuICAgICAgICBcclxuXHJcbiAgICAgICAgICAgIGlmIChheGlzVGV4dCA9PT0gJ1knKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgYWRqV2l0aFNoaXAgPSBhZGphY2VudHNbMV0uc29tZSh4ID0+IGJvYXJkLmhhc1NoaXAoeCkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGJvYXJkLmhhc1NoaXAoZGl2LmlkKSB8fCBkaXYuZGF0YXNldC55Tm90QWxsb3dlZCB8fCBhZGpXaXRoU2hpcCAgfHwgYWRqYWNlbnRzWzFdLmxlbmd0aCA8IHNpemUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYm9hcmQuaGFzU2hpcChkaXYuaWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5jdXJzb3IgPSAnbm90LWFsbG93ZWQnO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmJhY2tncm91bmQgPSAncmVkJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmN1cnNvciA9ICdub3QtYWxsb3dlZCc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGphY2VudHNbMV0uZm9yRWFjaChwb3NpdGlvbiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB1YmkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHViaS5zdHlsZS5iYWNrZ3JvdW5kID0gJ2JsYWNrJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmJhY2tncm91bmQgPSAnYmxhY2snO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuY3Vyc29yID0gJ2Nyb3NzaGFpcic7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9OyAgXHJcbiAgICAgICAgICAgICAgICB9OyBcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIGRpdi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgdGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubXktbmFtZScpO1xyXG4gICAgICAgICAgICBsZXQgbmFtZSA9IHRpdGxlLnRleHRDb250ZW50O1xyXG4gICAgICAgICAgICBsZXQgc3BsaXQgPSBuYW1lLnNwbGl0KCcgJyk7XHJcbiAgICAgICAgICAgIGxldCBzaGlwID0gc3BsaXRbc3BsaXQubGVuZ3RoIC0xXTtcclxuICAgICAgICAgICAgbGV0IGluZGV4ID0gc2hpcHMuaW5kZXhPZihzaGlwKTtcclxuICAgICAgICAgICAgbGV0IHNpemUgPSBzaXplc1tpbmRleF07XHJcbiAgICAgICAgICAgIGxldCBheGlzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmF4aXMnKTtcclxuICAgICAgICAgICAgbGV0IGF4aXNUZXh0ID0gYXhpcy50ZXh0Q29udGVudC5zcGxpdCgnICcpWzFdO1xyXG5cclxuICAgICAgICAgICAgbGV0IGFkamFjZW50cyA9IGJvYXJkLmdldEFkamFjZW50cyhib2FyZCwgc2l6ZSwgZGl2LmlkKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChheGlzVGV4dCA9PT0gJ1gnKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGl2LmRhdGFzZXQueE5vdEFsbG93ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuYmFja2dyb3VuZCA9ICdsaWdodGdvbGRlbnJvZHllbGxvdyc7XHJcbiAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmN1cnNvciA9ICdjcm9zc2hhaXInOyBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChib2FyZC5oYXNTaGlwKGRpdi5pZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuYmFja2dyb3VuZCA9ICdncmVlbic7XHJcbiAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmN1cnNvciA9ICdub3QtYWxsb3dlZCc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGphY2VudHNbMF0uZm9yRWFjaChwb3NpdGlvbiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChib2FyZC5oYXNTaGlwKHBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmN1cnNvciA9ICdub3QtYWxsb3dlZCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuYmFja2dyb3VuZCA9ICdsaWdodGdvbGRlbnJvZHllbGxvdyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdWJpID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdWJpLnN0eWxlLmJhY2tncm91bmQgPSAnZ3JlZW4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHViaSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHViaS5zdHlsZS5iYWNrZ3JvdW5kID0gJ2xpZ2h0Z29sZGVucm9keWVsbG93JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5iYWNrZ3JvdW5kID0gJ2xpZ2h0Z29sZGVucm9keWVsbG93JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKGF4aXNUZXh0ID09PSAnWScpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkaXYuZGF0YXNldC55Tm90QWxsb3dlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5iYWNrZ3JvdW5kID0gJ2xpZ2h0Z29sZGVucm9keWVsbG93JztcclxuICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuY3Vyc29yID0gJ2Nyb3NzaGFpcic7IFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGJvYXJkLmhhc1NoaXAoZGl2LmlkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5iYWNrZ3JvdW5kID0gJ2dyZWVuJztcclxuICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuY3Vyc29yID0gJ25vdC1hbGxvd2VkJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGFkamFjZW50c1sxXS5mb3JFYWNoKHBvc2l0aW9uID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJvYXJkLmhhc1NoaXAocG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuY3Vyc29yID0gJ25vdC1hbGxvd2VkJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB1YmkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1Ymkuc3R5bGUuYmFja2dyb3VuZCA9ICdncmVlbic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdWJpID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdWJpLnN0eWxlLmJhY2tncm91bmQgPSAnbGlnaHRnb2xkZW5yb2R5ZWxsb3cnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmJhY2tncm91bmQgPSAnbGlnaHRnb2xkZW5yb2R5ZWxsb3cnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICBkaXYuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIGxldCB0aXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5teS1uYW1lJyk7XHJcbiAgICAgICAgICAgIC8vIGxldCBuYW1lID0gdGl0bGUudGV4dENvbnRlbnQ7XHJcbiAgICAgICAgICAgIC8vIGxldCBzcGxpdCA9IG5hbWUuc3BsaXQoJyAnKTtcclxuICAgICAgICAgICAgLy8gbGV0IHNoaXAgPSBzcGxpdFtzcGxpdC5sZW5ndGggLTFdO1xyXG4gICAgICAgICAgICAvLyBsZXQgaW5kZXggPSBzaGlwcy5pbmRleE9mKHNoaXApO1xyXG4gICAgICAgICAgICAvLyBsZXQgc2l6ZSA9IHNpemVzW2luZGV4XTtcclxuICAgICAgICAgICAgLy8gbGV0IGF4aXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXhpcycpO1xyXG4gICAgICAgICAgICAvLyBsZXQgYXhpc1RleHQgPSBheGlzLnRleHRDb250ZW50LnNwbGl0KCcgJylbMV07XHJcblxyXG4gICAgICAgICAgICAvLyBsZXQgYWRqYWNlbnRzID0gYm9hcmQuZ2V0QWRqYWNlbnRzKGJvYXJkLCBzaXplLCBkaXYuaWQpO1xyXG5cclxuICAgICAgICAgICAgLy8gaWYgKGF4aXNUZXh0ID09PSAnWCcpIHtcclxuICAgICAgICAgICAgLy8gICAgIGxldCBwbGFjZWQgPSBib2FyZC5wbGFjZVNoaXAoc2l6ZSwgYWRqYWNlbnRzWzBdKTtcclxuICAgICAgICAgICAgLy8gfVxyXG5cclxuICAgICAgICAgICAgLy8gaWYgKGF4aXNUZXh0ID09PSAnWScpIHtcclxuICAgICAgICAgICAgLy8gICAgIGxldCBwbGFjZWQgPSBib2FyZC5wbGFjZVNoaXAoc2l6ZSwgYWRqYWNlbnRzW2FdKTtcclxuICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmVuZGVyTXlCb2FyZChib2FyZCk7XHJcbiAgICAgICAgICAgIC8vIGlmIChwbGFjZSBzaGlwIGlzIHRob3NlIGNvb3JkaW5hdGVzID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBwb3MgKz0gMTtcclxuICAgICAgICAgICAgICAgIGlmIChwb3MgPT09IHNoaXBzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJJbml0YWxCb2FyZHMobmFtZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBteU5hbWUudGV4dENvbnRlbnQgPSBgJHtuYW1lfSwgIHBsYWNlIHlvdXIgICR7c2hpcHNbcG9zXX1gO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvL3JlbmRlciBib2FyZCAvLyBcclxuICAgICAgICAgICAgLy8gcmVuZGVyIHRleHQgd2l0aCBuYW1lIG9mIHNoaXAgLy8gXHJcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIGhhc0FsbFNoaXBzUGxhY2VkIC8vIFxyXG4gICAgICAgICAgICAvLyBpZiBzbywgcmVuZGVyIGluaXRpYWwgYm9hcmRzIHRvIHBsYXkgLy8gXHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgbXlCb2FyZC5hcHBlbmRDaGlsZChkaXYpO1xyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgXHJcblxyXG4gICAgbXlOYW1lQm94LmFwcGVuZENoaWxkKG15TmFtZSk7XHJcbiAgICBteU5hbWVCb3guYXBwZW5kQ2hpbGQoYXhpcyk7XHJcbiAgICBteUdhbWVTZWN0aW9uLmFwcGVuZENoaWxkKG15Qm9hcmQpO1xyXG4gICAgbXlTZWN0aW9uLmFwcGVuZENoaWxkKG15TmFtZUJveCk7XHJcbiAgICBteVNlY3Rpb24uYXBwZW5kQ2hpbGQobXlHYW1lU2VjdGlvbik7XHJcbiAgICBcclxuICAgIGJvYXJkLnBsYWNlU2hpcCgzLCBbJzEsMScsICcxLDInLCAnMSwzJ10pO1xyXG4gICAgYm9hcmQucmVjZWl2ZUF0dGFjaygnNSw1Jyk7XHJcbiAgICBtYWluLmFwcGVuZENoaWxkKG15U2VjdGlvbik7XHJcbiAgICByZW5kZXJNeUJvYXJkKGJvYXJkKTtcclxuXHJcbiAgICAvLyBJRiBBTlkgT0YgQURKQUNFTlRTIEhBUyBTSElQIE1BUktFRCBXSVRIIFJFRCBBTkQgQ1JPU1MgLy8gXHJcbiAgICBcclxuXHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiByZW5kZXJJbml0YWxCb2FyZHMgKG5hbWUpIHtcclxuICAgIGNvbnN0IG1haW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbicpO1xyXG5cclxuICAgIGNvbnN0IG15U2VjdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgbXlHYW1lU2VjdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgbXlCb2FyZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgbXlOYW1lQm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCBteU5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpO1xyXG4gICAgICAgIFxyXG4gICAgY29uc3QgZW5lbXlTZWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCBlbmVteUdhbWVTZWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCBlbmVteUJvYXJkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCBlbmVteU5hbWVCb3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IGVuZW15TmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XHJcblxyXG4gICAgXHJcbiAgICBteVNlY3Rpb24uY2xhc3NMaXN0LmFkZCgnbXktc2VjdGlvbicpO1xyXG4gICAgbXlHYW1lU2VjdGlvbi5jbGFzc0xpc3QuYWRkKCdteS1nYW1lLXNlY3Rpb24nKTtcclxuICAgIG15Qm9hcmQuY2xhc3NMaXN0LmFkZCgnbXktYm9hcmQnKTtcclxuICAgIG15TmFtZUJveC5jbGFzc0xpc3QuYWRkKCdteS1uYW1lLWJveCcpO1xyXG4gICAgbXlOYW1lLmNsYXNzTGlzdC5hZGQoJ215LW5hbWUnKTtcclxuICAgIFxyXG4gICAgZW5lbXlTZWN0aW9uLmNsYXNzTGlzdC5hZGQoJ2VuZW15LXNlY3Rpb24nKTtcclxuICAgIGVuZW15R2FtZVNlY3Rpb24uY2xhc3NMaXN0LmFkZCgnZW5lbXktZ2FtZS1zZWN0aW9uJyk7XHJcbiAgICBlbmVteUJvYXJkLmNsYXNzTGlzdC5hZGQoJ2VuZW15LWJvYXJkJyk7XHJcbiAgICBlbmVteU5hbWVCb3guY2xhc3NMaXN0LmFkZCgnZW5lbXktbmFtZS1ib3gnKTtcclxuICAgIGVuZW15TmFtZS5jbGFzc0xpc3QuYWRkKCdlbmVteS1uYW1lJyk7XHJcblxyXG5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgODsgaSArPSAxKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCA4OyBqICs9IDEpIHtcclxuICAgICAgICAgIGNvbnN0IGNvb3JkaW5hdGUgPSBgJHtpfSwke2p9YDtcclxuICAgICAgICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgY29uc3QgZGl2RW5lbXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgIGRpdi5jbGFzc0xpc3QuYWRkKCdteS1kaXYtYm94Jyk7XHJcbiAgICAgICAgICBkaXZFbmVteS5jbGFzc0xpc3QuYWRkKCdlbmVteS1kaXYtYm94Jyk7XHJcblxyXG4gICAgICAgICAgZGl2LmlkID0gYFAgJHtjb29yZGluYXRlfWA7XHJcbiAgICAgICAgICBkaXZFbmVteS5pZCA9IGBFICR7Y29vcmRpbmF0ZX1gO1xyXG4gIFxyXG4gICAgICAgICAgbXlCb2FyZC5hcHBlbmRDaGlsZChkaXYpO1xyXG4gICAgICAgICAgZW5lbXlCb2FyZC5hcHBlbmRDaGlsZChkaXZFbmVteSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG15TmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICBlbmVteU5hbWUudGV4dENvbnRlbnQgPSAnRW5lbXknO1xyXG5cclxuICAgIG15TmFtZUJveC5hcHBlbmRDaGlsZChteU5hbWUpO1xyXG4gICAgbXlHYW1lU2VjdGlvbi5hcHBlbmRDaGlsZChteUJvYXJkKTtcclxuICAgIG15U2VjdGlvbi5hcHBlbmRDaGlsZChteU5hbWVCb3gpO1xyXG4gICAgbXlTZWN0aW9uLmFwcGVuZENoaWxkKG15R2FtZVNlY3Rpb24pO1xyXG4gICAgXHJcbiAgICBlbmVteU5hbWVCb3guYXBwZW5kQ2hpbGQoZW5lbXlOYW1lKTtcclxuICAgIGVuZW15R2FtZVNlY3Rpb24uYXBwZW5kQ2hpbGQoZW5lbXlCb2FyZCk7XHJcbiAgICBlbmVteVNlY3Rpb24uYXBwZW5kQ2hpbGQoZW5lbXlOYW1lQm94KTtcclxuICAgIGVuZW15U2VjdGlvbi5hcHBlbmRDaGlsZChlbmVteUdhbWVTZWN0aW9uKTtcclxuXHJcbiAgICBtYWluLmFwcGVuZENoaWxkKG15U2VjdGlvbik7XHJcbiAgICBtYWluLmFwcGVuZENoaWxkKGVuZW15U2VjdGlvbik7XHJcblxyXG4gICAgbWFpbi5jbGFzc0xpc3QuYWRkKCdtYWluLWdhbWUnKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVuZGVyTXlCb2FyZCAoYm9hcmQpIHtcclxuICAgIGxldCBhcnIgPSBib2FyZC5ib2FyZEFycmF5KCk7XHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBpZiAoYXJyW2ldLmhhc1NoaXApIHtcclxuICAgICAgICAgICAgbGV0IGJveCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGFycltpXS5jb29yZGluYXRlcyk7XHJcbiAgICAgICAgICAgIGJveC5zdHlsZS5iYWNrZ3JvdW5kID0gJ2dyZWVuJztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGFycltpXS5hdHRhY2tlZCkge1xyXG4gICAgICAgICAgICBsZXQgYm94ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYXJyW2ldLmNvb3JkaW5hdGVzKTtcclxuICAgICAgICAgICAgYm94LmlubmVySFRNTCA9ICfinYwnO1xyXG4gICAgICAgICAgICBib3guc3R5bGUuYmFja2dyb3VuZCA9ICcjRjVDMkMxJztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGFycltpXS5taXNzZWQpIHtcclxuICAgICAgICAgICAgbGV0IGJveCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGFycltpXS5jb29yZGluYXRlcyk7XHJcbiAgICAgICAgICAgIGJveC5pbm5lckhUTUwgPSAn8J+Spic7XHJcbiAgICAgICAgICAgIGJveC5zdHlsZS5iYWNrZ3JvdW5kID0gJ2xpZ2h0Ymx1ZSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghYXJyW2ldLmhhc1NoaXAgJiYgIWFycltpXS5hdHRhY2tlZCAmJiAhYXJyW2ldLm1pc3NlZCkge1xyXG4gICAgICAgICAgICBsZXQgYm94ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYXJyW2ldLmNvb3JkaW5hdGVzKTtcclxuICAgICAgICAgICAgYm94LnN0eWxlLmJhY2tncm91bmQgPSAnbGlnaHRnb2xkZW5yb2R5ZWxsb3cnO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn07XHJcblxyXG5cclxuZnVuY3Rpb24gcmVuZGVyRW5lbXlCb2FyZCAoYm9hcmQpIHtcclxuICAgIGNvbnN0IGJveGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmVuZW15LWRpdi1ib3gnKTtcclxuXHJcbiAgICBmb3IgKGNvbnN0IGJveCBvZiBib3hlcykge1xyXG4gICAgICAgIGxldCBjb29yZGluYXRlcyA9IGJveC5pZDtcclxuICAgICAgICBsZXQgc3BsaXQgPSBjb29yZGluYXRlcy5zcGxpdCgnICcpO1xyXG4gICAgICAgIGxldCBudW0gPSBzcGxpdFsxXTsgXHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGJvYXJkLmJvYXJkW251bV0uaGFzU2hpcCkge1xyXG4gICAgICAgICAgICBib3guc3R5bGUuYmFja2dyb3VuZCA9ICdvcmFuZ2UnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYm9hcmQuYm9hcmRbbnVtXS5hdHRhY2tlZCkge1xyXG4gICAgICAgICAgICBib3guaW5uZXJIVE1MID0gJ+KdjCc7XHJcbiAgICAgICAgICAgIGJveC5zdHlsZS5iYWNrZ3JvdW5kID0gJyNGNUMyQzEnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYm9hcmQuYm9hcmRbbnVtXS5taXNzZWQpIHtcclxuICAgICAgICAgICAgYm94LmlubmVySFRNTCA9ICfwn5KmJztcclxuICAgICAgICAgICAgYm94LnN0eWxlLmJhY2tncm91bmQgPSAnbGlnaHRibHVlJztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGJvYXJkLmJvYXJkW251bV0uaGFzU2hpcCkge1xyXG4gICAgICAgICAgICBib3guaW5uZXJIVE1MID0gJ/CfmqInO1xyXG4gICAgICAgICAgICBib3guc3R5bGUuYmFja2dyb3VuZCA9ICdsaWdodGJsdWUnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcbmZ1bmN0aW9uIHJlbmRlcldpbiAoKSB7XHJcbiAgICBjb25zdCBtYWluID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW4nKTtcclxuICAgIGNvbnN0IGJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpOyBcclxuICAgIGNvbnN0IHBsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxyXG5cclxuICAgIGJveC5jbGFzc0xpc3QuYWRkKCdwb3AtdXAtYm94Jyk7XHJcbiAgICB0aXRsZS5jbGFzc0xpc3QuYWRkKCd0aXRsZS1wb3AtdXAnKTtcclxuICAgIHBsYXkuY2xhc3NMaXN0LmFkZCgncGxheS1idXR0b24nKTtcclxuXHJcbiAgICB0aXRsZS50ZXh0Q29udGVudCA9ICdZb3UgV2luJztcclxuICAgIHBsYXkuaW5uZXJIVE1MID0gJ1BsYXkgQWdhaW4nO1xyXG4gICAgcGxheS50eXBlID0gJ3N1Ym1pdCc7XHJcblxyXG4gICAgYm94LmFwcGVuZENoaWxkKHRpdGxlKTtcclxuICAgIGJveC5hcHBlbmRDaGlsZChwbGF5KTtcclxuXHJcbiAgICBtYWluLmFwcGVuZENoaWxkKGJveCk7XHJcblxyXG4gICAgcGxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICBjbGVhbigpO1xyXG4gICAgICAgIHdyaXRlTmFtZSgpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbmRlckxvc2UgKCkge1xyXG4gICAgY29uc3QgbWFpbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluJyk7XHJcbiAgICBjb25zdCBib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTsgXHJcbiAgICBjb25zdCBwbGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJylcclxuXHJcbiAgICBib3guY2xhc3NMaXN0LmFkZCgncG9wLXVwLWJveCcpO1xyXG4gICAgdGl0bGUuY2xhc3NMaXN0LmFkZCgndGl0bGUtcG9wLXVwJyk7XHJcbiAgICBwbGF5LmNsYXNzTGlzdC5hZGQoJ3BsYXktYnV0dG9uJyk7XHJcblxyXG4gICAgdGl0bGUudGV4dENvbnRlbnQgPSAnWW91IExvc2UnO1xyXG4gICAgcGxheS5pbm5lckhUTUwgPSAnUGxheSBBZ2Fpbic7XHJcbiAgICBwbGF5LnR5cGUgPSAnc3VibWl0JztcclxuXHJcbiAgICBib3guYXBwZW5kQ2hpbGQodGl0bGUpO1xyXG4gICAgYm94LmFwcGVuZENoaWxkKHBsYXkpO1xyXG5cclxuICAgIG1haW4uYXBwZW5kQ2hpbGQoYm94KTtcclxuXHJcbiAgICBwbGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgIGNsZWFuKCk7XHJcbiAgICAgICAgd3JpdGVOYW1lKCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2xlYW4gKCkge1xyXG4gICAgY29uc3QgbWFpbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluJyk7XHJcbiAgICBtYWluLmlubmVySFRNTCA9ICcnO1xyXG59XHJcblxyXG5cclxuZXhwb3J0IHt3cml0ZU5hbWUsIGNsZWFuLCByZW5kZXJJbml0YWxCb2FyZHMsIHJlbmRlck15Qm9hcmQsIHJlbmRlckVuZW15Qm9hcmQsIHJlbmRlcldpbiwgcmVuZGVyTG9zZX07XHJcbiIsIi8vIExpbnRlciwgUHJldHRpZXIsIEplc3QuY29uZmlnIC8vIFxyXG5cclxuaW1wb3J0IHsgU2hpcCwgR2FtZWJvYXJkLCBQbGF5ZXIgfSBmcm9tIFwiLi9mYWN0b3JpZXNcIjtcclxuaW1wb3J0IHsgd3JpdGVOYW1lLCBjbGVhbiwgcmVuZGVySW5pdGFsQm9hcmRzLCByZW5kZXJXaW4sIHJlbmRlckxvc2UsIHNlbGVjdFNoaXBzIH0gZnJvbSBcIi4vcmVuZGVyXCI7XHJcbmltcG9ydCB7IGdhbWUgfSBmcm9tIFwiLi9nYW1lXCI7XHJcblxyXG53cml0ZU5hbWUoKTsiXSwibmFtZXMiOlsiU2hpcCIsImNvbnN0cnVjdG9yIiwic2l6ZSIsInRoaXMiLCJoaXQiLCJzdW5rIiwiY29vcmRpbmF0ZXMiLCJyZWdpc3RlckhpdCIsImlzU3VuayIsImFkZENvb3JkaW5hdGVzIiwicG9zaXRpb24iLCJwdXNoIiwibW9kdWxlIiwiZXhwb3J0cyIsIkdhbWVib2FyZCIsImJvYXJkIiwic2hpcHMiLCJjcmVhdGVCb2FyZCIsImkiLCJqIiwiY29vcmRpbmF0ZSIsImF0dGFja2VkIiwibWlzc2VkIiwiaGFzU2hpcCIsInNoaXAiLCJpc1ZhbGlkIiwiYXJyIiwic3BsaXQiLCJhIiwiTnVtYmVyIiwiYiIsImdldEJvYXJkIiwiYWRkU2hpcCIsInBsYWNlU2hpcCIsImxlbmd0aCIsImlzTW92ZUxlZ2FsIiwibW92ZSIsInBsYWNlRW5lbXlTaGlwcyIsImNvb3JkaW5hdGVDYXJyaWVyIiwiY3JlYXRlQ29vcmRpbmF0ZXMiLCJjb29yZGluYXRlQmF0dGxlc2hpcCIsImNvb3JkaW5hdGVDcnVpc2VyIiwiY29vcmRpbmF0ZVN1Ym1hcmluZSIsImNvb3JkaW5hdGVEZXN0cm95ZXIiLCJhcnJheSIsImJvYXJkQXJyYXkiLCJnZXRBZGphY2VudHMiLCJzaXplcyIsImZpbHRlcmVkIiwidGVtcCIsImZpbHRlciIsInBvcyIsImZvckVhY2giLCJzZXRPZkNvb3JkaW5hdGVzIiwibnVtMSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsIm51bTIiLCJyZXN1bHQiLCJhcnJheUJvYXJkIiwiYWRqYWNlbnRzIiwicmlnaHQiLCJkb3duIiwiaW5kZXgiLCJwbGFjZSIsInBsYWNlU3BsaXQiLCJpbmNsdWRlcyIsImhhc0FsbFNoaXBzUGxhY2VkIiwicmVjZWl2ZUF0dGFjayIsInN0ciIsImdldFNoaXBzIiwiYWxsU3VuayIsImV2ZXJ5Iiwib2JqIiwia2V5IiwiUGxheWVyIiwiZ2FtZWJvYXJkIiwibWFrZVJhbmRvbU1vdmUiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwibmFtZSIsIm1haW4iLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwibXlTZWN0aW9uIiwiY3JlYXRlRWxlbWVudCIsIm15R2FtZVNlY3Rpb24iLCJteUJvYXJkIiwibXlOYW1lQm94IiwibXlOYW1lIiwiZW5lbXlTZWN0aW9uIiwiZW5lbXlHYW1lU2VjdGlvbiIsImVuZW15Qm9hcmQiLCJlbmVteU5hbWVCb3giLCJlbmVteU5hbWUiLCJjbGFzc0xpc3QiLCJhZGQiLCJkaXYiLCJkaXZFbmVteSIsImlkIiwiYXBwZW5kQ2hpbGQiLCJ0ZXh0Q29udGVudCIsInN0eWxlIiwiYmFja2dyb3VuZCIsImJveCIsImlubmVySFRNTCIsImNsZWFuIiwidGl0bGUiLCJpbnB1dCIsInBsYXkiLCJ0eXBlIiwiYWRkRXZlbnRMaXN0ZW5lciIsInZhbHVlIiwiYXhpcyIsImRhdGFzZXQiLCJ4Tm90QWxsb3dlZCIsInlOb3RBbGxvd2VkIiwicXVlcnlTZWxlY3RvciIsImluZGV4T2YiLCJheGlzVGV4dCIsImFkaldpdGhTaGlwIiwic29tZSIsIngiLCJjTm90QWxsb3dlZCIsImN1cnNvciIsInJlbmRlclBsYWNlU2hpcHMiLCJhbGVydCIsIndyaXRlTmFtZSJdLCJzb3VyY2VSb290IjoiIn0=